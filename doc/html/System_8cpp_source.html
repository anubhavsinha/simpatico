<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Simpatico: System.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simpatico&#160;<span id="projectnumber">v0.8</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_1f5833e5a6ae4f3b158cdaf1cc06a4a1.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_c1bcc227895122efdacbe59b4a33aca8.html">mcMd</a>      </li>
      <li class="navelem"><a class="el" href="dir_b697380521e45e10ba9ba2b6a3abcc2c.html">simulation</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>System.cpp</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef MCMD_SYSTEM_CPP</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define MCMD_SYSTEM_CPP</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="comment">/*</span>
<a name="l00005"></a>00005 <span class="comment">* Simpatico - Simulation Package for Polymeric and Molecular Liquids</span>
<a name="l00006"></a>00006 <span class="comment">*</span>
<a name="l00007"></a>00007 <span class="comment">* Copyright 2010, David Morse (morse@cems.umn.edu)</span>
<a name="l00008"></a>00008 <span class="comment">* Distributed under the terms of the GNU General Public License.</span>
<a name="l00009"></a>00009 <span class="comment">*/</span>
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="comment">// namespace McMd</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;System.h&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;Simulation.h&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;serialize.h&quot;</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;mcMd/species/Species.h&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;util/ensembles/EnergyEnsemble.h&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;util/ensembles/BoundaryEnsemble.h&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;mcMd/configIos/ConfigIo.h&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;mcMd/configIos/McConfigIo.h&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;mcMd/configIos/ConfigIoFactory.h&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;mcMd/trajectoryIos/TrajectoryIo.h&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;mcMd/trajectoryIos/TrajectoryIoFactory.h&gt;</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="preprocessor">#ifndef INTER_NOPAIR</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span><span class="preprocessor">#include &lt;mcMd/potentials/pair/PairFactory.h&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#endif</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="preprocessor">#include &lt;mcMd/potentials/bond/BondFactory.h&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#ifdef INTER_ANGLE</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#include &lt;mcMd/potentials/angle/AngleFactory.h&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#endif</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span><span class="preprocessor">#ifdef INTER_DIHEDRAL</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span><span class="preprocessor">#include &lt;mcMd/potentials/dihedral/DihedralFactory.h&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#endif</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor">#ifdef MCMD_LINK</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span><span class="preprocessor">#include &lt;mcMd/potentials/link/LinkFactory.h&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;mcMd/links/LinkMaster.h&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#endif</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span><span class="preprocessor">#ifdef INTER_EXTERNAL</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span><span class="preprocessor">#include &lt;mcMd/potentials/external/ExternalFactory.h&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#endif</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span><span class="preprocessor">#ifdef INTER_TETHER</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span><span class="preprocessor">#include &lt;mcMd/potentials/tether/tetherFactory.h&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;mcMd/tethers/TetherMaster.h&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#endif</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span>
<a name="l00047"></a>00047 <span class="preprocessor">#ifdef MCMD_PERTURB</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span><span class="preprocessor">#include &lt;mcMd/perturb/Perturbation.h&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#ifdef UTIL_MPI</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span><span class="preprocessor">#include &lt;mcMd/perturb/ReplicaMove.h&gt;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#endif</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>
<a name="l00054"></a>00054 <span class="comment">// namespace Util</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &lt;mcMd/util/FileMaster.h&gt;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &lt;util/param/Factory.h&gt;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &lt;util/archives/Serializable_includes.h&gt;</span>
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="keyword">namespace </span>McMd
<a name="l00062"></a>00062 {
<a name="l00063"></a>00063 
<a name="l00064"></a>00064    <span class="keyword">using namespace </span>Util;
<a name="l00065"></a>00065 
<a name="l00066"></a>00066    <span class="comment">/*</span>
<a name="l00067"></a>00067 <span class="comment">   * Default constructor.</span>
<a name="l00068"></a>00068 <span class="comment">   */</span>
<a name="l00069"></a>00069    <a class="code" href="classMcMd_1_1System.html#aa99f92b482c36f6e72a05b28c3d6f748" title="Default constructor.">System::System</a>()
<a name="l00070"></a>00070     : moleculeSetsPtr_(0),
<a name="l00071"></a><a class="code" href="classMcMd_1_1System.html#aa99f92b482c36f6e72a05b28c3d6f748">00071</a>       boundaryPtr_(0),
<a name="l00072"></a>00072       #ifdef MCMD_LINK
<a name="l00073"></a>00073       linkMasterPtr_(0),
<a name="l00074"></a>00074       #endif
<a name="l00075"></a>00075       #ifdef INTER_TETHER
<a name="l00076"></a>00076       tetherMasterPtr_(0),
<a name="l00077"></a>00077       #endif
<a name="l00078"></a>00078       simulationPtr_(0),
<a name="l00079"></a>00079       energyEnsemblePtr_(0),
<a name="l00080"></a>00080       boundaryEnsemblePtr_(0),
<a name="l00081"></a>00081       #ifndef INTER_NOPAIR
<a name="l00082"></a>00082       pairFactoryPtr_(0),
<a name="l00083"></a>00083       #endif
<a name="l00084"></a>00084       bondFactoryPtr_(0),
<a name="l00085"></a>00085       #ifdef INTER_ANGLE
<a name="l00086"></a>00086       angleFactoryPtr_(0),
<a name="l00087"></a>00087       #endif
<a name="l00088"></a>00088       #ifdef INTER_DIHEDRAL
<a name="l00089"></a>00089       dihedralFactoryPtr_(0),
<a name="l00090"></a>00090       #endif
<a name="l00091"></a>00091       #ifdef MCMD_LINK
<a name="l00092"></a>00092       linkFactoryPtr_(0),
<a name="l00093"></a>00093       #endif
<a name="l00094"></a>00094       #ifdef INTER_EXTERNAL
<a name="l00095"></a>00095       externalFactoryPtr_(0),
<a name="l00096"></a>00096       #endif
<a name="l00097"></a>00097       #ifdef INTER_TETHER
<a name="l00098"></a>00098       tetherFactoryPtr_(0),
<a name="l00099"></a>00099       #endif
<a name="l00100"></a>00100       configIoPtr_(0),
<a name="l00101"></a>00101       configIoFactoryPtr_(0),
<a name="l00102"></a>00102       trajectoryIoFactoryPtr_(0),
<a name="l00103"></a>00103       fileMasterPtr_(0),
<a name="l00104"></a>00104       #ifdef MCMD_PERTURB
<a name="l00105"></a>00105       perturbationPtr_(0),
<a name="l00106"></a>00106       perturbationFactoryPtr_(0),
<a name="l00107"></a>00107       #ifdef UTIL_MPI
<a name="l00108"></a>00108       replicaMovePtr_(0),
<a name="l00109"></a>00109       hasReplicaMove_(false),
<a name="l00110"></a>00110       #endif
<a name="l00111"></a>00111       #endif
<a name="l00112"></a>00112       #ifndef INTER_NOPAIR
<a name="l00113"></a>00113       pairStyle_(),
<a name="l00114"></a>00114       #endif
<a name="l00115"></a>00115       bondStyle_(),
<a name="l00116"></a>00116       #ifdef INTER_ANGLE
<a name="l00117"></a>00117       angleStyle_(),
<a name="l00118"></a>00118       #endif
<a name="l00119"></a>00119       #ifdef INTER_DIHEDRAL
<a name="l00120"></a>00120       dihedralStyle_(),
<a name="l00121"></a>00121       #endif
<a name="l00122"></a>00122       #ifdef MCMD_LINK
<a name="l00123"></a>00123       linkStyle_(),
<a name="l00124"></a>00124       #endif
<a name="l00125"></a>00125       #ifdef INTER_EXTERNAL
<a name="l00126"></a>00126       externalStyle_(),
<a name="l00127"></a>00127       #endif
<a name="l00128"></a>00128       #ifdef INTER_TETHER
<a name="l00129"></a>00129       tetherStyle_(),
<a name="l00130"></a>00130       #endif
<a name="l00131"></a>00131       id_(0),
<a name="l00132"></a>00132       isCopy_(false),
<a name="l00133"></a>00133       createdFileMaster_(false)
<a name="l00134"></a>00134       #ifdef MCMD_PERTURB
<a name="l00135"></a>00135       , createdPerturbation_(false)
<a name="l00136"></a>00136       , createdPerturbationFactory_(false)
<a name="l00137"></a>00137       , createdReplicaMove_(false)
<a name="l00138"></a>00138       #endif
<a name="l00139"></a>00139    {
<a name="l00140"></a>00140       moleculeSetsPtr_ = <span class="keyword">new</span> <a class="code" href="classUtil_1_1DArray.html">DArray&lt;MoleculeSet&gt;</a>;
<a name="l00141"></a>00141       boundaryPtr_     = <span class="keyword">new</span> Boundary;
<a name="l00142"></a>00142       energyEnsemblePtr_   = <span class="keyword">new</span> <a class="code" href="classUtil_1_1EnergyEnsemble.html" title="A statistical ensemble for energy.">EnergyEnsemble</a>;
<a name="l00143"></a>00143       boundaryEnsemblePtr_ = <span class="keyword">new</span> <a class="code" href="classUtil_1_1BoundaryEnsemble.html" title="Statistical ensemble for changes in the periodic unit cell size.">BoundaryEnsemble</a>;
<a name="l00144"></a>00144    }
<a name="l00145"></a>00145 
<a name="l00146"></a>00146    <span class="comment">/*</span>
<a name="l00147"></a>00147 <span class="comment">   * Copy constructor.</span>
<a name="l00148"></a>00148 <span class="comment">   */</span>
<a name="l00149"></a>00149    <a class="code" href="classMcMd_1_1System.html#aa99f92b482c36f6e72a05b28c3d6f748" title="Default constructor.">System::System</a>(<span class="keyword">const</span> <a class="code" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a>&amp; other)
<a name="l00150"></a>00150     : <a class="code" href="classUtil_1_1ParamComposite.html" title="An object that can read multiple parameters from file.">ParamComposite</a>(other),
<a name="l00151"></a><a class="code" href="classMcMd_1_1System.html#a0dcd7783a22ab9a60eec8ce7e159a3ff">00151</a>       moleculeSetsPtr_(other.moleculeSetsPtr_),
<a name="l00152"></a>00152       boundaryPtr_(other.boundaryPtr_),
<a name="l00153"></a>00153       #ifdef MCMD_LINK
<a name="l00154"></a>00154       linkMasterPtr_(other.linkMasterPtr_),
<a name="l00155"></a>00155       #endif
<a name="l00156"></a>00156       #ifdef INTER_TETHER
<a name="l00157"></a>00157       tetherMasterPtr_(other.tetherMasterPtr_),
<a name="l00158"></a>00158       #endif
<a name="l00159"></a>00159       simulationPtr_(other.simulationPtr_),
<a name="l00160"></a>00160       energyEnsemblePtr_(other.energyEnsemblePtr_),
<a name="l00161"></a>00161       boundaryEnsemblePtr_(other.boundaryEnsemblePtr_),
<a name="l00162"></a>00162       #ifndef INTER_NOPAIR
<a name="l00163"></a>00163       pairFactoryPtr_(other.pairFactoryPtr_),
<a name="l00164"></a>00164       #endif
<a name="l00165"></a>00165       bondFactoryPtr_(other.bondFactoryPtr_),
<a name="l00166"></a>00166       #ifdef INTER_ANGLE
<a name="l00167"></a>00167       angleFactoryPtr_(other.angleFactoryPtr_),
<a name="l00168"></a>00168       #endif
<a name="l00169"></a>00169       #ifdef INTER_DIHEDRAL
<a name="l00170"></a>00170       dihedralFactoryPtr_(other.dihedralFactoryPtr_),
<a name="l00171"></a>00171       #endif
<a name="l00172"></a>00172       #ifdef MCMD_LINK
<a name="l00173"></a>00173       linkFactoryPtr_(other.linkFactoryPtr_),
<a name="l00174"></a>00174       #endif
<a name="l00175"></a>00175       #ifdef INTER_EXTERNAL
<a name="l00176"></a>00176       externalFactoryPtr_(other.externalFactoryPtr_),
<a name="l00177"></a>00177       #endif
<a name="l00178"></a>00178       #ifdef INTER_TETHER
<a name="l00179"></a>00179       tetherFactoryPtr_(other.tetherFactoryPtr_),
<a name="l00180"></a>00180       #endif
<a name="l00181"></a>00181       configIoPtr_(other.configIoPtr_),
<a name="l00182"></a>00182       configIoFactoryPtr_(other.configIoFactoryPtr_),
<a name="l00183"></a>00183       trajectoryIoFactoryPtr_(other.trajectoryIoFactoryPtr_),
<a name="l00184"></a>00184       fileMasterPtr_(other.fileMasterPtr_),
<a name="l00185"></a>00185       #ifdef MCMD_PERTURB
<a name="l00186"></a>00186       perturbationPtr_(other.perturbationPtr_),
<a name="l00187"></a>00187       perturbationFactoryPtr_(other.perturbationFactoryPtr_),
<a name="l00188"></a>00188       #ifdef UTIL_MPI
<a name="l00189"></a>00189       replicaMovePtr_(other.replicaMovePtr_),
<a name="l00190"></a>00190       hasReplicaMove_(other.hasReplicaMove_),
<a name="l00191"></a>00191       #endif
<a name="l00192"></a>00192       #endif
<a name="l00193"></a>00193       #ifndef INTER_NOPAIR
<a name="l00194"></a>00194       pairStyle_(other.pairStyle_),
<a name="l00195"></a>00195       #endif
<a name="l00196"></a>00196       bondStyle_(other.bondStyle_),
<a name="l00197"></a>00197       #ifdef INTER_ANGLE
<a name="l00198"></a>00198       angleStyle_(other.angleStyle_),
<a name="l00199"></a>00199       #endif
<a name="l00200"></a>00200       #ifdef INTER_DIHEDRAL
<a name="l00201"></a>00201       dihedralStyle_(other.dihedralStyle_),
<a name="l00202"></a>00202       #endif
<a name="l00203"></a>00203       #ifdef MCMD_LINK
<a name="l00204"></a>00204       linkStyle_(other.linkStyle_),
<a name="l00205"></a>00205       #endif
<a name="l00206"></a>00206       #ifdef INTER_EXTERNAL
<a name="l00207"></a>00207       externalStyle_(other.externalStyle_),
<a name="l00208"></a>00208       #endif
<a name="l00209"></a>00209       #ifdef INTER_TETHER
<a name="l00210"></a>00210       tetherStyle_(other.tetherStyle_),
<a name="l00211"></a>00211       #endif
<a name="l00212"></a>00212       id_(other.id_),
<a name="l00213"></a>00213       isCopy_(true),
<a name="l00214"></a>00214       createdFileMaster_(false)
<a name="l00215"></a>00215       #ifdef MCMD_PERTURB
<a name="l00216"></a>00216       , createdPerturbation_(false)
<a name="l00217"></a>00217       , createdPerturbationFactory_(false)
<a name="l00218"></a>00218       , createdReplicaMove_(false)
<a name="l00219"></a>00219       #endif
<a name="l00220"></a>00220    {}
<a name="l00221"></a>00221 
<a name="l00222"></a>00222    <span class="comment">/*</span>
<a name="l00223"></a>00223 <span class="comment">   * Destructor.</span>
<a name="l00224"></a>00224 <span class="comment">   */</span>
<a name="l00225"></a>00225    <a class="code" href="classMcMd_1_1System.html#a3bfbca0e3ddd7ea1f8709c986454d753" title="Destructor.">System::~System</a>()
<a name="l00226"></a>00226    {
<a name="l00227"></a><a class="code" href="classMcMd_1_1System.html#a3bfbca0e3ddd7ea1f8709c986454d753">00227</a>       <span class="keywordflow">if</span> (!isCopy()) {
<a name="l00228"></a>00228          <span class="keywordflow">if</span> (moleculeSetsPtr_) {
<a name="l00229"></a>00229             <span class="keyword">delete</span> moleculeSetsPtr_;
<a name="l00230"></a>00230          }
<a name="l00231"></a>00231          <span class="keywordflow">if</span> (boundaryPtr_) {
<a name="l00232"></a>00232             <span class="keyword">delete</span> boundaryPtr_;
<a name="l00233"></a>00233          }
<a name="l00234"></a>00234 <span class="preprocessor">         #ifndef INTER_NOPAIR</span>
<a name="l00235"></a>00235 <span class="preprocessor"></span>         <span class="keywordflow">if</span> (pairFactoryPtr_) {
<a name="l00236"></a>00236             <span class="keyword">delete</span> pairFactoryPtr_;
<a name="l00237"></a>00237          }
<a name="l00238"></a>00238 <span class="preprocessor">         #endif</span>
<a name="l00239"></a>00239 <span class="preprocessor"></span>         <span class="keywordflow">if</span> (bondFactoryPtr_) {
<a name="l00240"></a>00240             <span class="keyword">delete</span> bondFactoryPtr_;
<a name="l00241"></a>00241          }
<a name="l00242"></a>00242 <span class="preprocessor">         #ifdef INTER_ANGLE</span>
<a name="l00243"></a>00243 <span class="preprocessor"></span>         <span class="keywordflow">if</span> (angleFactoryPtr_) {
<a name="l00244"></a>00244             <span class="keyword">delete</span> angleFactoryPtr_;
<a name="l00245"></a>00245          }
<a name="l00246"></a>00246 <span class="preprocessor">         #endif</span>
<a name="l00247"></a>00247 <span class="preprocessor"></span><span class="preprocessor">         #ifdef INTER_DIHEDRAL</span>
<a name="l00248"></a>00248 <span class="preprocessor"></span>         <span class="keywordflow">if</span> (dihedralFactoryPtr_) {
<a name="l00249"></a>00249             <span class="keyword">delete</span> dihedralFactoryPtr_;
<a name="l00250"></a>00250          }
<a name="l00251"></a>00251 <span class="preprocessor">         #endif</span>
<a name="l00252"></a>00252 <span class="preprocessor"></span><span class="preprocessor">         #ifdef MCMD_LINK</span>
<a name="l00253"></a>00253 <span class="preprocessor"></span>         <span class="keywordflow">if</span> (linkFactoryPtr_) {
<a name="l00254"></a>00254             <span class="keyword">delete</span> linkFactoryPtr_;
<a name="l00255"></a>00255          }
<a name="l00256"></a>00256 <span class="preprocessor">         #endif</span>
<a name="l00257"></a>00257 <span class="preprocessor"></span><span class="preprocessor">         #ifdef INTER_EXTERNAL</span>
<a name="l00258"></a>00258 <span class="preprocessor"></span>         <span class="keywordflow">if</span> (externalFactoryPtr_) {
<a name="l00259"></a>00259             <span class="keyword">delete</span> externalFactoryPtr_;
<a name="l00260"></a>00260          }
<a name="l00261"></a>00261 <span class="preprocessor">         #endif</span>
<a name="l00262"></a>00262 <span class="preprocessor"></span><span class="preprocessor">         #ifdef MCMD_LINK</span>
<a name="l00263"></a>00263 <span class="preprocessor"></span>         <span class="keywordflow">if</span> (linkMasterPtr_) {
<a name="l00264"></a>00264             <span class="keyword">delete</span> linkMasterPtr_;
<a name="l00265"></a>00265          }
<a name="l00266"></a>00266 <span class="preprocessor">         #endif</span>
<a name="l00267"></a>00267 <span class="preprocessor"></span><span class="preprocessor">         #ifdef INTER_TETHER</span>
<a name="l00268"></a>00268 <span class="preprocessor"></span>         <span class="keywordflow">if</span> (tetherMasterPtr_) {
<a name="l00269"></a>00269             <span class="keyword">delete</span> tetherMasterPtr_;
<a name="l00270"></a>00270          }
<a name="l00271"></a>00271          <span class="keywordflow">if</span> (tetherFactoryPtr_) {
<a name="l00272"></a>00272             <span class="keyword">delete</span> tetherFactoryPtr_;
<a name="l00273"></a>00273          }
<a name="l00274"></a>00274 <span class="preprocessor">         #endif</span>
<a name="l00275"></a>00275 <span class="preprocessor"></span>
<a name="l00276"></a>00276 <span class="preprocessor">         #ifdef MCMD_PERTURB</span>
<a name="l00277"></a>00277 <span class="preprocessor"></span>         <span class="keywordflow">if</span> (perturbationPtr_ &amp;&amp; createdPerturbationFactory_) {
<a name="l00278"></a>00278             <span class="keyword">delete</span> perturbationPtr_;
<a name="l00279"></a>00279          }
<a name="l00280"></a>00280          <span class="keywordflow">if</span> (perturbationFactoryPtr_ &amp;&amp; createdPerturbationFactory_) {
<a name="l00281"></a>00281             <span class="keyword">delete</span> perturbationFactoryPtr_;
<a name="l00282"></a>00282          }
<a name="l00283"></a>00283 <span class="preprocessor">         #ifdef UTIL_MPI</span>
<a name="l00284"></a>00284 <span class="preprocessor"></span>         <span class="keywordflow">if</span> (replicaMovePtr_ &amp;&amp; createdReplicaMove_) {
<a name="l00285"></a>00285             <span class="keyword">delete</span> replicaMovePtr_;
<a name="l00286"></a>00286          }
<a name="l00287"></a>00287 <span class="preprocessor">         #endif</span>
<a name="l00288"></a>00288 <span class="preprocessor"></span><span class="preprocessor">         #endif</span>
<a name="l00289"></a>00289 <span class="preprocessor"></span>      
<a name="l00290"></a>00290          <span class="keywordflow">if</span> (energyEnsemblePtr_) {
<a name="l00291"></a>00291             <span class="keyword">delete</span> energyEnsemblePtr_;
<a name="l00292"></a>00292          }
<a name="l00293"></a>00293          <span class="keywordflow">if</span> (boundaryEnsemblePtr_) {
<a name="l00294"></a>00294             <span class="keyword">delete</span> boundaryEnsemblePtr_;
<a name="l00295"></a>00295          }
<a name="l00296"></a>00296          <span class="keywordflow">if</span> (configIoPtr_) {
<a name="l00297"></a>00297             <span class="keyword">delete</span> configIoPtr_;
<a name="l00298"></a>00298          }
<a name="l00299"></a>00299          <span class="keywordflow">if</span> (configIoFactoryPtr_) {
<a name="l00300"></a>00300             <span class="keyword">delete</span> configIoFactoryPtr_;
<a name="l00301"></a>00301          }
<a name="l00302"></a>00302          <span class="keywordflow">if</span> (trajectoryIoFactoryPtr_) {
<a name="l00303"></a>00303             <span class="keyword">delete</span> trajectoryIoFactoryPtr_;
<a name="l00304"></a>00304          }
<a name="l00305"></a>00305          <span class="keywordflow">if</span> (fileMasterPtr_ &amp;&amp; createdFileMaster_) {
<a name="l00306"></a>00306             <span class="keyword">delete</span> fileMasterPtr_;
<a name="l00307"></a>00307          }
<a name="l00308"></a>00308       }
<a name="l00309"></a>00309    }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311    <span class="comment">/*</span>
<a name="l00312"></a>00312 <span class="comment">   * Read parameters from file.</span>
<a name="l00313"></a>00313 <span class="comment">   */</span>
<a name="l00314"></a>00314    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#ab5421d3c9175985c9acbf723e5392075" title="Read parameter file.">System::readParam</a>(std::istream &amp;in)
<a name="l00315"></a>00315    {
<a name="l00316"></a><a class="code" href="classMcMd_1_1System.html#ab5421d3c9175985c9acbf723e5392075">00316</a> 
<a name="l00317"></a>00317       <span class="comment">// Only read parameters if this is not a copy.</span>
<a name="l00318"></a>00318       <span class="keywordflow">if</span> (!isCopy()) {
<a name="l00319"></a>00319          allocateMoleculeSets();
<a name="l00320"></a>00320          readFileMaster(in);
<a name="l00321"></a>00321          readPotentialStyles(in);
<a name="l00322"></a>00322 <span class="preprocessor">         #ifdef MCMD_LINK</span>
<a name="l00323"></a>00323 <span class="preprocessor"></span>         readLinkMaster(in);
<a name="l00324"></a>00324 <span class="preprocessor">         #endif</span>
<a name="l00325"></a>00325 <span class="preprocessor"></span><span class="preprocessor">         #ifdef INTER_TETHER</span>
<a name="l00326"></a>00326 <span class="preprocessor"></span>         readTetherMaster(in);
<a name="l00327"></a>00327 <span class="preprocessor">         #endif</span>
<a name="l00328"></a>00328 <span class="preprocessor"></span>         readEnsembles(in);
<a name="l00329"></a>00329       }
<a name="l00330"></a>00330 
<a name="l00331"></a>00331    }
<a name="l00332"></a>00332 
<a name="l00336"></a>00336    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#a29cb9ccd6e27b8c44c0e35476cb9414a" title="If no FileMaster exists, create and initialize one.">System::readFileMaster</a>(std::istream &amp;in)
<a name="l00337"></a>00337    {
<a name="l00338"></a><a class="code" href="classMcMd_1_1System.html#a29cb9ccd6e27b8c44c0e35476cb9414a">00338</a>       <span class="comment">// Create FileMaster if necessary</span>
<a name="l00339"></a>00339       <span class="keywordflow">if</span> (!fileMasterPtr_) {
<a name="l00340"></a>00340          fileMasterPtr_ = <span class="keyword">new</span> <a class="code" href="classMcMd_1_1FileMaster.html" title="A FileMaster manages a set of input and output files.">FileMaster</a>();
<a name="l00341"></a>00341          createdFileMaster_ = <span class="keyword">true</span>;
<a name="l00342"></a>00342          readParamComposite(in, *fileMasterPtr_);
<a name="l00343"></a>00343       }
<a name="l00344"></a>00344    }
<a name="l00345"></a>00345 
<a name="l00346"></a>00346    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#ada500231e17bfb7f1b9097caca487f15" title="Read potential styles, initialize LinkMaster or TetherMaster if needed.">System::readPotentialStyles</a>(std::istream &amp;in)
<a name="l00347"></a>00347    {
<a name="l00348"></a><a class="code" href="classMcMd_1_1System.html#ada500231e17bfb7f1b9097caca487f15">00348</a> <span class="preprocessor">      #ifndef INTER_NOPAIR</span>
<a name="l00349"></a>00349 <span class="preprocessor"></span>      read&lt;std::string&gt;(in, <span class="stringliteral">&quot;pairStyle&quot;</span>, pairStyle_);
<a name="l00350"></a>00350 <span class="preprocessor">      #endif</span>
<a name="l00351"></a>00351 <span class="preprocessor"></span>
<a name="l00352"></a>00352       <span class="keywordflow">if</span> (simulation().nBondType() &gt; 0) {
<a name="l00353"></a>00353          read&lt;std::string&gt;(in, <span class="stringliteral">&quot;bondStyle&quot;</span>, bondStyle_);
<a name="l00354"></a>00354       }
<a name="l00355"></a>00355 
<a name="l00356"></a>00356 <span class="preprocessor">      #ifdef INTER_ANGLE</span>
<a name="l00357"></a>00357 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (simulation().nAngleType() &gt; 0) {
<a name="l00358"></a>00358          read&lt;std::string&gt;(in, <span class="stringliteral">&quot;angleStyle&quot;</span>, angleStyle_);
<a name="l00359"></a>00359       }
<a name="l00360"></a>00360 <span class="preprocessor">      #endif</span>
<a name="l00361"></a>00361 <span class="preprocessor"></span>
<a name="l00362"></a>00362 <span class="preprocessor">      #ifdef INTER_DIHEDRAL</span>
<a name="l00363"></a>00363 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (simulation().nDihedralType() &gt; 0) {
<a name="l00364"></a>00364          read&lt;std::string&gt;(in, <span class="stringliteral">&quot;dihedralStyle&quot;</span>, dihedralStyle_);
<a name="l00365"></a>00365       }
<a name="l00366"></a>00366 <span class="preprocessor">      #endif</span>
<a name="l00367"></a>00367 <span class="preprocessor"></span>
<a name="l00368"></a>00368 <span class="preprocessor">      #ifdef MCMD_LINK</span>
<a name="l00369"></a>00369 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (simulation().nLinkType() &gt; 0) {
<a name="l00370"></a>00370          read&lt;std::string&gt;(in, <span class="stringliteral">&quot;linkStyle&quot;</span>, linkStyle_);
<a name="l00371"></a>00371       }
<a name="l00372"></a>00372 <span class="preprocessor">      #endif</span>
<a name="l00373"></a>00373 <span class="preprocessor"></span>
<a name="l00374"></a>00374 <span class="preprocessor">      #ifdef INTER_EXTERNAL</span>
<a name="l00375"></a>00375 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (simulation().hasExternal()) {
<a name="l00376"></a>00376          read&lt;std::string&gt;(in, <span class="stringliteral">&quot;externalStyle&quot;</span>, externalStyle_);
<a name="l00377"></a>00377       }
<a name="l00378"></a>00378 <span class="preprocessor">      #endif</span>
<a name="l00379"></a>00379 <span class="preprocessor"></span>
<a name="l00380"></a>00380 <span class="preprocessor">      #ifdef INTER_TETHER</span>
<a name="l00381"></a>00381 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (simulation().hasTether()) {
<a name="l00382"></a>00382          read&lt;std::string&gt;(in, <span class="stringliteral">&quot;tetherStyle&quot;</span>, tetherStyle_);
<a name="l00383"></a>00383       }
<a name="l00384"></a>00384 <span class="preprocessor">      #endif</span>
<a name="l00385"></a>00385 <span class="preprocessor"></span>   }
<a name="l00386"></a>00386 
<a name="l00387"></a>00387    <span class="comment">/*</span>
<a name="l00388"></a>00388 <span class="comment">   * Create EnergyEnsemble and BoundaryEnsemble</span>
<a name="l00389"></a>00389 <span class="comment">   */</span>
<a name="l00390"></a>00390    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#a7e4f36650a5fa0818045413f37e9bd9a" title="Read energy and boundary ensembles.">System::readEnsembles</a>(std::istream &amp;in)
<a name="l00391"></a>00391    {
<a name="l00392"></a><a class="code" href="classMcMd_1_1System.html#a7e4f36650a5fa0818045413f37e9bd9a">00392</a>       readParamComposite(in, *energyEnsemblePtr_);
<a name="l00393"></a>00393       readParamComposite(in, *boundaryEnsemblePtr_);
<a name="l00394"></a>00394    }
<a name="l00395"></a>00395 
<a name="l00396"></a>00396 <span class="preprocessor">   #ifdef MCMD_LINK</span>
<a name="l00397"></a>00397 <span class="preprocessor"></span>   <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#a689bb118744e3e2dc6c3c1b863fe53fb" title="Read the LinkMaster.">System::readLinkMaster</a>(std::istream &amp;in)
<a name="l00398"></a>00398    {
<a name="l00399"></a><a class="code" href="classMcMd_1_1System.html#a689bb118744e3e2dc6c3c1b863fe53fb">00399</a>       <span class="keywordflow">if</span> (simulation().nLinkType() &gt; 0) {
<a name="l00400"></a>00400          linkMasterPtr_ = <span class="keyword">new</span> <a class="code" href="classMcMd_1_1LinkMaster.html" title="Manages all Link objects in a System.">LinkMaster</a>();
<a name="l00401"></a>00401          readParamComposite(in, *linkMasterPtr_);
<a name="l00402"></a>00402       }
<a name="l00403"></a>00403    }
<a name="l00404"></a>00404 <span class="preprocessor">   #endif </span>
<a name="l00405"></a>00405 <span class="preprocessor"></span>
<a name="l00406"></a>00406 <span class="preprocessor">   #ifdef INTER_TETHER</span>
<a name="l00407"></a>00407 <span class="preprocessor"></span>   <span class="keywordtype">void</span> System::readTetherMaster(std::istream &amp;in)
<a name="l00408"></a>00408    {
<a name="l00409"></a>00409       <span class="keywordflow">if</span> (simulation().hasTether()) {
<a name="l00410"></a>00410          tetherMasterPtr_ = <span class="keyword">new</span> TetherMaster();
<a name="l00411"></a>00411          readParamComposite(in, *tetherMasterPtr_);
<a name="l00412"></a>00412       }
<a name="l00413"></a>00413    }
<a name="l00414"></a>00414 <span class="preprocessor">   #endif </span>
<a name="l00415"></a>00415 <span class="preprocessor"></span>
<a name="l00416"></a>00416    <span class="comment">/*</span>
<a name="l00417"></a>00417 <span class="comment">   * Return a pointer to a new default ConfigIo.</span>
<a name="l00418"></a>00418 <span class="comment">   */</span>
<a name="l00419"></a>00419    ConfigIo* <a class="code" href="classMcMd_1_1System.html#aa4ebd20bece54577de23e0677d266e8d" title="Return a pointer to a new default ConfigIo.">System::newDefaultConfigIo</a>()
<a name="l00420"></a>00420    {  <span class="keywordflow">return</span> <span class="keyword">new</span> McConfigIo(*<span class="keyword">this</span>); }
<a name="l00421"></a><a class="code" href="classMcMd_1_1System.html#aa4ebd20bece54577de23e0677d266e8d">00421</a> 
<a name="l00422"></a>00422    <span class="comment">/*</span>
<a name="l00423"></a>00423 <span class="comment">   * Read configuration from a specific input stream.</span>
<a name="l00424"></a>00424 <span class="comment">   */</span>
<a name="l00425"></a>00425    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#ac100e87d4f59a03f0ca63685def1ef15" title="Read system configuration from file.">System::readConfig</a>(std::istream &amp;in)
<a name="l00426"></a>00426    {
<a name="l00427"></a><a class="code" href="classMcMd_1_1System.html#ac100e87d4f59a03f0ca63685def1ef15">00427</a>       <span class="keywordflow">if</span> (!isEmpty()) removeAllMolecules();
<a name="l00428"></a>00428 
<a name="l00429"></a>00429       <span class="keywordflow">if</span> (configIoPtr_ == 0) {
<a name="l00430"></a>00430          configIoPtr_ = newDefaultConfigIo();
<a name="l00431"></a>00431       }
<a name="l00432"></a>00432       configIoPtr_-&gt;read(in);
<a name="l00433"></a>00433 
<a name="l00434"></a>00434 <span class="preprocessor">      #ifdef UTIL_DEBUG</span>
<a name="l00435"></a>00435 <span class="preprocessor"></span>      isValid();
<a name="l00436"></a>00436 <span class="preprocessor">      #endif</span>
<a name="l00437"></a>00437 <span class="preprocessor"></span>   }
<a name="l00438"></a>00438 
<a name="l00439"></a>00439    <span class="comment">/*</span>
<a name="l00440"></a>00440 <span class="comment">   * Write configuration to specified output stream.</span>
<a name="l00441"></a>00441 <span class="comment">   */</span>
<a name="l00442"></a>00442    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#af4e000e87b4e5bf4bc5d2ea9f7395b80" title="Write system configuration to a specified ostream.">System::writeConfig</a>(std::ostream &amp;out)
<a name="l00443"></a>00443    {
<a name="l00444"></a><a class="code" href="classMcMd_1_1System.html#af4e000e87b4e5bf4bc5d2ea9f7395b80">00444</a>       <span class="keywordflow">if</span> (configIoPtr_ == 0) {
<a name="l00445"></a>00445          configIoPtr_ = newDefaultConfigIo();
<a name="l00446"></a>00446       }
<a name="l00447"></a>00447       configIoPtr_-&gt;write(out);
<a name="l00448"></a>00448    }
<a name="l00449"></a>00449 
<a name="l00450"></a>00450    <span class="comment">/* </span>
<a name="l00451"></a>00451 <span class="comment">   * Save a System configuration to an archive.</span>
<a name="l00452"></a>00452 <span class="comment">   */</span>
<a name="l00453"></a>00453    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#a248dde9ccc0ef67e5d9cc5fd0bdc2b64" title="Save the System configuration to an archive.">System::save</a>(<a class="code" href="classUtil_1_1BinaryFileOArchive.html" title="Saving archive for binary ostream.">Serializable::OArchiveType</a>&amp; ar)
<a name="l00454"></a>00454    {  ar &amp; *<span class="keyword">this</span>; }
<a name="l00455"></a><a class="code" href="classMcMd_1_1System.html#a248dde9ccc0ef67e5d9cc5fd0bdc2b64">00455</a> 
<a name="l00456"></a>00456    <span class="comment">/* </span>
<a name="l00457"></a>00457 <span class="comment">   * Load a System configuration from an archive.</span>
<a name="l00458"></a>00458 <span class="comment">   */</span>
<a name="l00459"></a>00459    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#aa3d71af4cc5dfb2be6be816a8f562416" title="Load the System configuration from an archive.">System::load</a>(<a class="code" href="classUtil_1_1BinaryFileIArchive.html" title="Saving archive for binary istream.">Serializable::IArchiveType</a>&amp; ar)
<a name="l00460"></a>00460    {  ar &amp; *<span class="keyword">this</span>; }
<a name="l00461"></a><a class="code" href="classMcMd_1_1System.html#aa3d71af4cc5dfb2be6be816a8f562416">00461</a> 
<a name="l00462"></a>00462    <span class="comment">/*</span>
<a name="l00463"></a>00463 <span class="comment">   * Set System integer Id.</span>
<a name="l00464"></a>00464 <span class="comment">   *</span>
<a name="l00465"></a>00465 <span class="comment">   * Should be set immediately after the System is instantiated. If the System</span>
<a name="l00466"></a>00466 <span class="comment">   * is a member of the parent Simulation, setId() should be called in the</span>
<a name="l00467"></a>00467 <span class="comment">   * Simulation constructor.</span>
<a name="l00468"></a>00468 <span class="comment">   */</span>
<a name="l00469"></a>00469    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#af27d12f590d5654c5068497d58825b29" title="Set the integer Id for this System.">System::setId</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)
<a name="l00470"></a>00470    {  id_ = id; }
<a name="l00471"></a><a class="code" href="classMcMd_1_1System.html#af27d12f590d5654c5068497d58825b29">00471</a> 
<a name="l00472"></a>00472    <span class="comment">/*</span>
<a name="l00473"></a>00473 <span class="comment">   * Set pointer to the parent Simulation.</span>
<a name="l00474"></a>00474 <span class="comment">   *</span>
<a name="l00475"></a>00475 <span class="comment">   * Should be set immediately after System instantiation. If this System</span>
<a name="l00476"></a>00476 <span class="comment">   * is a member of the parent Simulation, setSimulation(*this) should be</span>
<a name="l00477"></a>00477 <span class="comment">   * called in the Simulation constructor.</span>
<a name="l00478"></a>00478 <span class="comment">   */</span>
<a name="l00479"></a>00479    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#ab27d22870403f73283d58b48a5d2eef1" title="Set the parent Simulation.">System::setSimulation</a>(<a class="code" href="classMcMd_1_1Simulation.html" title="The main object in a simulation, which coordinates others.">Simulation</a> &amp;simulation)
<a name="l00480"></a>00480    {
<a name="l00481"></a><a class="code" href="classMcMd_1_1System.html#ab27d22870403f73283d58b48a5d2eef1">00481</a>       assert(!simulationPtr_);
<a name="l00482"></a>00482       simulationPtr_ = &amp;simulation;
<a name="l00483"></a>00483    }
<a name="l00484"></a>00484 
<a name="l00485"></a>00485    <span class="comment">/*</span>
<a name="l00486"></a>00486 <span class="comment">   * Set pointer to a FileMaster.</span>
<a name="l00487"></a>00487 <span class="comment">   */</span>
<a name="l00488"></a>00488    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#a50e19b74402d024a2d3429e9fb793ac1" title="Set the FileMaster.">System::setFileMaster</a>(<a class="code" href="classMcMd_1_1FileMaster.html" title="A FileMaster manages a set of input and output files.">FileMaster</a> &amp;fileMaster)
<a name="l00489"></a>00489    {
<a name="l00490"></a><a class="code" href="classMcMd_1_1System.html#a50e19b74402d024a2d3429e9fb793ac1">00490</a>       assert(!fileMasterPtr_);
<a name="l00491"></a>00491       fileMasterPtr_ = &amp;fileMaster;
<a name="l00492"></a>00492    }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494    <span class="comment">// ConfigIoIo Management</span>
<a name="l00495"></a>00495 
<a name="l00496"></a>00496    <span class="comment">/*</span>
<a name="l00497"></a>00497 <span class="comment">   * Get the ConfigIo factory by reference.</span>
<a name="l00498"></a>00498 <span class="comment">   */</span>
<a name="l00499"></a>00499    <a class="code" href="classUtil_1_1Factory.html">Factory&lt;ConfigIo&gt;</a>&amp; <a class="code" href="classMcMd_1_1System.html#adf809dd00e6e980c6230becc119b5429" title="Get the configuration file reader/writer factory by reference.">System::configIoFactory</a>()
<a name="l00500"></a>00500    {
<a name="l00501"></a><a class="code" href="classMcMd_1_1System.html#adf809dd00e6e980c6230becc119b5429">00501</a>       <span class="keywordflow">if</span> (!configIoFactoryPtr_) {
<a name="l00502"></a>00502          configIoFactoryPtr_ = newDefaultConfigIoFactory();
<a name="l00503"></a>00503       }
<a name="l00504"></a>00504       <span class="keywordflow">return</span> *configIoFactoryPtr_;
<a name="l00505"></a>00505    }
<a name="l00506"></a>00506 
<a name="l00507"></a>00507    <span class="comment">/*</span>
<a name="l00508"></a>00508 <span class="comment">   * Return a pointer to a new ConfigIoFactory.</span>
<a name="l00509"></a>00509 <span class="comment">   */</span>
<a name="l00510"></a>00510    <a class="code" href="classUtil_1_1Factory.html">Factory&lt;ConfigIo&gt;</a>* <a class="code" href="classMcMd_1_1System.html#a63a95485e4bd3669636fa5a2ffad8a6f" title="Return a pointer to a new default ConfigIoFactory.">System::newDefaultConfigIoFactory</a>()
<a name="l00511"></a>00511    {  <span class="keywordflow">return</span> <span class="keyword">new</span> ConfigIoFactory(*<span class="keyword">this</span>); }
<a name="l00512"></a><a class="code" href="classMcMd_1_1System.html#a63a95485e4bd3669636fa5a2ffad8a6f">00512</a> 
<a name="l00513"></a>00513    <span class="comment">/*</span>
<a name="l00514"></a>00514 <span class="comment">   * Set the ConfigIo, identified by subclass name.</span>
<a name="l00515"></a>00515 <span class="comment">   */</span>
<a name="l00516"></a>00516    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#ad05e4313ced6e3e8b84e6de6a9c796c7" title="Create a new configuration file reader/writer.">System::setConfigIo</a>(std::string&amp; classname)
<a name="l00517"></a>00517    {
<a name="l00518"></a><a class="code" href="classMcMd_1_1System.html#ad05e4313ced6e3e8b84e6de6a9c796c7">00518</a>       <span class="keywordflow">if</span> (!configIoFactoryPtr_) {
<a name="l00519"></a>00519          configIoFactoryPtr_ = newDefaultConfigIoFactory();
<a name="l00520"></a>00520       }
<a name="l00521"></a>00521       <a class="code" href="classMcMd_1_1ConfigIo.html" title="System configuration file reader and writer.">ConfigIo</a>* ptr = configIoFactoryPtr_-&gt;factory(classname);
<a name="l00522"></a>00522       <span class="keywordflow">if</span> (!ptr) {
<a name="l00523"></a>00523          <a class="code" href="global_8h.html#ad2512f8bd062d41d66799cf900151487" title="Macro for throwing an Exception, reporting function, file and line number.">UTIL_THROW</a>(<span class="stringliteral">&quot;Unrecognized ConfigIo subclass name&quot;</span>);
<a name="l00524"></a>00524       } 
<a name="l00525"></a>00525       <span class="keywordflow">if</span> (configIoPtr_) {
<a name="l00526"></a>00526          <span class="keyword">delete</span> configIoPtr_;
<a name="l00527"></a>00527       }
<a name="l00528"></a>00528       configIoPtr_ = ptr;
<a name="l00529"></a>00529    }
<a name="l00530"></a>00530 
<a name="l00531"></a>00531    <span class="comment">// TrajectoryIo Management</span>
<a name="l00532"></a>00532 
<a name="l00533"></a>00533    <span class="comment">/*</span>
<a name="l00534"></a>00534 <span class="comment">   * Get the TrajectoryIo factory by reference.</span>
<a name="l00535"></a>00535 <span class="comment">   */</span>
<a name="l00536"></a>00536    <a class="code" href="classUtil_1_1Factory.html">Factory&lt;TrajectoryIo&gt;</a>&amp; <a class="code" href="classMcMd_1_1System.html#ae008970fa0d6215fbf8590bcf26a28d9" title="Get the trajectory reader/writer factory by reference.">System::trajectoryIoFactory</a>()
<a name="l00537"></a>00537    {
<a name="l00538"></a><a class="code" href="classMcMd_1_1System.html#ae008970fa0d6215fbf8590bcf26a28d9">00538</a>       <span class="keywordflow">if</span> (!trajectoryIoFactoryPtr_) {
<a name="l00539"></a>00539          trajectoryIoFactoryPtr_ = newDefaultTrajectoryIoFactory();
<a name="l00540"></a>00540       }
<a name="l00541"></a>00541       <span class="keywordflow">return</span> *trajectoryIoFactoryPtr_;
<a name="l00542"></a>00542    }
<a name="l00543"></a>00543 
<a name="l00544"></a>00544    <span class="comment">/*</span>
<a name="l00545"></a>00545 <span class="comment">   * Return pointer to a new instance of default TrajectoryIo factory.</span>
<a name="l00546"></a>00546 <span class="comment">   */</span>
<a name="l00547"></a>00547    <a class="code" href="classUtil_1_1Factory.html">Factory&lt;TrajectoryIo&gt;</a>* <a class="code" href="classMcMd_1_1System.html#a560a09df24e42b077dd953880eece745" title="Return a pointer to a new default TrajectoryIoFactory.">System::newDefaultTrajectoryIoFactory</a>()
<a name="l00548"></a>00548    {  <span class="keywordflow">return</span> <span class="keyword">new</span> TrajectoryIoFactory(*<span class="keyword">this</span>); }
<a name="l00549"></a><a class="code" href="classMcMd_1_1System.html#a560a09df24e42b077dd953880eece745">00549</a> 
<a name="l00550"></a>00550 <span class="preprocessor">   #ifdef MCMD_PERTURB</span>
<a name="l00551"></a>00551 <span class="preprocessor"></span>   <span class="comment">/*</span>
<a name="l00552"></a>00552 <span class="comment">   * Set this system to expect a Perturbation in the param file.</span>
<a name="l00553"></a>00553 <span class="comment">   * Also creates the perturbation factory.</span>
<a name="l00554"></a>00554 <span class="comment">   */</span>
<a name="l00555"></a>00555    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#a214b2272ce54ee70340853f3b55dd16f" title="Set to expect a Perturbation in the parameter file.">System::setExpectPerturbation</a>()
<a name="l00556"></a>00556    {
<a name="l00557"></a><a class="code" href="classMcMd_1_1System.html#a214b2272ce54ee70340853f3b55dd16f">00557</a>       <span class="comment">// create perturbation factory</span>
<a name="l00558"></a>00558       perturbationFactoryPtr_ = newDefaultPerturbationFactory();
<a name="l00559"></a>00559       createdPerturbationFactory_ = <span class="keyword">true</span>;
<a name="l00560"></a>00560 
<a name="l00561"></a>00561       <span class="keywordflow">if</span> (hasPerturbation()) {
<a name="l00562"></a>00562          <a class="code" href="global_8h.html#ad2512f8bd062d41d66799cf900151487" title="Macro for throwing an Exception, reporting function, file and line number.">UTIL_THROW</a>(<span class="stringliteral">&quot;A Perturbation is already set&quot;</span>);
<a name="l00563"></a>00563       }
<a name="l00564"></a>00564       expectPerturbationParam_ = <span class="keyword">true</span>;
<a name="l00565"></a>00565    }
<a name="l00566"></a>00566 
<a name="l00567"></a>00567    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#ace51b5e2bb80676967deb5e34f138506" title="Read the perturbation parameter block (if any)">System::readPerturbation</a>(std::istream&amp; in) 
<a name="l00568"></a>00568    {
<a name="l00569"></a><a class="code" href="classMcMd_1_1System.html#ace51b5e2bb80676967deb5e34f138506">00569</a> 
<a name="l00570"></a>00570       <span class="comment">// Create Perturbation and read object, if required.</span>
<a name="l00571"></a>00571       <span class="keywordflow">if</span> (!hasPerturbation() and expectPerturbationParam_) {
<a name="l00572"></a>00572          std::string className;
<a name="l00573"></a>00573          <span class="keywordtype">bool</span>        isEnd;
<a name="l00574"></a>00574          perturbationPtr_ = 
<a name="l00575"></a>00575             perturbationFactoryPtr_-&gt;readObject(in, *<span class="keyword">this</span>, className, isEnd);
<a name="l00576"></a>00576          <span class="keywordflow">if</span> (!perturbationPtr_) {
<a name="l00577"></a>00577             std::string msg = <span class="stringliteral">&quot;Unrecognized Perturbation subclass name &quot;</span>;
<a name="l00578"></a>00578             msg += className;
<a name="l00579"></a>00579             <a class="code" href="global_8h.html#ad2512f8bd062d41d66799cf900151487" title="Macro for throwing an Exception, reporting function, file and line number.">UTIL_THROW</a>(msg.c_str());
<a name="l00580"></a>00580          }
<a name="l00581"></a>00581          createdPerturbation_ = <span class="keyword">true</span>;
<a name="l00582"></a>00582       }
<a name="l00583"></a>00583    }
<a name="l00584"></a>00584 <span class="preprocessor">   #ifdef UTIL_MPI  </span>
<a name="l00585"></a>00585 <span class="preprocessor"></span>   <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#a723882ac3da3005b48a8351727f9f118" title="Read the ReplicaMove parameter block (if any)">System::readReplicaMove</a>(std::istream&amp; in) 
<a name="l00586"></a>00586    {
<a name="l00587"></a><a class="code" href="classMcMd_1_1System.html#a723882ac3da3005b48a8351727f9f118">00587</a>       <span class="keywordflow">if</span> (hasPerturbation()) {
<a name="l00588"></a>00588           read&lt;bool&gt;(in, <span class="stringliteral">&quot;hasReplicaMove&quot;</span>, hasReplicaMove_);
<a name="l00589"></a>00589           <span class="keywordflow">if</span> (hasReplicaMove_) {
<a name="l00590"></a>00590              replicaMovePtr_ = <span class="keyword">new</span> <a class="code" href="classMcMd_1_1ReplicaMove.html" title="Replica exchange Monte Carlo move using Gibbs sampling.">ReplicaMove</a>(*<span class="keyword">this</span>);
<a name="l00591"></a>00591              readParamComposite(in, *replicaMovePtr_);
<a name="l00592"></a>00592              <span class="comment">// replicaMovePtr_-&gt;initialize();</span>
<a name="l00593"></a>00593           }
<a name="l00594"></a>00594           createdReplicaMove_ = <span class="keyword">true</span>;
<a name="l00595"></a>00595       } <span class="keywordflow">else</span> {
<a name="l00596"></a>00596          hasReplicaMove_ = <span class="keyword">false</span>;
<a name="l00597"></a>00597       }
<a name="l00598"></a>00598    }
<a name="l00599"></a>00599 <span class="preprocessor">   #endif // UTIL_MPI</span>
<a name="l00600"></a>00600 <span class="preprocessor"></span><span class="preprocessor">   #endif // MCMD_PERTURB</span>
<a name="l00601"></a>00601 <span class="preprocessor"></span>
<a name="l00602"></a>00602    <span class="comment">/*</span>
<a name="l00603"></a>00603 <span class="comment">   * Allocate and initialize a MoleculeSet for each Species.</span>
<a name="l00604"></a>00604 <span class="comment">   */</span>
<a name="l00605"></a>00605    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#ac4191cf150808e3a7cf4c4d891e9694f" title="Allocate and initialize molecule sets for all species.">System::allocateMoleculeSets</a>()
<a name="l00606"></a>00606    {
<a name="l00607"></a><a class="code" href="classMcMd_1_1System.html#ac4191cf150808e3a7cf4c4d891e9694f">00607</a>       <span class="comment">// Preconditions</span>
<a name="l00608"></a>00608       assert(simulationPtr_);
<a name="l00609"></a>00609 
<a name="l00610"></a>00610       <span class="comment">// Allocate an array of nSpecies empty MoleculeSet objects.</span>
<a name="l00611"></a>00611       <span class="keywordtype">int</span> nSpecies = simulationPtr_-&gt;nSpecies();
<a name="l00612"></a>00612       moleculeSetsPtr_-&gt;allocate(nSpecies);
<a name="l00613"></a>00613 
<a name="l00614"></a>00614       <span class="comment">// Allocate and initialize the MoleculeSet for each species.</span>
<a name="l00615"></a>00615       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; nSpecies; ++i) {
<a name="l00616"></a>00616          simulation().allocateMoleculeSet((*moleculeSetsPtr_)[i], i);
<a name="l00617"></a>00617       }
<a name="l00618"></a>00618    }
<a name="l00619"></a>00619 
<a name="l00620"></a>00620    <span class="comment">/*</span>
<a name="l00621"></a>00621 <span class="comment">   * Add a molecule to this System.</span>
<a name="l00622"></a>00622 <span class="comment">   */</span>
<a name="l00623"></a>00623    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#a939f190986aed5350c92022b59cab7b4" title="Add a Molecule to this System.">System::addMolecule</a>(Molecule&amp; molecule)
<a name="l00624"></a>00624    {
<a name="l00625"></a><a class="code" href="classMcMd_1_1System.html#a939f190986aed5350c92022b59cab7b4">00625</a>       assert(moleculeSetsPtr_);
<a name="l00626"></a>00626 
<a name="l00627"></a>00627       <span class="keywordtype">int</span> speciesId = molecule.species().id();
<a name="l00628"></a>00628       <span class="keywordflow">if</span> ( speciesId &gt;= moleculeSetsPtr_-&gt;capacity()) {
<a name="l00629"></a>00629          <a class="code" href="global_8h.html#ad2512f8bd062d41d66799cf900151487" title="Macro for throwing an Exception, reporting function, file and line number.">UTIL_THROW</a>(<span class="stringliteral">&quot;Error: speciesId &gt;= moleculeSetsPtr_-&gt;capacity()&quot;</span>);
<a name="l00630"></a>00630       }
<a name="l00631"></a>00631       (*moleculeSetsPtr_)[speciesId].append(molecule);
<a name="l00632"></a>00632       molecule.setSystem(*<span class="keyword">this</span>);
<a name="l00633"></a>00633 
<a name="l00634"></a>00634       <span class="comment">// notify observers</span>
<a name="l00635"></a>00635       notifyMoleculeSetObservers();
<a name="l00636"></a>00636    }
<a name="l00637"></a>00637 
<a name="l00638"></a>00638    <span class="comment">/*</span>
<a name="l00639"></a>00639 <span class="comment">   * Remove a molecule from this System.</span>
<a name="l00640"></a>00640 <span class="comment">   */</span>
<a name="l00641"></a>00641    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#a7a75483a0b7177fea44256f01ce0534c" title="Remove a specific molecule from this System.">System::removeMolecule</a>(Molecule&amp; molecule)
<a name="l00642"></a>00642    {
<a name="l00643"></a><a class="code" href="classMcMd_1_1System.html#a7a75483a0b7177fea44256f01ce0534c">00643</a>       assert(moleculeSetsPtr_);
<a name="l00644"></a>00644 
<a name="l00645"></a>00645       <span class="keywordflow">if</span> ( &amp;molecule.system() != <span class="keyword">this</span>) {
<a name="l00646"></a>00646          <a class="code" href="global_8h.html#ad2512f8bd062d41d66799cf900151487" title="Macro for throwing an Exception, reporting function, file and line number.">UTIL_THROW</a>(<span class="stringliteral">&quot;Attempt to remove Molecule that is not in this System.&quot;</span>);
<a name="l00647"></a>00647       }
<a name="l00648"></a>00648       <span class="keywordtype">int</span> speciesId = molecule.species().id();
<a name="l00649"></a>00649       (*moleculeSetsPtr_)[speciesId].remove(molecule);
<a name="l00650"></a>00650       molecule.unsetSystem();
<a name="l00651"></a>00651 
<a name="l00652"></a>00652       <span class="comment">// notify observers</span>
<a name="l00653"></a>00653       notifyMoleculeSetObservers();
<a name="l00654"></a>00654    }
<a name="l00655"></a>00655 
<a name="l00656"></a>00656    <span class="comment">/*</span>
<a name="l00657"></a>00657 <span class="comment">   * Is this System empty (i.e., devoid of Molecules) ?</span>
<a name="l00658"></a>00658 <span class="comment">   */</span>
<a name="l00659"></a>00659    <span class="keywordtype">bool</span> <a class="code" href="classMcMd_1_1System.html#a479432127ee77145cc19d6a2d1590821" title="Is this an empty System (i.e., one with no molecules) ?">System::isEmpty</a>()<span class="keyword"> const</span>
<a name="l00660"></a>00660 <span class="keyword">   </span>{
<a name="l00661"></a><a class="code" href="classMcMd_1_1System.html#a479432127ee77145cc19d6a2d1590821">00661</a>       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; simulation().nSpecies(); ++i) {
<a name="l00662"></a>00662          <span class="keywordflow">if</span> (nMolecule(i) != 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00663"></a>00663       }
<a name="l00664"></a>00664       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00665"></a>00665    }
<a name="l00666"></a>00666 
<a name="l00667"></a>00667    <span class="comment">/*</span>
<a name="l00668"></a>00668 <span class="comment">   * Return all molecules of all Species to their reservoirs.</span>
<a name="l00669"></a>00669 <span class="comment">   *</span>
<a name="l00670"></a>00670 <span class="comment">   * Ifdef MCMD_LINK, it also clears the LinkMaster.</span>
<a name="l00671"></a>00671 <span class="comment">   */</span>
<a name="l00672"></a>00672    <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1System.html#ab4d744d97b543873e089904172bfe415" title="Remove all molecules from this System.">System::removeAllMolecules</a>()
<a name="l00673"></a>00673    {
<a name="l00674"></a><a class="code" href="classMcMd_1_1System.html#ab4d744d97b543873e089904172bfe415">00674</a>       <a class="code" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a>*  speciesPtr;
<a name="l00675"></a>00675       <a class="code" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a>* molPtr;
<a name="l00676"></a>00676       <span class="keywordtype">int</span>       iSpecies, nMol;
<a name="l00677"></a>00677       <span class="keywordflow">for</span> (iSpecies = 0; iSpecies &lt; simulation().nSpecies(); ++iSpecies) {
<a name="l00678"></a>00678          speciesPtr = &amp;simulation().species(iSpecies);
<a name="l00679"></a>00679          nMol  = nMolecule(iSpecies);
<a name="l00680"></a>00680          <span class="keywordflow">while</span> (nMol &gt; 0) {
<a name="l00681"></a>00681             molPtr = &amp;molecule(iSpecies, nMol - 1);
<a name="l00682"></a>00682             removeMolecule(*molPtr);
<a name="l00683"></a>00683             speciesPtr-&gt;<a class="code" href="classMcMd_1_1Species.html#a5c347060621ccff81193a1674ae34891" title="Get the reservoir for this Species by reference.">reservoir</a>().push(*molPtr);
<a name="l00684"></a>00684             nMol = nMolecule(iSpecies);
<a name="l00685"></a>00685          }
<a name="l00686"></a>00686       }
<a name="l00687"></a>00687 
<a name="l00688"></a>00688 <span class="preprocessor">      #ifdef MCMD_LINK</span>
<a name="l00689"></a>00689 <span class="preprocessor"></span>      linkMaster().clear();
<a name="l00690"></a>00690 <span class="preprocessor">      #endif</span>
<a name="l00691"></a>00691 <span class="preprocessor"></span>
<a name="l00692"></a>00692       <span class="comment">// notify observers</span>
<a name="l00693"></a>00693       notifyMoleculeSetObservers();
<a name="l00694"></a>00694    }
<a name="l00695"></a>00695 
<a name="l00696"></a>00696    <span class="comment">/*</span>
<a name="l00697"></a>00697 <span class="comment">   * Get the index of a molecule within its Species in this System.</span>
<a name="l00698"></a>00698 <span class="comment">   */</span>
<a name="l00699"></a>00699    <span class="keywordtype">int</span> <a class="code" href="classMcMd_1_1System.html#ac8cd93b936f696fc65bd9a02b5a1dd89" title="Get the index of a Molecule within its Species in this System.">System::moleculeId</a>(<span class="keyword">const</span> Molecule&amp; molecule)<span class="keyword"> const</span>
<a name="l00700"></a>00700 <span class="keyword">   </span>{
<a name="l00701"></a><a class="code" href="classMcMd_1_1System.html#ac8cd93b936f696fc65bd9a02b5a1dd89">00701</a>       assert(moleculeSetsPtr_);
<a name="l00702"></a>00702 
<a name="l00703"></a>00703       <span class="keywordtype">int</span> speciesId = molecule.species().id();
<a name="l00704"></a>00704       <span class="keywordflow">return</span> (*moleculeSetsPtr_)[speciesId].index(molecule);
<a name="l00705"></a>00705    }
<a name="l00706"></a>00706 
<a name="l00707"></a>00707    <span class="comment">/* </span>
<a name="l00708"></a>00708 <span class="comment">   * Get a randomly chosen molecule of a specified Species.</span>
<a name="l00709"></a>00709 <span class="comment">   */</span>
<a name="l00710"></a>00710    <a class="code" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a>&amp; <a class="code" href="classMcMd_1_1System.html#a9e99d6097de211df530b5859c2b034b1" title="Get a random Molecule of a specified species in this System.">System::randomMolecule</a>(<span class="keywordtype">int</span> speciesId)
<a name="l00711"></a>00711    {
<a name="l00712"></a><a class="code" href="classMcMd_1_1System.html#a9e99d6097de211df530b5859c2b034b1">00712</a>       <span class="keywordtype">int</span> nMol, moleculeId;
<a name="l00713"></a>00713       nMol  = nMolecule(speciesId); 
<a name="l00714"></a>00714       <span class="keywordflow">if</span> (nMol &lt;= 0) {
<a name="l00715"></a>00715          <a class="code" href="global_8h.html#ad2512f8bd062d41d66799cf900151487" title="Macro for throwing an Exception, reporting function, file and line number.">UTIL_THROW</a>(<span class="stringliteral">&quot;Number of molecules in species &lt;= 0&quot;</span>);
<a name="l00716"></a>00716       }
<a name="l00717"></a>00717       moleculeId = simulation().random().uniformInt(0, nMol);
<a name="l00718"></a>00718       <span class="keywordflow">return</span> molecule(speciesId, moleculeId); 
<a name="l00719"></a>00719    }
<a name="l00720"></a>00720 
<a name="l00721"></a>00721    <span class="comment">/*</span>
<a name="l00722"></a>00722 <span class="comment">   * Return the total number of atoms in this System.</span>
<a name="l00723"></a>00723 <span class="comment">   */</span>
<a name="l00724"></a>00724    <span class="keywordtype">int</span> <a class="code" href="classMcMd_1_1System.html#ac91579bd63979a294891d330a5533838" title="Return the total number of atoms in this System.">System::nAtom</a>()<span class="keyword"> const</span>
<a name="l00725"></a>00725 <span class="keyword">   </span>{
<a name="l00726"></a><a class="code" href="classMcMd_1_1System.html#ac91579bd63979a294891d330a5533838">00726</a>       <span class="keywordtype">int</span> sum = 0;
<a name="l00727"></a>00727       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; simulation().nSpecies(); ++i) {
<a name="l00728"></a>00728          sum += nMolecule(i)*simulation().species(i).nAtom();
<a name="l00729"></a>00729       }
<a name="l00730"></a>00730       <span class="keywordflow">return</span> sum;
<a name="l00731"></a>00731    }
<a name="l00732"></a>00732 
<a name="l00733"></a>00733 <span class="preprocessor">   #ifndef INTER_NOPAIR</span>
<a name="l00734"></a>00734 <span class="preprocessor"></span>   <span class="comment">/*</span>
<a name="l00735"></a>00735 <span class="comment">   * Return the PairFactory by reference.</span>
<a name="l00736"></a>00736 <span class="comment">   */</span>
<a name="l00737"></a>00737    PairFactory&amp; <a class="code" href="classMcMd_1_1System.html#a976367a2e4dc264de1ce24ebbcd41994" title="Get the PairFactory by reference.">System::pairFactory</a>()
<a name="l00738"></a>00738    {
<a name="l00739"></a><a class="code" href="classMcMd_1_1System.html#a976367a2e4dc264de1ce24ebbcd41994">00739</a>       <span class="keywordflow">if</span> (!pairFactoryPtr_) {
<a name="l00740"></a>00740          pairFactoryPtr_ = <span class="keyword">new</span> <a class="code" href="classMcMd_1_1PairFactory.html" title="Factory for subclasses MdPairPotential or McPairPotential.">PairFactory</a>;
<a name="l00741"></a>00741       }
<a name="l00742"></a>00742       assert(pairFactoryPtr_);
<a name="l00743"></a>00743       <span class="keywordflow">return</span> *pairFactoryPtr_;
<a name="l00744"></a>00744    }
<a name="l00745"></a>00745 
<a name="l00746"></a>00746    <span class="comment">/*</span>
<a name="l00747"></a>00747 <span class="comment">   * Get the pair style string.</span>
<a name="l00748"></a>00748 <span class="comment">   */</span>
<a name="l00749"></a>00749    std::string <a class="code" href="classMcMd_1_1System.html#ab5df9a80f1bd3006eb704724ca8e2def" title="Return nonbonded pair style string.">System::pairStyle</a>()<span class="keyword"> const</span>
<a name="l00750"></a>00750 <span class="keyword">   </span>{  <span class="keywordflow">return</span> pairStyle_;  }
<a name="l00751"></a><a class="code" href="classMcMd_1_1System.html#ab5df9a80f1bd3006eb704724ca8e2def">00751</a> <span class="preprocessor">   #endif</span>
<a name="l00752"></a>00752 <span class="preprocessor"></span>
<a name="l00753"></a>00753    <span class="comment">/*</span>
<a name="l00754"></a>00754 <span class="comment">   * Return the BondFactory by reference.</span>
<a name="l00755"></a>00755 <span class="comment">   */</span>
<a name="l00756"></a>00756    <a class="code" href="classUtil_1_1Factory.html">Factory&lt;BondPotential&gt;</a>&amp; <a class="code" href="classMcMd_1_1System.html#ac5eaa682a9e4dd7bf3b166071e1d69a8" title="Get the associated Factory&amp;lt;BondPotential&amp;gt; by reference.">System::bondFactory</a>()
<a name="l00757"></a>00757    {
<a name="l00758"></a><a class="code" href="classMcMd_1_1System.html#ac5eaa682a9e4dd7bf3b166071e1d69a8">00758</a>       <span class="keywordflow">if</span> (!bondFactoryPtr_) {
<a name="l00759"></a>00759          bondFactoryPtr_ = <span class="keyword">new</span> <a class="code" href="classMcMd_1_1BondFactory.html" title="Factory for BondPotential objects.">BondFactory</a>(*<span class="keyword">this</span>);
<a name="l00760"></a>00760       }
<a name="l00761"></a>00761       assert(bondFactoryPtr_);
<a name="l00762"></a>00762       <span class="keywordflow">return</span> *bondFactoryPtr_;
<a name="l00763"></a>00763    }
<a name="l00764"></a>00764 
<a name="l00765"></a>00765    <span class="comment">/*</span>
<a name="l00766"></a>00766 <span class="comment">   * Get the bond style string.</span>
<a name="l00767"></a>00767 <span class="comment">   */</span>
<a name="l00768"></a>00768    std::string <a class="code" href="classMcMd_1_1System.html#a4d83d946cf31b1ac66aece56b7133683" title="Return covalent bond style string.">System::bondStyle</a>()<span class="keyword"> const</span>
<a name="l00769"></a>00769 <span class="keyword">   </span>{  <span class="keywordflow">return</span> bondStyle_;  }
<a name="l00770"></a><a class="code" href="classMcMd_1_1System.html#a4d83d946cf31b1ac66aece56b7133683">00770</a> 
<a name="l00771"></a>00771 <span class="preprocessor">   #ifdef INTER_ANGLE</span>
<a name="l00772"></a>00772 <span class="preprocessor"></span>   <span class="comment">/*</span>
<a name="l00773"></a>00773 <span class="comment">   * Return the AngleFactory by reference.</span>
<a name="l00774"></a>00774 <span class="comment">   */</span>
<a name="l00775"></a>00775    <a class="code" href="classUtil_1_1Factory.html">Factory&lt;AnglePotential&gt;</a>&amp; System::angleFactory()
<a name="l00776"></a>00776    {
<a name="l00777"></a>00777       <span class="keywordflow">if</span> (angleFactoryPtr_ == 0) {
<a name="l00778"></a>00778          angleFactoryPtr_ = <span class="keyword">new</span> <a class="code" href="classMcMd_1_1AngleFactory.html" title="Factory for subclasses of AnglePotential.">AngleFactory</a>(*<span class="keyword">this</span>);
<a name="l00779"></a>00779       }
<a name="l00780"></a>00780       assert(angleFactoryPtr_);
<a name="l00781"></a>00781       <span class="keywordflow">return</span> *angleFactoryPtr_;
<a name="l00782"></a>00782    }
<a name="l00783"></a>00783 
<a name="l00784"></a>00784    <span class="comment">/*</span>
<a name="l00785"></a>00785 <span class="comment">   * Get the angle style string.</span>
<a name="l00786"></a>00786 <span class="comment">   */</span>
<a name="l00787"></a>00787    std::string System::angleStyle()<span class="keyword"> const</span>
<a name="l00788"></a>00788 <span class="keyword">   </span>{  <span class="keywordflow">return</span> angleStyle_;  }
<a name="l00789"></a>00789 <span class="preprocessor">   #endif</span>
<a name="l00790"></a>00790 <span class="preprocessor"></span>
<a name="l00791"></a>00791 <span class="preprocessor">   #ifdef INTER_DIHEDRAL</span>
<a name="l00792"></a>00792 <span class="preprocessor"></span>   <span class="comment">/*</span>
<a name="l00793"></a>00793 <span class="comment">   * Return the DihedralFactory by reference.</span>
<a name="l00794"></a>00794 <span class="comment">   */</span>
<a name="l00795"></a>00795    <a class="code" href="classUtil_1_1Factory.html">Factory&lt;DihedralPotential&gt;</a>&amp; System::dihedralFactory()
<a name="l00796"></a>00796    {
<a name="l00797"></a>00797       <span class="keywordflow">if</span> (dihedralFactoryPtr_ == 0) {
<a name="l00798"></a>00798          dihedralFactoryPtr_ = <span class="keyword">new</span> DihedralFactory(*<span class="keyword">this</span>);
<a name="l00799"></a>00799       }
<a name="l00800"></a>00800       assert(dihedralFactoryPtr_);
<a name="l00801"></a>00801       <span class="keywordflow">return</span> *dihedralFactoryPtr_;
<a name="l00802"></a>00802    }
<a name="l00803"></a>00803 
<a name="l00804"></a>00804    <span class="comment">/*</span>
<a name="l00805"></a>00805 <span class="comment">   * Get the dihedral style string.</span>
<a name="l00806"></a>00806 <span class="comment">   */</span>
<a name="l00807"></a>00807    std::string System::dihedralStyle()<span class="keyword"> const</span>
<a name="l00808"></a>00808 <span class="keyword">   </span>{  <span class="keywordflow">return</span> dihedralStyle_;  }
<a name="l00809"></a>00809 
<a name="l00810"></a>00810 <span class="preprocessor">   #endif</span>
<a name="l00811"></a>00811 <span class="preprocessor"></span>
<a name="l00812"></a>00812 <span class="preprocessor">   #ifdef MCMD_LINK</span>
<a name="l00813"></a>00813 <span class="preprocessor"></span>   <span class="comment">/*</span>
<a name="l00814"></a>00814 <span class="comment">   * Return the Link factory by reference.</span>
<a name="l00815"></a>00815 <span class="comment">   */</span>
<a name="l00816"></a>00816    <a class="code" href="classUtil_1_1Factory.html">Factory&lt;BondPotential&gt;</a>&amp; <a class="code" href="classMcMd_1_1System.html#ab47c9b547be97452125059dac6902411" title="Get the associated Link factory by reference.">System::linkFactory</a>()
<a name="l00817"></a>00817    {
<a name="l00818"></a><a class="code" href="classMcMd_1_1System.html#ab47c9b547be97452125059dac6902411">00818</a>       <span class="keywordflow">if</span> (linkFactoryPtr_ == 0) {
<a name="l00819"></a>00819          linkFactoryPtr_ = <span class="keyword">new</span> <a class="code" href="classMcMd_1_1LinkFactory.html" title="Factory for subclasses of MdBondPotential or McBondPotential.">LinkFactory</a>(*<span class="keyword">this</span>);
<a name="l00820"></a>00820       }
<a name="l00821"></a>00821       assert(linkFactoryPtr_);
<a name="l00822"></a>00822       <span class="keywordflow">return</span> *linkFactoryPtr_;
<a name="l00823"></a>00823    }
<a name="l00824"></a>00824 
<a name="l00825"></a>00825    <span class="comment">/*</span>
<a name="l00826"></a>00826 <span class="comment">   * Get the link style string.</span>
<a name="l00827"></a>00827 <span class="comment">   */</span>
<a name="l00828"></a>00828    std::string <a class="code" href="classMcMd_1_1System.html#a1e494de13daea009a8a7c25ab61d5195" title="Return link potential style string.">System::linkStyle</a>()<span class="keyword"> const</span>
<a name="l00829"></a>00829 <span class="keyword">   </span>{  <span class="keywordflow">return</span> linkStyle_;  }
<a name="l00830"></a><a class="code" href="classMcMd_1_1System.html#a1e494de13daea009a8a7c25ab61d5195">00830</a> <span class="preprocessor">   #endif</span>
<a name="l00831"></a>00831 <span class="preprocessor"></span>
<a name="l00832"></a>00832 <span class="preprocessor">   #ifdef INTER_EXTERNAL</span>
<a name="l00833"></a>00833 <span class="preprocessor"></span>   <span class="comment">/*</span>
<a name="l00834"></a>00834 <span class="comment">   * Return the ExternalFactory by reference.</span>
<a name="l00835"></a>00835 <span class="comment">   */</span>
<a name="l00836"></a>00836    <a class="code" href="classUtil_1_1Factory.html">Factory&lt;ExternalPotential&gt;</a>&amp; <a class="code" href="classMcMd_1_1System.html#affe41c37893b4fb65b5aabb705b4271c" title="Get the associated ExternalPotential factory by reference.">System::externalFactory</a>()
<a name="l00837"></a>00837    {
<a name="l00838"></a><a class="code" href="classMcMd_1_1System.html#affe41c37893b4fb65b5aabb705b4271c">00838</a>       <span class="keywordflow">if</span> (externalFactoryPtr_ == 0) {
<a name="l00839"></a>00839          externalFactoryPtr_ = <span class="keyword">new</span> <a class="code" href="classMcMd_1_1ExternalFactory.html" title="Factory for subclasses MdExternalPotential or McExternalPotential.">ExternalFactory</a>(*<span class="keyword">this</span>);
<a name="l00840"></a>00840       }
<a name="l00841"></a>00841       assert(externalFactoryPtr_);
<a name="l00842"></a>00842       <span class="keywordflow">return</span> *externalFactoryPtr_;
<a name="l00843"></a>00843    }
<a name="l00844"></a>00844 
<a name="l00845"></a>00845    <span class="comment">/*</span>
<a name="l00846"></a>00846 <span class="comment">   * Get the external style string.</span>
<a name="l00847"></a>00847 <span class="comment">   */</span>
<a name="l00848"></a>00848    std::string <a class="code" href="classMcMd_1_1System.html#a70125de9a41d1ad0aa7c002e69fd9af6" title="Return external potential style string.">System::externalStyle</a>()<span class="keyword"> const</span>
<a name="l00849"></a>00849 <span class="keyword">   </span>{  <span class="keywordflow">return</span> externalStyle_;  }
<a name="l00850"></a><a class="code" href="classMcMd_1_1System.html#a70125de9a41d1ad0aa7c002e69fd9af6">00850</a> <span class="preprocessor">   #endif</span>
<a name="l00851"></a>00851 <span class="preprocessor"></span>
<a name="l00852"></a>00852 <span class="preprocessor">   #ifdef INTER_TETHER</span>
<a name="l00853"></a>00853 <span class="preprocessor"></span>   <span class="comment">/*</span>
<a name="l00854"></a>00854 <span class="comment">   * Return the TetherFactory by reference.</span>
<a name="l00855"></a>00855 <span class="comment">   */</span>
<a name="l00856"></a>00856    TetherFactory&amp; System::tetherFactory()
<a name="l00857"></a>00857    {
<a name="l00858"></a>00858       <span class="keywordflow">if</span> (tetherFactoryPtr_ == 0) {
<a name="l00859"></a>00859          tetherFactoryPtr_ = <span class="keyword">new</span> TetherFactory;
<a name="l00860"></a>00860       }
<a name="l00861"></a>00861       assert(tetherFactoryPtr_);
<a name="l00862"></a>00862       <span class="keywordflow">return</span> *tetherFactoryPtr_;
<a name="l00863"></a>00863    }
<a name="l00864"></a>00864 
<a name="l00865"></a>00865    <span class="comment">/*</span>
<a name="l00866"></a>00866 <span class="comment">   * Get the tether style string.</span>
<a name="l00867"></a>00867 <span class="comment">   */</span>
<a name="l00868"></a>00868    std::string System::tetherStyle()<span class="keyword"> const</span>
<a name="l00869"></a>00869 <span class="keyword">   </span>{  <span class="keywordflow">return</span> tetherStyle_;  }
<a name="l00870"></a>00870 <span class="preprocessor">   #endif</span>
<a name="l00871"></a>00871 <span class="preprocessor"></span>
<a name="l00872"></a>00872    <span class="comment">/*</span>
<a name="l00873"></a>00873 <span class="comment">   * Check validity of all data structures.</span>
<a name="l00874"></a>00874 <span class="comment">   */</span>
<a name="l00875"></a>00875    <span class="keywordtype">bool</span> <a class="code" href="classMcMd_1_1System.html#aac1b70a2ed67ead038c4d3f5ac4d8a81" title="Return true if valid, or throw Exception.">System::isValid</a>()<span class="keyword"> const</span>
<a name="l00876"></a>00876 <span class="keyword">   </span>{
<a name="l00877"></a><a class="code" href="classMcMd_1_1System.html#aac1b70a2ed67ead038c4d3f5ac4d8a81">00877</a>       <a class="code" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a>* molPtr;
<a name="l00878"></a>00878       <span class="keywordtype">int</span>       iSpecies, iMolecule;
<a name="l00879"></a>00879       <span class="keywordflow">if</span> (!simulationPtr_) {
<a name="l00880"></a>00880          <a class="code" href="global_8h.html#ad2512f8bd062d41d66799cf900151487" title="Macro for throwing an Exception, reporting function, file and line number.">UTIL_THROW</a>(<span class="stringliteral">&quot;Null simulationPtr_&quot;</span>);
<a name="l00881"></a>00881       }
<a name="l00882"></a>00882       <span class="keywordflow">if</span> (!moleculeSetsPtr_) {
<a name="l00883"></a>00883          <a class="code" href="global_8h.html#ad2512f8bd062d41d66799cf900151487" title="Macro for throwing an Exception, reporting function, file and line number.">UTIL_THROW</a>(<span class="stringliteral">&quot;Null moleculeSetsPtr_&quot;</span>);
<a name="l00884"></a>00884       }
<a name="l00885"></a>00885       <span class="keywordflow">for</span> (iSpecies =0; iSpecies &lt; simulationPtr_-&gt;nSpecies(); ++iSpecies) {
<a name="l00886"></a>00886          (*moleculeSetsPtr_)[iSpecies].isValid();
<a name="l00887"></a>00887          <span class="keywordflow">for</span> (iMolecule = 0; iMolecule &lt; nMolecule(iSpecies); ++iMolecule) {
<a name="l00888"></a>00888             molPtr = &amp;(*moleculeSetsPtr_)[iSpecies][iMolecule]; 
<a name="l00889"></a>00889             <span class="keywordflow">if</span> (&amp;molPtr-&gt;<a class="code" href="classMcMd_1_1Molecule.html#a4a3af9eda1fe22f46d6209a7d29aa020" title="Get the parent System.">system</a>() != <span class="keyword">this</span>) {
<a name="l00890"></a>00890                <a class="code" href="global_8h.html#ad2512f8bd062d41d66799cf900151487" title="Macro for throwing an Exception, reporting function, file and line number.">UTIL_THROW</a>(<span class="stringliteral">&quot;Error in pointer to System in a Molecule&quot;</span>);
<a name="l00891"></a>00891             }
<a name="l00892"></a>00892          }
<a name="l00893"></a>00893       }
<a name="l00894"></a>00894 
<a name="l00895"></a>00895 <span class="preprocessor">      #ifdef MCMD_LINK</span>
<a name="l00896"></a>00896 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (simulation().nLinkType() &gt; 0) {
<a name="l00897"></a>00897          <span class="keywordflow">if</span> (!linkMasterPtr_) {
<a name="l00898"></a>00898             <a class="code" href="global_8h.html#ad2512f8bd062d41d66799cf900151487" title="Macro for throwing an Exception, reporting function, file and line number.">UTIL_THROW</a>(<span class="stringliteral">&quot;Null linkMasterPtr_&quot;</span>);
<a name="l00899"></a>00899          }
<a name="l00900"></a>00900          linkMasterPtr_-&gt;isValid();
<a name="l00901"></a>00901       }
<a name="l00902"></a>00902 <span class="preprocessor">      #endif</span>
<a name="l00903"></a>00903 <span class="preprocessor"></span>
<a name="l00904"></a>00904 <span class="preprocessor">      #ifdef INTER_TETHER</span>
<a name="l00905"></a>00905 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (simulation().hasTether() &gt; 0) {
<a name="l00906"></a>00906          <span class="keywordflow">if</span> (!tetherMasterPtr_) {
<a name="l00907"></a>00907             <a class="code" href="global_8h.html#ad2512f8bd062d41d66799cf900151487" title="Macro for throwing an Exception, reporting function, file and line number.">UTIL_THROW</a>(<span class="stringliteral">&quot;Null tetherMasterPtr_&quot;</span>);
<a name="l00908"></a>00908          }
<a name="l00909"></a>00909          tetherMasterPtr_-&gt;isValid();
<a name="l00910"></a>00910       }
<a name="l00911"></a>00911 <span class="preprocessor">      #endif</span>
<a name="l00912"></a>00912 <span class="preprocessor"></span>
<a name="l00913"></a>00913       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00914"></a>00914    }
<a name="l00915"></a>00915 
<a name="l00916"></a>00916 }
<a name="l00917"></a>00917 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Sat Jun 16 2012 20:50:49 for Simpatico by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
