<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Simpatico: IntraStructureFactor Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simpatico&#160;<span id="projectnumber">v0.8</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespaceMcMd.html">McMd</a>      </li>
      <li class="navelem"><a class="el" href="classMcMd_1_1IntraStructureFactor.html">IntraStructureFactor</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<h1>IntraStructureFactor Class Reference<div class="ingroups"><a class="el" href="group__McMd__Diagnostic__Module.html">Diagnostics</a></div></h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="McMd::IntraStructureFactor" --><!-- doxytag: inherits="SystemDiagnostic&lt; System &gt;" --><hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Intramolecular contribution to the structure factor S(k) </p>
<p>The intramolecular contribution to the structure factor S(k) for a wavevector k is defined as an expectation value </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ S(k) = \sum_{m} < \rho_{ma}(k) \rho_{mb}(-k) / V > \]" src="form_10.png"/>
</p>
<p> in which the sum is taken over all molecules m of a specified species, V is system volume, and <img class="formulaInl" alt="$\rho_a(k)$" src="form_11.png"/> is a Fourier component </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \rho_{ma}(k) = \sum_{i} \exp( i k \cdot r_{mi} ) \]" src="form_12.png"/>
</p>
<p> in which the sum is taken over all particles in a set defined by the particle type index a on a specific molecule m.</p>
<p>If 0 &lt;= a &lt; nAtomType, then, <img class="formulaInl" alt="$ \rho_{ma}(k) $" src="form_13.png"/> is given by a sum over all atoms of type a on molecule m.</p>
<p>If a &lt; 0, then <img class="formulaInl" alt="$ \rho_a(k) $" src="form_14.png"/> is given by a sum over all atoms on molecule m, including those of all types. By convention, we use a = -1 to indicate this.</p>
<p>This class can evaluate multiple types of structures factors, corresponding to different choices for the type pair ab, for multiple wavevectors. The input format thus requires the user to specify one or more atom typeId pairs, and one or more wavevectors. Each wavevector is specified as an IntVector containing integer Miller indices. These are the coeficients in an expansion of a reciprocal lattice wavevector in terms of recprocal lattice basis vectors for the periodic unit cell.</p>
<p>In a system with nAtomType = 2, with two monomer types 0 and 1, the parameter file input for calculating the total, 00 and 01 correlation functions for 5 wavevectors along the x axis in an orthorhombic unit cell might look like this:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="classMcMd_1_1IntraStructureFactor.html#ade04e2f90318745b031ef7193ae1c7a7" title="Constructor.">IntraStructureFactor</a>{
    <a class="code" href="classMcMd_1_1Diagnostic.html#afe5b7de87b935531edcd3d15fbd92166" title="Get interval value.">interval</a>                     1000
    <a class="code" href="classMcMd_1_1Diagnostic.html#aa2f9962afe9282aa2cb84a50068c9be5" title="Return outputFileName string.">outputFileName</a>     <a class="code" href="classMcMd_1_1IntraStructureFactor.html#ade04e2f90318745b031ef7193ae1c7a7" title="Constructor.">IntraStructureFactor</a>
    nAtomTypeIdPair                  3
    atomTypeIdPairs          -1     -1
                              0      0
                              0      1
    nWave                            5
    waveIntVectors     8      0      0
                       9      0      0 
                      10      0      0 
                      11      0      0 
                      12      0      0 
 }
</pre></div><p> At the end of a simulation, all of the structure factors are output in a file with a suffix *.dat. Each line in this file contains the 3 Miller indices of a wavevector, the absolute magnitude of the wavevector, and a list of nAtomTypeIdPair structure factor values for the wavevector, one for each atomTypeId pair. </p>

<p>Definition at line <a class="el" href="IntraStructureFactor_8h_source.html#l00090">90</a> of file <a class="el" href="IntraStructureFactor_8h_source.html">IntraStructureFactor.h</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="IntraStructureFactor_8h_source.html">IntraStructureFactor.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for IntraStructureFactor:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classMcMd_1_1IntraStructureFactor.png" usemap="#IntraStructureFactor_map" alt=""/>
  <map id="IntraStructureFactor_map" name="IntraStructureFactor_map">
<area href="classMcMd_1_1SystemDiagnostic.html" alt="SystemDiagnostic&lt; System &gt;" shape="rect" coords="92,168,267,192"/>
<area href="classMcMd_1_1Diagnostic.html" alt="Diagnostic" shape="rect" coords="92,112,267,136"/>
<area href="classUtil_1_1ParamComposite.html" alt="ParamComposite" shape="rect" coords="0,56,175,80"/>
<area href="classUtil_1_1Serializable.html" alt="Serializable" shape="rect" coords="185,56,360,80"/>
<area href="classUtil_1_1ParamComponent.html" alt="ParamComponent" shape="rect" coords="0,0,175,24"/>
</map>
 </div></div>

<p><a href="classMcMd_1_1IntraStructureFactor-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1IntraStructureFactor.html#ade04e2f90318745b031ef7193ae1c7a7">IntraStructureFactor</a> (<a class="el" href="classMcMd_1_1System.html">System</a> &amp;system)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#ade04e2f90318745b031ef7193ae1c7a7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1IntraStructureFactor.html#ab5421d3c9175985c9acbf723e5392075">readParam</a> (std::istream &amp;in)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read parameters from file.  <a href="#ab5421d3c9175985c9acbf723e5392075"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1IntraStructureFactor.html#a4fc01d736fe50cf5b977f755b675f11d">setup</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear accumulators.  <a href="#a4fc01d736fe50cf5b977f755b675f11d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1IntraStructureFactor.html#afc17577823a371a5ead4e51ebb8ec2ef">sample</a> (long iStep)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Add particle pairs to <a class="el" href="classMcMd_1_1IntraStructureFactor.html" title="Intramolecular contribution to the structure factor S(k)">IntraStructureFactor</a> histogram.  <a href="#afc17577823a371a5ead4e51ebb8ec2ef"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1IntraStructureFactor.html#a7437b254e19e7e12fc2ec99945f4ecea">output</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Output results to predefined output file.  <a href="#a7437b254e19e7e12fc2ec99945f4ecea"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1IntraStructureFactor.html#a248dde9ccc0ef67e5d9cc5fd0bdc2b64">save</a> (<a class="el" href="classUtil_1_1BinaryFileOArchive.html">Serializable::OArchiveType</a> &amp;ar)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Save state to binary file archive.  <a href="#a248dde9ccc0ef67e5d9cc5fd0bdc2b64"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1IntraStructureFactor.html#aa3d71af4cc5dfb2be6be816a8f562416">load</a> (<a class="el" href="classUtil_1_1BinaryFileIArchive.html">Serializable::IArchiveType</a> &amp;ar)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Load state from a binary file archive.  <a href="#aa3d71af4cc5dfb2be6be816a8f562416"></a><br/></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;class Archive &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classMcMd_1_1IntraStructureFactor.html#a6765e839ab267e4959384e35a4112451">serialize</a> (Archive &amp;ar, const unsigned int version)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Serialize to/from an archive.  <a href="#a6765e839ab267e4959384e35a4112451"></a><br/></td></tr>
</table>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ade04e2f90318745b031ef7193ae1c7a7"></a><!-- doxytag: member="McMd::IntraStructureFactor::IntraStructureFactor" ref="ade04e2f90318745b031ef7193ae1c7a7" args="(System &amp;system)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMcMd_1_1IntraStructureFactor.html">IntraStructureFactor</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMcMd_1_1System.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>system</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">system</td><td>reference to parent <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> object </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="IntraStructureFactor_8cpp_source.html#l00032">32</a> of file <a class="el" href="IntraStructureFactor_8cpp_source.html">IntraStructureFactor.cpp</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ab5421d3c9175985c9acbf723e5392075"></a><!-- doxytag: member="McMd::IntraStructureFactor::readParam" ref="ab5421d3c9175985c9acbf723e5392075" args="(std::istream &amp;in)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void readParam </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>in</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read parameters from file. </p>
<p>Read parameters from file, and allocate data array.</p>
<p>Input format:</p>
<ul>
<li>int interval sampling interval</li>
<li>string outputFileName output file base name</li>
<li>int nAtomTypeIdPair number of <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> typeId pairs</li>
<li>DArray&lt;<a class="el" href="classUtil_1_1Pair.html">Pair&lt;int&gt;</a>&gt; atomTypeIdPairs integer typeId pairs</li>
<li>int nWave number of wavevectors</li>
<li><a class="el" href="classUtil_1_1DArray.html">DArray&lt;IntVector&gt;</a> waveIntVectors IntVector wavevectors</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>input parameter stream </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classUtil_1_1ParamComposite.html#a972351ccededadbff33fb3bd854efdaf">ParamComposite</a>.</p>

<p>Definition at line <a class="el" href="IntraStructureFactor_8cpp_source.html#l00038">38</a> of file <a class="el" href="IntraStructureFactor_8cpp_source.html">IntraStructureFactor.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4fc01d736fe50cf5b977f755b675f11d"></a><!-- doxytag: member="McMd::IntraStructureFactor::setup" ref="a4fc01d736fe50cf5b977f755b675f11d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Clear accumulators. </p>

<p>Reimplemented from <a class="el" href="classMcMd_1_1Diagnostic.html#a43128fa8695ca9394ba69cd759d04b99">Diagnostic</a>.</p>

<p>Definition at line <a class="el" href="IntraStructureFactor_8cpp_source.html#l00067">67</a> of file <a class="el" href="IntraStructureFactor_8cpp_source.html">IntraStructureFactor.cpp</a>.</p>

<p>References <a class="el" href="global_8h_source.html#l00051">UTIL_THROW</a>.</p>

</div>
</div>
<a class="anchor" id="afc17577823a371a5ead4e51ebb8ec2ef"></a><!-- doxytag: member="McMd::IntraStructureFactor::sample" ref="afc17577823a371a5ead4e51ebb8ec2ef" args="(long iStep)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sample </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>iStep</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add particle pairs to <a class="el" href="classMcMd_1_1IntraStructureFactor.html" title="Intramolecular contribution to the structure factor S(k)">IntraStructureFactor</a> histogram. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">iStep</td><td>step counter </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classMcMd_1_1Diagnostic.html#a539b7a077aea825f7195929db1a5944f">Diagnostic</a>.</p>

<p>Definition at line <a class="el" href="IntraStructureFactor_8cpp_source.html#l00087">87</a> of file <a class="el" href="IntraStructureFactor_8cpp_source.html">IntraStructureFactor.cpp</a>.</p>

<p>References <a class="el" href="Vector_8h_source.html#l00604">Vector::dot()</a>, <a class="el" href="Constants_8h_source.html#l00039">Constants::Im</a>, <a class="el" href="ConstArrayIterator_8h_source.html#l00084">ConstArrayIterator&lt; Data &gt;::notEnd()</a>, <a class="el" href="ConstPArrayIterator_8h_source.html#l00092">ConstPArrayIterator&lt; Data &gt;::notEnd()</a>, and <a class="el" href="product_8h_source.html#l00022">Util::product()</a>.</p>

</div>
</div>
<a class="anchor" id="a7437b254e19e7e12fc2ec99945f4ecea"></a><!-- doxytag: member="McMd::IntraStructureFactor::output" ref="a7437b254e19e7e12fc2ec99945f4ecea" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void output </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Output results to predefined output file. </p>

<p>Reimplemented from <a class="el" href="classMcMd_1_1Diagnostic.html#a209e4a470fcdeb3d5b87da3dd6960def">Diagnostic</a>.</p>

<p>Definition at line <a class="el" href="IntraStructureFactor_8cpp_source.html#l00174">174</a> of file <a class="el" href="IntraStructureFactor_8cpp_source.html">IntraStructureFactor.cpp</a>.</p>

<p>References <a class="el" href="Dimension_8h_source.html#l00019">Util::Dimension</a>.</p>

</div>
</div>
<a class="anchor" id="a248dde9ccc0ef67e5d9cc5fd0bdc2b64"></a><!-- doxytag: member="McMd::IntraStructureFactor::save" ref="a248dde9ccc0ef67e5d9cc5fd0bdc2b64" args="(Serializable::OArchiveType &amp;ar)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void save </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classUtil_1_1BinaryFileOArchive.html">Serializable::OArchiveType</a> &amp;&#160;</td>
          <td class="paramname"><em>ar</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Save state to binary file archive. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ar</td><td>binary saving (output) archive. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classMcMd_1_1Diagnostic.html#a248dde9ccc0ef67e5d9cc5fd0bdc2b64">Diagnostic</a>.</p>

<p>Definition at line <a class="el" href="IntraStructureFactor_8cpp_source.html#l00204">204</a> of file <a class="el" href="IntraStructureFactor_8cpp_source.html">IntraStructureFactor.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa3d71af4cc5dfb2be6be816a8f562416"></a><!-- doxytag: member="McMd::IntraStructureFactor::load" ref="aa3d71af4cc5dfb2be6be816a8f562416" args="(Serializable::IArchiveType &amp;ar)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void load </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classUtil_1_1BinaryFileIArchive.html">Serializable::IArchiveType</a> &amp;&#160;</td>
          <td class="paramname"><em>ar</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Load state from a binary file archive. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ar</td><td>binary loading (input) archive. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classMcMd_1_1Diagnostic.html#aa3d71af4cc5dfb2be6be816a8f562416">Diagnostic</a>.</p>

<p>Definition at line <a class="el" href="IntraStructureFactor_8cpp_source.html#l00210">210</a> of file <a class="el" href="IntraStructureFactor_8cpp_source.html">IntraStructureFactor.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6765e839ab267e4959384e35a4112451"></a><!-- doxytag: member="McMd::IntraStructureFactor::serialize" ref="a6765e839ab267e4959384e35a4112451" args="(Archive &amp;ar, const unsigned int version)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serialize </td>
          <td>(</td>
          <td class="paramtype">Archive &amp;&#160;</td>
          <td class="paramname"><em>ar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>version</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Serialize to/from an archive. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ar</td><td>saving or loading archive </td></tr>
    <tr><td class="paramname">version</td><td>archive version id </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classMcMd_1_1Diagnostic.html#a6765e839ab267e4959384e35a4112451">Diagnostic</a>.</p>

<p>Definition at line <a class="el" href="IntraStructureFactor_8h_source.html#l00216">216</a> of file <a class="el" href="IntraStructureFactor_8h_source.html">IntraStructureFactor.h</a>.</p>

<p>References <a class="el" href="util_2archives_2serialize_8h_source.html#l00058">Util::serializeCheck()</a>, and <a class="el" href="global_8h_source.html#l00051">UTIL_THROW</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="IntraStructureFactor_8h_source.html">IntraStructureFactor.h</a></li>
<li><a class="el" href="IntraStructureFactor_8cpp_source.html">IntraStructureFactor.cpp</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Sat Jun 16 2012 20:50:53 for Simpatico by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
