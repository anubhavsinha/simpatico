<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Simpatico: Free Energy Perturbation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simpatico&#160;<span id="projectnumber">v0.8</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="index.html">Simpatico - Simulation Package for Polymer and Molecular Liquids</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Free Energy <a class="el" href="classMcMd_1_1Perturbation.html" title="Model of parameter dependence in a free energy perturbation theory.">Perturbation</a> </h1>  </div>
</div>
<div class="contents">
<div class="textblock"><p>When a parallel simulation is compiled with MPI and free energy perturbation enabled, by defining MPI_FLAG and PERTURB_FLAG, and invoked with the "-p" option, the master processor of the MPI communicator reads a parameter file from standard input, and then broadcasts the contents of that single parameter file to all other processors. In this mode, the parameter file must contain a polymorphic block associated with a subclass of the "Perturbation" abstract base class. This block in the param file is at the end of the block associated with the <a class="el" href="classMcMd_1_1McSystem.html" title="A System for use in a Markov chain Monte Carlo simulation.">McSystem</a>.</p>
<p>A "Perturbation" defines how a sequence of slightly different sets of different physical parameters should be assigned to different processors within a parallel job, for use in thermodynamic perturbation theory. Each subclass of "Perturbation" must specify how the information that it reads from the param file is used to define such a sequence of parameter values. Different parameters are set for the <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> on different processors by first setting the parameters on every system to a baseline set of values, which are determined by the value given for quantities such as the potential energy parameters and temperature in the rest of the <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> block, and then allowing the <a class="el" href="classMcMd_1_1Perturbation.html" title="Model of parameter dependence in a free energy perturbation theory.">Perturbation</a> object to reset specific parameters to different values on different processors. The <a class="el" href="classMcMd_1_1Perturbation.html" title="Model of parameter dependence in a free energy perturbation theory.">Perturbation</a> may reset values of any parameters that effects the statistical weight for a microstate, including parameters in the potential energy or macroscopic parameters such as temperature or pressure.</p>
<p>As a simple example of this, <a class="el" href="classMcMd_1_1McEnergyPerturbation.html" title="A Perturbation with a variable inverse temperature.">McEnergyPerturbation</a>" class is a subclass of <a class="el" href="classMcMd_1_1Perturbation.html" title="Model of parameter dependence in a free energy perturbation theory.">Perturbation</a> that sets every processor in an MC simulation to a different temperature, or inverse temperature beta, while using equal values for all potential energy parameters. The required values of inverse temperature for different processors are input as an array in the parameter file block that is read by <a class="el" href="classMcMd_1_1McEnergyPerturbation.html#ab5421d3c9175985c9acbf723e5392075" title="Read beta parameter (inverse temperature) from file.">McEnergyPerturbation::readParam()</a>, listed in order of the MPI ranks of corresponding processors. The contents of this entire array is broadcast to all processors, and each processor then resets its temperature to a value obtained from the appropriate elements of the array (i.e., processor 4 resets its temperature to the value corresponding to element 4 in this array).</p>
<p>More generally, each concrete subclass of <a class="el" href="classMcMd_1_1Perturbation.html" title="Model of parameter dependence in a free energy perturbation theory.">Perturbation</a> must define how the Boltzmann weight (Hamiltonian / kT) for a sequence of systems depend on some parameter such as inverse temperature or a potential energy parameter. The readParam() method for any <a class="el" href="classMcMd_1_1Perturbation.html" title="Model of parameter dependence in a free energy perturbation theory.">Perturbation</a> reads a list of values of that perturbation parameter, which it uses to reset different values for an associated physical parameter values on different processors.</p>
<ul>
<li>
<a class="el" href="parallel_page.html">Parallel Operation</a> (Prev)  </li>
<li>
<a class="el" href="guide_page.html">User Guide</a> (Up)  </li>
<li>
<a class="el" href="overview_page.html">Source Code Overview</a> (Next)  </li>
</ul>
</div></div>
<hr class="footer"/><address class="footer"><small>Generated on Sat Jun 16 2012 20:50:49 for Simpatico by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
