<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3"/>
<title>Simpatico: 2.2 Usage</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simpatico
   &#160;<span id="projectnumber">v1.10</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Simpatico - Simulation Package for Polymer and Molecular Liquids</a></li><li class="navelem"><a class="el" href="user_page.html">2 User Guide</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">2.2 Usage </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="user_compile_page.html">2.1 Compilation</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_param_page.html">2.3 Parameter Files</a> (Next) <br/>
</p>
<p>This section describes how to execute the simpatico programs mcSim, mdSim and ddSim. The command line interface is similar for all three programs. Differences among the three programs are discussed explicitly below. This page gives instructions for using any of these three programs to simulate a single physical system. Multi-system simulations, such as those used for replica exchange algorithms, are discussed separately (see <a class="el" href="user_multi_page.html">2.10 Multi-System Simulations</a>).</p>
<h1><a class="anchor" id="usage_inputs"></a>
Input files</h1>
<p>A simpatico simulation normally requires the three input files: </p>
<ul>
<li>
a <a class="el" href="user_usage_page.html#usage_parameter_section">parameter</a> file  </li>
<li>
a <a class="el" href="user_usage_page.html#usage_command_section">command</a> file  </li>
<li>
a <a class="el" href="user_usage_page.html#usage_cfgfile_section">configuration</a> file  </li>
</ul>
<p>The contents and formats of these different types of file are discussed briefly below and in more detail in several separate pages (see <a class="el" href="user_param_page.html">2.3 Parameter Files</a> , <a class="el" href="user_commands_page.html">2.4 Command File</a> and <a class="el" href="user_cfgfile_page.html">2.5 Configuration Files</a>). All three programs use similar formats for the parameter and command files, but ddSim uses a different default format for configuration files than that used by mcSim and mdSim.</p>
<p>When a simulation is executed, the parameter file is immediately read from standard input. The command file is read after the parameter file. The name of the command file is specified in the the parameter file. The command file is a script that contains a list of commands that are interpreted and executed in sequence. Among these are normally a command to read a specific input configuration file, a command to run a simulation of a specified number of steps, and a command to write the final configuration to a file.</p>
<h1><a class="anchor" id="usage_running_section"></a>
Running a simulation</h1>
<p>To run a simulation, one invokes the nane of the binary executable file and reads the parameter file from standard input. For example, to run the default version of the single-processor mdSim MD simulation, using a parameter file named "param" in the current working directory, one would enter: </p>
<div class="fragment"><div class="line">mdSim &lt; param</div>
</div><!-- fragment --><p> To run a single-processor MC simulation, one would instead enter "mcSim &lt; param". During execution, some log information is written to standard output (i.e., the screen). This log output can be directed to a file using, for example, </p>
<div class="fragment"><div class="line">mdSim &lt; param &gt; log</div>
</div><!-- fragment --><p> Standard output should always be redirected to a file when a job is run in background or in a queue.</p>
<p>The syntax for executing the parallel ddSim program of a single system is similar, except for the need to run the program as an MPI program. The syntax for starting an MPI job depends on the system configuration and choice of library, but often involves a script called "mpirun". To use mpirun to start a ddSim program on 32 processors, using a parameter file named param in the working directory, one would enter </p>
<div class="fragment"><div class="line">mpirun -np 32 ddSim &lt; param &gt; log</div>
</div><!-- fragment --><p> For a ddSim job, the number of processors declared in the command line (e.g., 32 in this example) must be consistent with the number of processors in the processor grid defined in the Domain block of the parameter file (e.g., a 4 x 4 x 2 grid for a simulation with 32 processors).</p>
<p>The available command line options for each program are discussed <a class="el" href="user_usage_page.html#section_options">below</a>. A particularly useful option for new users is the "-e" (echo) option, as in </p>
<div class="fragment"><div class="line">mdSim -e &lt; param &gt; log</div>
</div><!-- fragment --><p> This option causes each line of the parameter file to be echoed to standard output as it is read. It is useful for locating errors in the parameter file syntax, because the echoed output ends immediately before the line at which an error in the parameter file is detected, and is followed by a message explaining the nature of the error. The first line that does not appear is usually the one that causing trouble.</p>
<h1><a class="anchor" id="usage_program_section"></a>
Program structure</h1>
<p>The understand the program flow, it helps to look briefly at the structure of the main program. The main program files for single processor MC and MD simulations are <a class="el" href="mcSim_8cpp_source.html">src/mcMd/mcSim.cpp</a> and <a class="el" href="mdSim_8cpp_source.html">src/mcMd/mdSim.cpp</a>. The main program for parallel MD simulation is <a class="el" href="ddSim_8cpp_source.html">src/ddMd/ddSim.cpp</a>. All three programs have a similar structure.</p>
<p>Here is a slightly simplified (but functional) version of the main program <a class="el" href="mcSim_8cpp_source.html">src/mcMd/mcSim.cpp</a> for MC simulations: </p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)</div>
<div class="line">{</div>
<div class="line">   <a class="code" href="classMcMd_1_1McSimulation.html" title="A Monte-Carlo simulation of one McSystem.">McMd::McSimulation</a> simulation;</div>
<div class="line">  </div>
<div class="line">   \\ Process command line options</div>
<div class="line">   simulation.<a class="code" href="classMcMd_1_1McSimulation.html#a913a54f9d2f6ee42dbd6aad6ebeac486" title="Process command line options.">setOptions</a>(argc, argv);</div>
<div class="line">  </div>
<div class="line">   \\ Read the parameter file from standard input</div>
<div class="line">   simulation.<a class="code" href="classMcMd_1_1McSimulation.html#ada2e9f506b67f1d0d6aba05c9280ee7e" title="Read parameter file.">readParam</a>();</div>
<div class="line">  </div>
<div class="line">   \\ Read the command file.</div>
<div class="line">   simulation.<a class="code" href="classMcMd_1_1McSimulation.html#ac743d5ae517c8da8f087e573635d11da" title="Read and execute commands from a specific input stream.">readCommands</a>();</div>
<div class="line">  </div>
<div class="line">}</div>
</div><!-- fragment --><p> This simplified version of the program has only four executable lines:</p>
<ul>
<li>The first line creates an object named simulation that is an instance of the class <a class="el" href="classMcMd_1_1McSimulation.html" title="A Monte-Carlo simulation of one McSystem.">McMd::McSimulation</a>. An McSimulation object represents a complete Monte Carlo simulation.</li>
</ul>
<ul>
<li>In the second line, the McSimulation::setOptions() method processes any command line options that are passed to the program. Some of the available command line options are discussed <a class="el" href="user_usage_page.html#section_options">below</a>.</li>
</ul>
<ul>
<li>In the third line, readParam() method reads a parameter file and initializes the simulation. Invoking readParam() with no argument (as here) reads the parameter file from standard input.</li>
</ul>
<ul>
<li>In the fourth line, the readCommands() method reads the command file, and executes each command in sequence.</li>
</ul>
<p>The readParam() method does more than read parameters: It is an initialization function that reads parameters, allocates any required memory, and leaves the main simulation object ready for use. The name of the command file is specified in the param file.</p>
<p>The analogous code for the single-processor MD (mdSim) and parallel MD (ddSim) programs are almost identical. The only difference is that the main object in <a class="el" href="mdSim_8cpp_source.html">mdSim.cpp</a> is an instance of <a class="el" href="classMcMd_1_1MdSimulation.html" title="A molecular dynamics simulation of a single MdSystem.">McMd::MdSimulation</a>, and the main object in ddSim.ccpp is an instance of <a class="el" href="classDdMd_1_1Simulation.html" title="Main object for a domain-decomposition MD simulation.">DdMd::Simulation</a>.</p>
<h1><a class="anchor" id="usage_parameter_section"></a>
Parameter file</h1>
<p>The parameter file contains all the data required to initialize a simulation, i.e., to initialize all variables to valid values and to allocate all required memory. This data includes:</p>
<ul>
<li>Parameters that control how much memory should be allocated for use during a simulation, such as the maximum allowable number of atoms or molecules.</li>
<li>Physical parameters such as the temperature and potential energy parameters.</li>
<li>Choices of specific simulation algorithms, such as the set of Monte Carlo moves for a MC simulation or the integration algorithm for an MD simulation, and parameters requierd by these algorithms (e.g,. the time step for an MD integrator).</li>
<li>Choices of any desired data analysis and/or data output operations, and associated parameter values.</li>
</ul>
<p>In mcSim and mdSim simulations, the parameter file also contains data required to describe molecular species. In ddSim simulations, this information about molecular topology is instead embedded in the configuration file (discussed below). The parameter file also contains the filename for the command file that should be read by the readCommands() method. Examples of parameter file formats for different types of simulation are shown and discussed <a class="el" href="user_param_page.html">here</a>.</p>
<h1><a class="anchor" id="usage_command_section"></a>
Command file</h1>
<p>The command file contains a sequence of commands that are read and executed in the order they appear. Each line of the command file starts with a capitalized command name, followed by zero or more arguments. The minimal command file for an mcSim simulation looks like this: </p>
<div class="fragment"><div class="line">READ_CONFIG       config</div>
<div class="line">SIMULATE          100000</div>
<div class="line">WRITE_CONFIG      config</div>
<div class="line">FINISH   </div>
</div><!-- fragment --><p> This file instructs the program to read a configuration file named "config", run a simulation of 100000 attempted MC moves, write a final output configuration file to a file named "config", and then stop. The command file is read by a loop that terminates when a line containing only the command FINISH is encountered. A full list of valid commands and their arguments is given <a class="el" href="user_commands_page.html">here</a>.</p>
<p>Paths for the input and output files specified in the command file are constructed by concatenating input and output prefix strings that are specified in the parameter file (named inputPrefix and outputPrefix) to file names specified in the command file. The values of these prefix strings are often set to directory name strings, which end with a directory separator symbol "/", in order to place all input files and output files in different directories. The fact that the above example command script uses the same name "config" for both the input and output configuration files thus does not necessarily mean that the script would cause the input configuration file to be overwritten, sinceinput and output files are normally placed in different directories.</p>
<h1><a class="anchor" id="usage_cfgfile_section"></a>
Configuration file</h1>
<p>A configuration file specifies atomic positions and other characteristics of a system that can change during the course of a simulation. Slightly different information is required by mcSim, mdSim, and ddSim. A default configuration file format exists for each of the three programs, each of which can also read and write files using a several other file formats.</p>
<p>The default configuration file format for mcSim contains the dimensions of the periodic system boundary, the number of molecules of each molecular species, and the positions of all atoms. The default configuration file format for mdSim also contains the atomic velocities. The default file formats for these two programs do not contain any information about molecular topology (i.e., which atoms are connected to which), because this is contained in the param file format for these programs.</p>
<p>The default configuration file format for ddSim contains box dimensions, atomic positions and velocities. Unlike the file formats for mcSim and mdSim, this format also contains structural information about topology, which is given by listing bond, angle and dihedral covalent groups.</p>
<p>Configuration file formats for all programs are described in more detail <a class="el" href="user_cfgfile_page.html">here</a>.</p>
<h1><a class="anchor" id="usage_output_section"></a>
Output files</h1>
<p>Each simulation writes a limited amount of information to report the progress of the simulation. In simulations of single system, this is written to standard output. It will thus appear on the user's screen unless redirected to a file.</p>
<p>A typical command file contains a command to write a final system configuration to a file. The parameter file may also specify that the system configuration be dumped to file periodically during a simulation.</p>
<p>A variety of other output files may also be written by classes that implement on-the-fly statistical analyses or data output operations, which we refer to as Analyzer classes. Each such data analysis and data output class is a subclasses of either the <a class="el" href="classMcMd_1_1Analyzer.html" title="Abstract base for periodic output and/or analysis actions.">McMd::Analyzer</a> (for mcSim or mdSim) or <a class="el" href="classDdMd_1_1Analyzer.html" title="Abstract base for periodic output and/or analysis actions.">DdMd::Analyzer</a> (for ddSim) base class. The parameter file for each type of simulation specifies a set of Analyzer objects that should used during a simulation. Each such object carries out a computation and/or outputs data to file at a specified interval. Each Analyzer writes output to one or more separate files. The path to each such output file is constructed by prepending a common string variable, named outputPrefix, to a base name that is specified in the parameter file block associated with a specific Analyzer.</p>
<h1><a class="anchor" id="section_options"></a>
Command line options</h1>
<p>All simpatico simulations of single systems can be invoked with either or both of the following two command line options: </p>
<ul>
<li>
-e: Activates echoing of the parameter file to standard output. </li>
<li>
-r filename: Restarts and continues a previous simulation.   </li>
</ul>
<p>The -e (echo) option causes each parameter in the parameter file to be echoed to standard output immediately after it is read. This option takes no arguments.</p>
<p>The -r (restart) option takes a required parameter "filename". This is the base name of two input files required to restart a simulation, which have filename suffixes *.rst, (restart file) and *.cmd (restart command file). Restarting is discussed in more detail <a class="el" href="user_restart_page.html">here</a>.</p>
<p>Other command line options that are relevant only to multi-system simulations are discussed separately <a class="el" href="user_multi_page.html">here</a>.</p>
<p><br/>
 <a class="el" href="user_compile_page.html">2.1 Compilation</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_page.html">2 User Guide</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="user_param_page.html">2.3 Parameter Files</a> (Next) </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.3-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu May 29 2014 09:25:22 for Simpatico by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3
</small></address>
</body>
</html>
