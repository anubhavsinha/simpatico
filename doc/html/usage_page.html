<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Simpatico: Usage</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simpatico&#160;<span id="projectnumber">v1.0</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="index.html">Simpatico - Simulation Package for Polymer and Molecular Liquids</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Usage </h1>  </div>
</div>
<div class="contents">
<div class="textblock"><p>This section describes how to use the programs mcSim, mdSim and ddSim. The discussion assumes that the executables have been installed in a directory that is in the users command search $PATH variable.</p>
<h2><a class="anchor" id="usage_running"></a>
Running a Simulation</h2>
<p>The syntax for running a simulation is very similar for the mcSim, mdSim and ddSim programs. In each case, the program is initialized by reading a parameter file. To run a single-processor MD simulation interactively, using a parameter file named "param" in the current working directory, one would enter: </p>
<div class="fragment"><pre class="fragment">   mdSim &lt; param
</pre></div><p> To run a single-processor MC simulation, one would instead enter "mcSim &lt; param" instead, or "ddSim &lt; param" for a parallel MD simulation. During execution, a log output is sent to standard output (i.e., the screen). This log output can be directed to a file using, e.g., </p>
<div class="fragment"><pre class="fragment">  mdSim &lt; param &gt; log
</pre></div><p> This is the command normally used when a job is run in background, or in a queue.</p>
<p>Each simulation normally requires three input files: </p>
<ul>
<li>
a parameter file  </li>
<li>
a command file  </li>
<li>
a configuration file  </li>
</ul>
<p>The parameter file is read from standard input, and contains the name of the command file. The command file contains a sequence of commands that are interpreted and executed in sequence. Among these is normally a command that instructs the program to read a specific input configuration file. The contents and formats of these different types of file are discussed briefly below and in more detail in several separate pages (see <a class="el" href="param_page.html">Parameter File</a> , <a class="el" href="commands_page.html">Command File</a> and <a class="el" href="cfgfile_page.html">Configuration File</a>).</p>
<h2><a class="anchor" id="section_program"></a>
Main Program</h2>
<p>The main program files for single processor MC and MD simulations are <a class="el" href="mcSim_8cpp_source.html">src/mcMd/mcSim.cpp</a> and <a class="el" href="mdSim_8cpp_source.html">src/mcMd/mdSim.cpp</a>. The main program for parallel MD simulation is src/ddMd/mdSim.cpp. All three programs have a similar structure. Shown below is a slightly simplified version of the main program <a class="el" href="mcSim_8cpp_source.html">src/mcMd/mcSim.cpp</a> for MC simulations: </p>
<div class="fragment"><pre class="fragment"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)
{
   <a class="code" href="classMcMd_1_1McSimulation.html" title="A Monte-Carlo simulation of one McSystem.">McMd::McSimulation</a> simulation;
  
   \\ Process command line options
   simulation.<a class="code" href="classMcMd_1_1McSimulation.html#a913a54f9d2f6ee42dbd6aad6ebeac486" title="Process command line options.">setOptions</a>(argc, argv);
  
   \\ Read the parameter file from standard input
   simulation.<a class="code" href="classMcMd_1_1McSimulation.html#ada2e9f506b67f1d0d6aba05c9280ee7e" title="Read parameters from a specific stream.">readParam</a>();
  
   \\ Read the command file.
   simulation.<a class="code" href="classMcMd_1_1McSimulation.html#ac743d5ae517c8da8f087e573635d11da" title="Read and execute commands from a specific input stream.">readCommands</a>();
  
}
</pre></div><p> The first line within the program creates an object named simulation that is an instance of the class <a class="el" href="classMcMd_1_1McSimulation.html" title="A Monte-Carlo simulation of one McSystem.">McSimulation</a> in namespace <a class="el" href="namespaceMcMd.html" title="Classes for Monte Carlo (MC) and molecular dynamics (MC) simulation.">McMd</a>. An <a class="el" href="classMcMd_1_1McSimulation.html" title="A Monte-Carlo simulation of one McSystem.">McSimulation</a> object represents a complete Monte Carlo simulation.</p>
<p>The setOptions() method, which is invoked in the second executable line, processes any command line options that are passed to the program. The available command line options are discussed <a class="el" href="usage_page.html#section_options">below</a>.</p>
<p>The readParam() method reads a parameter file and initializes the simulation. Invoking readParam() with no argument (as here) reads the parameter file from standard input. Despite its name, the readParam() method does not merely read parameters: It allocates any required memory, initializes the simulation, and leaves the main simulation object ready for use.</p>
<p>The readCommands() method read the command file, executes each command before reading the next. The name of the command file is specified in the param file. A typical command file contains commands to read an input configuration from file, run a simulation, and write a final configuration to file.</p>
<p>The analogous code for the single-processor MD (mdSim) and parallel MD (ddSim) programs are almost identical. The only difference is that the main object in <a class="el" href="mdSim_8cpp_source.html">mdSim.cpp</a> is an instance of <a class="el" href="classMcMd_1_1MdSimulation.html" title="A molecular dynamics simulation of a single MdSystem.">McMd::MdSimulation</a>, and the main object in ddSim.ccpp is an instance of <a class="el" href="classDdMd_1_1Simulation.html" title="Main object for a domain-decomposition MD simulation.">DdMd::Simulation</a>.</p>
<h2><a class="anchor" id="io_Parameter"></a>
Parameter File</h2>
<p>The parameter file contains all the data required to initialize a simulation, i.e., to allocate all required memory and initialize all variables to valid values. This data includes: (1) information required to allocate memory, such as the maximum allowable number of atoms or molecules, (2) physical parameters such as the temperature and potential energy parameters, (3) choices of available simulation algorithms, such as the set of Monte Carlo moves for a MC simulation or an integration algorithm and time step for an MD simulation, and (4) instructions for any desired data analysis and/or data output operations. The parameter file also contains the filename for the command file that should be read by the readCommands() method. Examples of parameter file formats for different types of simulation are shown and discussed <a class="el" href="param_page.html">here</a>.</p>
<h2><a class="anchor" id="io_Command"></a>
Command File</h2>
<p>The command file contains a sequence of commands that are read and executed in the order they appear. Each line of the command file starts with a capitalized command name, followed by zero or more arguments. The minimal command file for an mcSim simulation looks like this: </p>
<div class="fragment"><pre class="fragment">READ_CONFIG       config
SIMULATE          100000
WRITE_CONFIG      config
FINISH   
</pre></div><p> This file instructs the program to read a configuration file named "config", run a simulation of 100000 attempted MC moves, write a final output configuration file to a file named "config", and then stop. The command file is read by a loop that terminates when a line containing only the command FINISH is encountered. A full list of valid commands and their arguments is given <a class="el" href="commands_page.html">here</a>.</p>
<p>Paths for the input and output files specified in the command file are constructed by concatenating input and output prefix strings that are specified in the parameter file (named inputPrefix and outputPrefix) to file names specified in the command file. The values of these prefix strings are often set to directory name strings, which end with a directory separator symbol "/", in order to place all input files and output files in different directories. The fact that the above comand script uses the same name "config" for both the input and output configuration files thus does not necessarily mean that the script would cause the input configuration file to be overwritten, since the files may be in different directories specified in the parameter file.</p>
<h2><a class="anchor" id="io_Config"></a>
Configuration File</h2>
<p>A configuration file specifies atomic positions and other characteristics of a system that can change during the course of a simulation. Slightly different information is required by mcSim, mdSim, and ddSim. A default configuration file format exists for each of the three programs, each of which can also read and write files using a several other file formats.</p>
<p>The default configuration file format for mcSim contains the dimensions of the periodic system boundary, the number of molecules of each molecular species, and the positions of all atoms. The default file mdSim also contains the atomic velocities. The default configuration file formats for these two programs do not contain any information about molecular topology (which atom is connected to which), because this is contained in the param file format for these programs.</p>
<p>The default configuration file format for ddSim contains box dimensions, atomic positions and velocities. Unlike the file formats for mcSim and mdSim, this format also contains structural information about bonds, and any angle and dihedral groups.</p>
<p>Configuration file formats for all programs are described in more detail <a class="el" href="cfgfile_page.html">here</a>.</p>
<h2><a class="anchor" id="io_Output"></a>
Output Files</h2>
<p>Each simulation writes a limited amount of information to report the progress of the simulation. In simulations of single system (i.e., using ddSim or the single-processor versions of mdSim and mcSim), this is written to standard output, but can redirected to a log file.</p>
<p>A typical command file contains a command to write a final system configuration to a file. The parameter file may also specify that the system configuration be dumped to file periodically during a simulation.</p>
<p>A variety of other output files may also be written by classes that implement on-the-fly statistical analyses or data output operations. These data analysis and data output classes are all subclasses of the <a class="el" href="classMcMd_1_1Diagnostic.html" title="Abstract base for periodic output and/or analysis actions.">Diagnostic</a> base class. The parameter file may specify a set of <a class="el" href="classMcMd_1_1Diagnostic.html" title="Abstract base for periodic output and/or analysis actions.">Diagnostic</a> objects that should used during a simulation, each of which samples or outputs data at a specified interval, and each of which writes its output to one or more separate files. The path to each such output files is constructed by prepending a common outputPrefix string to a base name that is specified in the parameter file.</p>
<h2><a class="anchor" id="section_options"></a>
Command Line Options</h2>
<p>The mdSim and mcSim programs can each be invoked with any combination of three command line options: </p>
<ul>
<li>
-e: Activates echoing of the parameter file to standard output. </li>
<li>
-r filename: Restarts and continues a previous simulation.  </li>
<li>
-p: Enables the use of free energy perturbation theory.  </li>
</ul>
<p>The -e (echo) option causes each parameter in the parameter file to be echoed to standard output immediately after it is read. This is very useful for locating errors in the parameter <a href="file:">file:</a> The first parameter that is not echoed to standard output is usually the one that is causing trouble.</p>
<p>The -r (restart) option takes a required parameter "filename". This is the base name of three input files required to restart a simulation, which have filename suffixes *.prm, *.rst, and *.cmd. This option is discussed in more detail <a class="el" href="restart_page.html">here</a>.</p>
<p>The -p (perturbation) option enables the definition of a free energy perturbation, for use with thermodynamic integration and replica exchange algorithms. This is generally only useful when used with a version of mcSim or mdSim that is compiled for use on multiple processors. This option is discussed in more detail <a class="el" href="multiMcMd_page.html">here</a>.</p>
<p>The ddSim domain-decomposition MD program can be invoked with the two options: </p>
<ul>
<li>
-e: Activates echoing of the parameter file to standard output. </li>
<li>
-s p: Enables simulation of p independent systems.   </li>
</ul>
<p>The -e (echo) option causing echoing of the parameter file to the log file as it is read, as in mcSim and mdSim.</p>
<p>The -s (split) option takes a required parameter p, and enables simultaneous simulation of p independent systems by splitting the MPI communicator into p subcommunicators and using each to run a separate simulation. This option is discussed in more detail <a class="el" href="multiDdMd_page.html">here</a>.</p>
<ul>
<li>
<a class="el" href="compile_page.html">Compilation</a> (Previous)  </li>
<li>
<a class="el" href="guide_page.html">User Guide</a> (Up)  </li>
<li>
<p class="startli"><a class="el" href="param_page.html">Parameter File</a> (Next) </p>
<p class="endli"></p>
</li>
</ul>
</div></div>
<hr class="footer"/><address class="footer"><small>Generated on Sat Sep 1 2012 12:15:15 for Simpatico by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
