<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Simpatico: 5.4 Potential Energy Classes</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simpatico
   &#160;<span id="projectnumber">v1.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="index.html">Simpatico - Simulation Package for Polymer and Molecular Liquids</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">5.4 Potential Energy Classes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="potentials_base_sec"></a>
Potential Energy Base Classes</h2>
<p>The mcSim and mdSim programs use the following set of abstract base classes for different types of potential energy: </p>
<ul style="list-style: none;">
<li>
<a class="el" href="classMcMd_1_1McPairPotential.html" title="A PairPotential for MC simulations (abstract).">McMd::McPairPotential</a>  </li>
<li>
<a class="el" href="classMcMd_1_1MdPairPotential.html" title="An PairPotential for MD simulation.">McMd::MdPairPotential</a>  </li>
<li>
<a class="el" href="classMcMd_1_1BondPotential.html" title="Abstract Bond Potential class.">McMd::BondPotential</a>  </li>
<li>
<a class="el" href="classMcMd_1_1AnglePotential.html" title="Interface for a Angle Interaction.">McMd::AnglePotential</a>  </li>
<li>
<a class="el" href="classMcMd_1_1DihedralPotential.html" title="Interface for a Dihedral Potential.">McMd::DihedralPotential</a>  </li>
<li>
<a class="el" href="classMcMd_1_1ExternalPotential.html" title="Abstract External Potential class.">McMd::ExternalPotential</a>  </li>
</ul>
<p>Most of the names are self-explanatory: Bond, Angle, and Dihedral potentials represent 2-body bond, 3-body angle, and 4-body dihedral covalent interactions. An <a class="el" href="classMcMd_1_1ExternalPotential.html" title="Abstract External Potential class.">ExternalPotential</a> represents a one-body potential in which the energy depends upon the position and type of a single atom. The <a class="el" href="classMcMd_1_1McPairPotential.html" title="A PairPotential for MC simulations (abstract).">McPairPotential</a> and <a class="el" href="classMcMd_1_1MdPairPotential.html" title="An PairPotential for MD simulation.">MdPairPotential</a> classes both represent nonbonded pair interactions, but define slightly different interfaces for MC and MD simulations. For all other potential energy types (i.e., for bond, angle, dihedral, and external potentials) the same base class is used in both MC and MD simulations.</p>
<p>The ddSim program uses an analogous set of base classes defined in the <a class="el" href="namespaceDdMd.html" title="Parallel domain decomposition (DD) molecular dynamics MD simulation.">DdMd</a> namespace: </p>
<ul style="list-style: none;">
<li>
<a class="el" href="classDdMd_1_1PairPotential.html" title="A PairPotential calculates forces for a parent Simulation.">DdMd::PairPotential</a>  </li>
<li>
<a class="el" href="classDdMd_1_1BondPotential.html" title="An BondPotential calculates bond forces and energies for a parent Simulation.">DdMd::BondPotential</a>  </li>
<li>
<a class="el" href="classDdMd_1_1AnglePotential.html" title="An AnglePotential calculates angle forces and energies for a parent Simulation.">DdMd::AnglePotential</a>  </li>
<li>
<a class="el" href="classDdMd_1_1DihedralPotential.html" title="An DihedralPotential calculates dihedral forces and energies for a parent Simulation.">DdMd::DihedralPotential</a>  </li>
<li>
<a class="el" href="classDdMd_1_1ExternalPotential.html" title="An ExternalPotential calculates exteranl forces for a parent Simulation.">DdMd::ExternalPotential</a>  </li>
</ul>
<p>with names similar or identical to those of the corresponding <a class="el" href="namespaceMcMd.html" title="Classes for Monte Carlo (MC) and molecular dynamics (MC) simulation.">McMd</a> classes.</p>
<p>All of the above potential energy base classes declare methods to calculate the contribution from a particular type of potential to the total energy and total stress of an associated system, as well as methods to calculate energies and forces arising from single groups of atoms, such as a single pair of nonbonded atoms. All of the classes that are intended for us in MD simualtion (i.e., all the <a class="el" href="namespaceDdMd.html" title="Parallel domain decomposition (DD) molecular dynamics MD simulation.">DdMd</a> potentials and all of the <a class="el" href="namespaceMcMd.html" title="Classes for Monte Carlo (MC) and molecular dynamics (MC) simulation.">McMd</a> potentials except <a class="el" href="classMcMd_1_1MdPairPotential.html" title="An PairPotential for MD simulation.">MdPairPotential</a>) provide a method to calculate the corresponding contribution to the forces exerted on all atoms in a <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> (e.g., all nonbonded pair forces). All of the <a class="el" href="namespaceMcMd.html" title="Classes for Monte Carlo (MC) and molecular dynamics (MC) simulation.">McMd</a> potential classes that are intended for us in MC simulations (i.e,. all except <a class="el" href="classMcMd_1_1MdPairPotential.html" title="An PairPotential for MD simulation.">MdPairPotential</a>) also provide methods to calculate a corresponding energy contribution for a specific atom.</p>
<h2><a class="anchor" id="potentials_interaction_sec"></a>
Interaction Classes and Potential Energy Class Templates</h2>
<p>Subclassses of these potential energy abstract base classes are implemented using a simpler set of "interaction" classes. Each interaction class represents a specific function form for a potential energy function, and implements only the core calculations of energies and forces for small groups of 1, 2, 3 or 4 atoms. The interaction classes are simple, non-polymorphic classes, which provide non-virtual methods to calculate the energy and forces for a single group of interacting atoms, such as a single pair of nonbonded or bonded atoms, or the angle forces among a group of three bonded atoms. For example, LJPair is a pair interaction class that represents the Lennard-Jones pair interaction, while HarmonicBond is a bond interaction class that represents a harmonic bond potential. Unlike the polymorphic potential energy classes, interaction classes do not provide methods to do calculations that involve, e.g., looping over atoms or covalent groups of an associated system.</p>
<p>Subclasses of the potential energy base classes that use particular interaction functions are implemented by class templates. Each such potential energy class template takes an interaction class as a template argument, and is derived from an associated potential class. The name of each such class templates is given in all but a few cases by the name of the associated base class followed by the suffix "Impl" (for implementation). For example, the template that implements the <a class="el" href="classMcMd_1_1BondPotential.html" title="Abstract Bond Potential class.">McMd::BondPotential</a> interface is called <a class="el" href="classMcMd_1_1BondPotentialImpl.html" title="Implementation template for a BondPotential.">McMd::BondPotentialImpl</a>. The template instantiation McMd::BondPotentialImpl&lt;Inter::HarmonicBond&gt; is a subclass of <a class="el" href="classMcMd_1_1BondPotential.html" title="Abstract Bond Potential class.">BondPotential</a> that represents a harmonic bond potential. The template <a class="el" href="classMcMd_1_1BondPotentialImpl.html" title="Implementation template for a BondPotential.">McMd::BondPotentialImpl</a> defines methods that implement a loop over all bonds in a system, as required to calculate the total bond energy of a <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> and to calculate bond forces for all atoms in a system, and that calls the methods of the associated interaction class within that loop to calculate forces and/or energies for individual bonds. Analogous templates are provided in both the <a class="el" href="namespaceMcMd.html" title="Classes for Monte Carlo (MC) and molecular dynamics (MC) simulation.">McMd</a> and <a class="el" href="namespaceDdMd.html" title="Parallel domain decomposition (DD) molecular dynamics MD simulation.">DdMd</a> namespaces for angle, dihedral, link and external forces.</p>
<p>In the special case of non-bonded pair potentials, the <a class="el" href="namespaceMcMd.html" title="Classes for Monte Carlo (MC) and molecular dynamics (MC) simulation.">McMd</a> namespace contains two different implementation templates, named <a class="el" href="classMcMd_1_1McPairPotentialImpl.html" title="Implementation template for an McPairPotential.">McMd::McPairPotentialImpl</a> and <a class="el" href="classMcMd_1_1MdPairPotentialImpl.html" title="Implementation template for an MdPairPotential.">McMd::MdPairPotentialImpl</a>, which are designed for MC and MD simulations, respectively. These use different algorithms to do the energy and force calculations required in MC and MD simulations, and implement slightly different interfaces: The <a class="el" href="classMcMd_1_1McPairPotentialImpl.html" title="Implementation template for an McPairPotential.">McPairPotentialImpl</a> uses a cell list that is optimized for use in MC simulations. The <a class="el" href="classMcMd_1_1MdPairPotentialImpl.html" title="Implementation template for an MdPairPotential.">MdPairPotentialImpl</a> uses a Verlet pair list to implement the force loop required in MD simulations.</p>
<p>The <a class="el" href="namespaceDdMd.html" title="Parallel domain decomposition (DD) molecular dynamics MD simulation.">DdMd</a> namespace contains an analogous set of abstract base classes, e.g., <a class="el" href="classDdMd_1_1BondPotential.html" title="An BondPotential calculates bond forces and energies for a parent Simulation.">DdMd::BondPotential</a>, and implementation templates, such as <a class="el" href="classDdMd_1_1BondPotentialImpl.html" title="Implementation template for a BondPotential.">DdMd::BondPotentialImpl</a>. Their is no need in this case to distinguish between MC and MD variants of the pair potential, because this namespace only contains the code for parallel MD simulations.</p>
<h2><a class="anchor" id="potentials_factory_sec"></a>
Factory Classes</h2>
<p>Simpatico provides a default factory class for each of the above types of potential energy. The <a class="el" href="classMcMd_1_1BondFactory.html" title="Factory for BondPotential objects.">BondFactory</a>, <a class="el" href="classMcMd_1_1AngleFactory.html" title="Factory for subclasses of AnglePotential.">AngleFactory</a>, <a class="el" href="classMcMd_1_1DihedralFactory.html" title="Factory for subclasses of DihedralPotential.">DihedralFactory</a>, and <a class="el" href="classMcMd_1_1ExternalFactory.html" title="Factory for subclasses MdExternalPotential or McExternalPotential.">ExternalFactory</a> classes in the <a class="el" href="namespaceMcMd.html" title="Classes for Monte Carlo (MC) and molecular dynamics (MC) simulation.">McMd</a> namespace, and analogous classes with the same names in the <a class="el" href="namespaceDdMd.html" title="Parallel domain decomposition (DD) molecular dynamics MD simulation.">DdMd</a> namesapce, are derived from the Factory template, and use an interface similar to that of other factory classes. Like other factory classes, they all provide a single factory() method that takes a string argument and that (if possible) returns a pointer to a new instance of a subclass of the associated potential energy base class. In all of the potential energy factory classes, the name string that is passed as an argument to the factory method is actually the name of the required interaction classes (which is also a name for the potential energy function). For example, if the BondFactory::factory(std::string&amp;) method is passed the string "HarmonicBond", it constructs an instance of BondPotentialImpl&lt;HarmonicBond&gt;, and returns a "HarmonicBond* base class pointer to this new object.</p>
<p>The <a class="el" href="classMcMd_1_1PairFactory.html" title="Factory for subclasses MdPairPotential or McPairPotential.">McMd::PairFactory</a> class is slightly different. This class provides two methods, named mdFactory() and mcFactory(), that each take the name of a pair interaction, such as "LJPair", and return a pointer to a new <a class="el" href="classMcMd_1_1MdPairPotential.html" title="An PairPotential for MD simulation.">MdPairPotential</a> or <a class="el" href="classMcMd_1_1McPairPotential.html" title="A PairPotential for MC simulations (abstract).">McPairPotential</a> object that is constructed using the appropriate implementation template. The signatures of these methods are: </p>
<div class="fragment"><pre class="fragment">   <a class="code" href="classMcMd_1_1McPairPotential.html" title="A PairPotential for MC simulations (abstract).">McMd::McPairPotential</a>* mcFactory(std::string className);
   <a class="code" href="classMcMd_1_1MdPairPotential.html" title="An PairPotential for MD simulation.">McMd::MdPairPotential</a>* mdFactory(std::string className);
</pre></div><p> Because <a class="el" href="classMcMd_1_1PairFactory.html" title="Factory for subclasses MdPairPotential or McPairPotential.">McMd::PairFactory</a> does not implement the interface defined by the standard Factory template, it is not derived from the Factory template. <a class="el" href="classMcMd_1_1PairFactory.html" title="Factory for subclasses MdPairPotential or McPairPotential.">PairFactory</a> also provides a third factory method that takes an <a class="el" href="classMcMd_1_1McPairPotential.html" title="A PairPotential for MC simulations (abstract).">McPairPotential</a> by reference and returns a pointer to a corresponding <a class="el" href="classMcMd_1_1MdPairPotential.html" title="An PairPotential for MD simulation.">MdPairPotential</a>. This method is required for hybrid MC simulations, in which short MD simulations are used as proposed MC moves, and is used to construct an <a class="el" href="classMcMd_1_1MdPairPotential.html" title="An PairPotential for MD simulation.">MdPairPotential</a> for use in MD simulation that implements the same pair interaction as the <a class="el" href="classMcMd_1_1McPairPotential.html" title="A PairPotential for MC simulations (abstract).">McPairPotential</a> used by the parent MC simulation.</p>
<p>The implementations of the potential energy factory classes are generally very similar to those of other factory classes. Developers should consult the implementations of the default factory classes for different types of potential in the src/mcMd/potential/ and/or src/ddMd/potentials/ directories for further guidance.</p>
<p>Navigation: </p>
<ul style="list-style: none;">
<li>
<a class="el" href="extend_factory_page.html">5.3 Factory Classes</a> (Previous)  </li>
<li>
<a class="el" href="extend_page.html">5 Extending Simpatico</a> (Up)  </li>
<li>
<a class="el" href="extend_subfactory_page.html">5.5 Sub-Factories</a> (Next)  </li>
</ul>
</div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 21 2013 23:05:16 for Simpatico by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
