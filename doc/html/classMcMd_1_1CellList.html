<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Simpatico: McMd::CellList Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simpatico&#160;<span id="projectnumber">v1.0</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespaceMcMd.html">McMd</a>      </li>
      <li class="navelem"><a class="el" href="classMcMd_1_1CellList.html">CellList</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#friends">Friends</a>  </div>
  <div class="headertitle">
<h1>McMd::CellList Class Reference<div class="ingroups"><a class="el" href="group__McMd__Neighbor__Module.html">Nonbonded Neighbors</a></div></h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="McMd::CellList" --><hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>A cell list for <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> objects in a periodic system boundary. </p>
<p>A <a class="el" href="classMcMd_1_1CellList.html" title="A cell list for Atom objects in a periodic system boundary.">CellList</a> divides the volume within a Boundary into a grid of cells (i.e., regions), such that the length of each cell in each of 3 directions is greater * than a specified cutoff distance. Each cell has an integer index between 0 and totCells_ - 1. A <a class="el" href="classMcMd_1_1CellList.html" title="A cell list for Atom objects in a periodic system boundary.">CellList</a> can be used to identify all atoms that are within a cutoff distance of any point within a system, as required to calculate nonbonded energies and forces.</p>
<p>In this implementation, each cell is represented by a <a class="el" href="classMcMd_1_1Cell.html" title="A set of Atoms in a small region.">Cell</a> object. Each cell contains an small array of pointers to all all atoms in the associated volume. This implementation is designed to allow fast addition and removal of individual atoms. This implementation also wastes some memory, compared to a linked list implementation, because the dimension <a class="el" href="classMcMd_1_1Cell.html#a7cc8c945fc6918e225cc8d6d2d2c0843" title="Maximum number of atoms per cell.">Cell::MaxAtomCell</a> of the array of pointers in each <a class="el" href="classMcMd_1_1Cell.html" title="A set of Atoms in a small region.">Cell</a> must be large enough to accomodate the maximum number of atoms that will ever be encountered in an individual cell.</p>
<p><a class="el" href="classMcMd_1_1CellList.html" title="A cell list for Atom objects in a periodic system boundary.">CellList</a> is a non-polymorphic class, with no virtual methods, and a non-virtual destructor. Do not derive subclasses from it. </p>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html#l00054">54</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html">mcMd/neighbor/CellList.h</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="mcMd_2neighbor_2CellList_8h_source.html">CellList.h</a>&gt;</code></p>

<p><a href="classMcMd_1_1CellList-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classUtil_1_1FSArray.html">FSArray</a>&lt; <a class="el" href="classMcMd_1_1Atom.html">Atom</a> <br class="typebreak"/>
*, <a class="el" href="classMcMd_1_1CellList.html#aba50a3a17d2657e5f157265e61f91796">MaxNeighbor</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__McMd__Neighbor__Module.html#gaeec12b1b2a97eacfd8e4dad3131d8ca2">NeighborArray</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Static array for holding neighbors in a cell list.  <a href="group__McMd__Neighbor__Module.html#gaeec12b1b2a97eacfd8e4dad3131d8ca2"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#a8f32072d452f344f4df1723b1724019b">CellList</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a8f32072d452f344f4df1723b1724019b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#aaa776b07f06636c3e3b9fd9f27f511be">~CellList</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#aaa776b07f06636c3e3b9fd9f27f511be"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#a9bea78c1d93f2102ae793c3a377ff9f5">allocate</a> (int atomCapacity, const Boundary &amp;boundary, double cutoff)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for this <a class="el" href="classMcMd_1_1CellList.html" title="A cell list for Atom objects in a periodic system boundary.">CellList</a>.  <a href="#a9bea78c1d93f2102ae793c3a377ff9f5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#ae363f136446850f4920b2d2083b4bf46">makeGrid</a> (const Boundary &amp;boundary, double cutoff)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize grid geometry and set pointer to Boundary.  <a href="#ae363f136446850f4920b2d2083b4bf46"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#a3377b5bae7ae8c760bddc2e87dc00d81">clear</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets all <a class="el" href="classMcMd_1_1Cell.html" title="A set of Atoms in a small region.">Cell</a> objects to empty state (no Atoms).  <a href="#a3377b5bae7ae8c760bddc2e87dc00d81"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#a362efc492b788debcbad2e11d0a782a6">cellIndexFromPosition</a> (const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;pos) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return index of the cell that contains the position pos = (x,y,z).  <a href="#a362efc492b788debcbad2e11d0a782a6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#a2c1742bd324dd3ab05663dcb8ef2c382">addAtom</a> (<a class="el" href="classMcMd_1_1Atom.html">Atom</a> &amp;atom)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> to the appropriate cell, based on its position.  <a href="#a2c1742bd324dd3ab05663dcb8ef2c382"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#a07fd0c30018abf719bbf810818b7c1ff">deleteAtom</a> (<a class="el" href="classMcMd_1_1Atom.html">Atom</a> &amp;atom)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete a <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> object from its cell.  <a href="#a07fd0c30018abf719bbf810818b7c1ff"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#ac3abb595512ba9d50047860fc2375f96">updateAtomCell</a> (<a class="el" href="classMcMd_1_1Atom.html">Atom</a> &amp;atom, const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;pos)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Update <a class="el" href="classMcMd_1_1CellList.html" title="A cell list for Atom objects in a periodic system boundary.">CellList</a> to reflect a new atom position.  <a href="#ac3abb595512ba9d50047860fc2375f96"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#a5170b4abd47e6070d447408b2e0e8b5d">getNeighbors</a> (const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;pos, <a class="el" href="classUtil_1_1FSArray.html">NeighborArray</a> &amp;neighbors) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill a NeighborArray with pointers to atoms near a specified position.  <a href="#a5170b4abd47e6070d447408b2e0e8b5d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#af17127e060f6a75699d92d55b5d89ad2">getCellNeighbors</a> (int ic, <a class="el" href="classUtil_1_1FSArray.html">NeighborArray</a> &amp;neighbors, int &amp;nInCell) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill an array with pointers to atoms in a cell and neighboring cells.  <a href="#af17127e060f6a75699d92d55b5d89ad2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#a4830235fb4522616dbaedfcc6362ce7c">gridDimension</a> (int i) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of cells along axis i.  <a href="#a4830235fb4522616dbaedfcc6362ce7c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#afc404fadea4c7ea9587cd7a3ad15dc1c">totCells</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total number of cells in this <a class="el" href="classMcMd_1_1CellList.html" title="A cell list for Atom objects in a periodic system boundary.">CellList</a>.  <a href="#afc404fadea4c7ea9587cd7a3ad15dc1c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#ad7d0c6c58497d971a6d0c226283364d9">nAtom</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total number of atoms in this <a class="el" href="classMcMd_1_1CellList.html" title="A cell list for Atom objects in a periodic system boundary.">CellList</a>.  <a href="#ad7d0c6c58497d971a6d0c226283364d9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#a92cddc1af277e7b371fb068426596249">isAllocated</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Has memory been allocated for this <a class="el" href="classMcMd_1_1CellList.html" title="A cell list for Atom objects in a periodic system boundary.">CellList</a>?  <a href="#a92cddc1af277e7b371fb068426596249"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#a0da7a05fca30435effd0e1d7755c5997">isValid</a> (int nAtom=-1) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return true if valid, or throw Exception.  <a href="#a0da7a05fca30435effd0e1d7755c5997"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#aba50a3a17d2657e5f157265e61f91796">MaxNeighbor</a> = 27*<a class="el" href="classMcMd_1_1Cell.html#a7cc8c945fc6918e225cc8d6d2d2c0843">Cell::MaxAtomCell</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum possible number of neighboring atoms.  <a href="#aba50a3a17d2657e5f157265e61f91796"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="friends"></a>
Friends</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMcMd_1_1CellList.html#a470ff7a32beda5d8ccfb5053d59e0c49">::CellListTest</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Grant access to unit test class.  <a href="#a470ff7a32beda5d8ccfb5053d59e0c49"></a><br/></td></tr>
</table>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a8f32072d452f344f4df1723b1724019b"></a><!-- doxytag: member="McMd::CellList::CellList" ref="a8f32072d452f344f4df1723b1724019b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">McMd::CellList::CellList </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor. </p>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html#l00024">24</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html">mcMd/neighbor/CellList.cpp</a>.</p>

<p>References <a class="el" href="Dimension_8h_source.html#l00019">Util::Dimension</a>.</p>

</div>
</div>
<a class="anchor" id="aaa776b07f06636c3e3b9fd9f27f511be"></a><!-- doxytag: member="McMd::CellList::~CellList" ref="aaa776b07f06636c3e3b9fd9f27f511be" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">McMd::CellList::~CellList </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destructor. </p>
<p>Deallocates array of <a class="el" href="classMcMd_1_1Cell.html" title="A set of Atoms in a small region.">Cell</a> objects, if necessary. </p>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html#l00041">41</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html">mcMd/neighbor/CellList.cpp</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a9bea78c1d93f2102ae793c3a377ff9f5"></a><!-- doxytag: member="McMd::CellList::allocate" ref="a9bea78c1d93f2102ae793c3a377ff9f5" args="(int atomCapacity, const Boundary &amp;boundary, double cutoff)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void McMd::CellList::allocate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>atomCapacity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Boundary &amp;&#160;</td>
          <td class="paramname"><em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allocate memory for this <a class="el" href="classMcMd_1_1CellList.html" title="A cell list for Atom objects in a periodic system boundary.">CellList</a>. </p>
<p>This function:</p>
<ul>
<li>Allocates an array of atomCapacity <a class="el" href="classMcMd_1_1CellTag.html" title="Location of the pointer to a particular Atom in a CellList.">CellTag</a> objects.</li>
<li>Allocates an array of <a class="el" href="classMcMd_1_1Cell.html" title="A set of Atoms in a small region.">Cell</a> objects sized for this boundary.</li>
</ul>
<p>The capacity of the array of Cells is chosen such that, if each dimension of the system increases by the parameter "scale", all dimensions of each cell will remain greater than the parameter "cutoff". The cutoff should be greater than or equal to the maximum range of the nonbonded pair potential.</p>
<p>This function does not populate the <a class="el" href="classMcMd_1_1CellList.html" title="A cell list for Atom objects in a periodic system boundary.">CellList</a> with atoms. See the <a class="el" href="classMcMd_1_1CellList.html#a2c1742bd324dd3ab05663dcb8ef2c382" title="Add a Atom to the appropriate cell, based on its position.">CellList::addAtom()</a> methods.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">atomCapacity</td><td>dimension of global array of atoms </td></tr>
    <tr><td class="paramname">boundary</td><td>maximum Boundary for allocation of array of cells </td></tr>
    <tr><td class="paramname">cutoff</td><td>minimum dimension of a cell in any direction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html#l00102">102</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html">mcMd/neighbor/CellList.cpp</a>.</p>

<p>References <a class="el" href="global_8h_source.html#l00051">UTIL_THROW</a>.</p>

<p>Referenced by <a class="el" href="Linear_8cpp_source.html#l00187">McMd::Linear::generateMolecules()</a>.</p>

</div>
</div>
<a class="anchor" id="ae363f136446850f4920b2d2083b4bf46"></a><!-- doxytag: member="McMd::CellList::makeGrid" ref="ae363f136446850f4920b2d2083b4bf46" args="(const Boundary &amp;boundary, double cutoff)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void McMd::CellList::makeGrid </td>
          <td>(</td>
          <td class="paramtype">const Boundary &amp;&#160;</td>
          <td class="paramname"><em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize grid geometry and set pointer to Boundary. </p>
<p>The number of cells in each direction is chosen such that the dimension of each cell in each direction is greater than or equal to the cutoff parameter. To calculate nonbonded pair interaction energies, the cutoff parameter should thus be equal to or greater than the maximum range of nonbonded interactions.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>Boundary object for the system </td></tr>
    <tr><td class="paramname">cutoff</td><td>Minimum dimension of a cell in any direction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html#l00123">123</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html">mcMd/neighbor/CellList.cpp</a>.</p>

<p>References <a class="el" href="global_8h_source.html#l00051">UTIL_THROW</a>.</p>

</div>
</div>
<a class="anchor" id="a3377b5bae7ae8c760bddc2e87dc00d81"></a><!-- doxytag: member="McMd::CellList::clear" ref="a3377b5bae7ae8c760bddc2e87dc00d81" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void McMd::CellList::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets all <a class="el" href="classMcMd_1_1Cell.html" title="A set of Atoms in a small region.">Cell</a> objects to empty state (no Atoms). </p>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html#l00047">47</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html">mcMd/neighbor/CellList.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a362efc492b788debcbad2e11d0a782a6"></a><!-- doxytag: member="McMd::CellList::cellIndexFromPosition" ref="a362efc492b788debcbad2e11d0a782a6" args="(const Vector &amp;pos) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int McMd::CellList::cellIndexFromPosition </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>pos</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return index of the cell that contains the position pos = (x,y,z). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">pos</td><td>position vector, as an array pos = {x, y, z} </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>index of cell that contains position pos[3] </dd></dl>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html#l00358">358</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html">mcMd/neighbor/CellList.h</a>.</p>

<p>References <a class="el" href="global_8h_source.html#l00051">UTIL_THROW</a>.</p>

</div>
</div>
<a class="anchor" id="a2c1742bd324dd3ab05663dcb8ef2c382"></a><!-- doxytag: member="McMd::CellList::addAtom" ref="a2c1742bd324dd3ab05663dcb8ef2c382" args="(Atom &amp;atom)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void McMd::CellList::addAtom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMcMd_1_1Atom.html">Atom</a> &amp;&#160;</td>
          <td class="paramname"><em>atom</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> to the appropriate cell, based on its position. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">atom</td><td><a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> object to be added. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html#l00425">425</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html">mcMd/neighbor/CellList.h</a>.</p>

<p>References <a class="el" href="mcMd_2chemistry_2Atom_8h_source.html#l00259">McMd::Atom::id()</a>, and <a class="el" href="mcMd_2chemistry_2Atom_8h_source.html#l00267">McMd::Atom::position()</a>.</p>

<p>Referenced by <a class="el" href="Linear_8cpp_source.html#l00187">McMd::Linear::generateMolecules()</a>.</p>

</div>
</div>
<a class="anchor" id="a07fd0c30018abf719bbf810818b7c1ff"></a><!-- doxytag: member="McMd::CellList::deleteAtom" ref="a07fd0c30018abf719bbf810818b7c1ff" args="(Atom &amp;atom)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void McMd::CellList::deleteAtom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMcMd_1_1Atom.html">Atom</a> &amp;&#160;</td>
          <td class="paramname"><em>atom</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Delete a <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> object from its cell. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">atom</td><td><a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> object to be deleted </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html#l00414">414</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html">mcMd/neighbor/CellList.h</a>.</p>

<p>References <a class="el" href="CellTag_8h_source.html#l00036">McMd::CellTag::cellId</a>, and <a class="el" href="mcMd_2chemistry_2Atom_8h_source.html#l00259">McMd::Atom::id()</a>.</p>

<p>Referenced by <a class="el" href="Linear_8cpp_source.html#l00187">McMd::Linear::generateMolecules()</a>.</p>

</div>
</div>
<a class="anchor" id="ac3abb595512ba9d50047860fc2375f96"></a><!-- doxytag: member="McMd::CellList::updateAtomCell" ref="ac3abb595512ba9d50047860fc2375f96" args="(Atom &amp;atom, const Vector &amp;pos)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void McMd::CellList::updateAtomCell </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMcMd_1_1Atom.html">Atom</a> &amp;&#160;</td>
          <td class="paramname"><em>atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update <a class="el" href="classMcMd_1_1CellList.html" title="A cell list for Atom objects in a periodic system boundary.">CellList</a> to reflect a new atom position. </p>
<p>If a new atom position pos[3] lies in a new cell, with a cell index icell != atom.cellId, then delete the atom from the old <a class="el" href="classMcMd_1_1Cell.html" title="A set of Atoms in a small region.">Cell</a> object and add it to the new one. If the new cell is the same as the old one (icell == atom.CellId), do nothing and return.</p>
<p>This method updates the <a class="el" href="classMcMd_1_1CellList.html" title="A cell list for Atom objects in a periodic system boundary.">CellList</a>, but does not update the coordinates stored in the pos member of the associated <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> object. To update both, use the System::moveAtom() method.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">atom</td><td><a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> object to be moved </td></tr>
    <tr><td class="paramname">pos</td><td>new <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> position </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html#l00437">437</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html">mcMd/neighbor/CellList.h</a>.</p>

<p>References <a class="el" href="CellTag_8h_source.html#l00036">McMd::CellTag::cellId</a>, and <a class="el" href="mcMd_2chemistry_2Atom_8h_source.html#l00259">McMd::Atom::id()</a>.</p>

</div>
</div>
<a class="anchor" id="a5170b4abd47e6070d447408b2e0e8b5d"></a><!-- doxytag: member="McMd::CellList::getNeighbors" ref="a5170b4abd47e6070d447408b2e0e8b5d" args="(const Vector &amp;pos, NeighborArray &amp;neighbors) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void McMd::CellList::getNeighbors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classUtil_1_1FSArray.html">NeighborArray</a> &amp;&#160;</td>
          <td class="paramname"><em>neighbors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fill a NeighborArray with pointers to atoms near a specified position. </p>
<p>Upon return, array neighbors contains pointers to all <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> objects in the cell containing the position pos, and in all neighboring cells. The number of such Atoms is given by the size() of this FSArray &lt; Atom* &gt; array.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">pos</td><td>position Vector, pos = {x, y, z} </td></tr>
    <tr><td class="paramname">neighbors</td><td>array of pointers to neighbor Atoms. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html#l00454">454</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html">mcMd/neighbor/CellList.h</a>.</p>

<p>Referenced by <a class="el" href="Linear_8cpp_source.html#l00187">McMd::Linear::generateMolecules()</a>, and <a class="el" href="RingOctaRebridgeMove_8cpp_source.html#l00162">McMd::RingOctaRebridgeMove::scanBridge()</a>.</p>

</div>
</div>
<a class="anchor" id="af17127e060f6a75699d92d55b5d89ad2"></a><!-- doxytag: member="McMd::CellList::getCellNeighbors" ref="af17127e060f6a75699d92d55b5d89ad2" args="(int ic, NeighborArray &amp;neighbors, int &amp;nInCell) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void McMd::CellList::getCellNeighbors </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classUtil_1_1FSArray.html">NeighborArray</a> &amp;&#160;</td>
          <td class="paramname"><em>neighbors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>nInCell</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fill an array with pointers to atoms in a cell and neighboring cells. </p>
<p>Upon return, the NeighborArray neighbors contains pointers to all of the atoms in cell number ic and all neighboring cells. The number of such Atoms is given by the size() of this FSArray &lt; Atom* &gt; array. Also, upon return, nInCell is the number of Atoms in cell ic. Pointers to the atoms in cell ic are listed in the elements neighbors[0], ... , neighbors[nInCell-1] of the neighbors array, while those in neighboring are in elements neighbors[nInCell], ... , neighbors[neighbors.size()-1].</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ic</td><td>cell index </td></tr>
    <tr><td class="paramname">neighbors</td><td>FSArray containing pointers to neighbor Atoms </td></tr>
    <tr><td class="paramname">nInCell</td><td>number of Atoms in cell ic. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html#l00153">153</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html">mcMd/neighbor/CellList.cpp</a>.</p>

<p>References <a class="el" href="mcMd_2neighbor_2Cell_8h_source.html#l00237">McMd::Cell::atomPtr()</a>, and <a class="el" href="mcMd_2neighbor_2Cell_8h_source.html#l00234">McMd::Cell::firstClearPos()</a>.</p>

<p>Referenced by <a class="el" href="McPairEnergyAverage_8cpp_source.html#l00072">McMd::McPairEnergyAverage::sample()</a>.</p>

</div>
</div>
<a class="anchor" id="a4830235fb4522616dbaedfcc6362ce7c"></a><!-- doxytag: member="McMd::CellList::gridDimension" ref="a4830235fb4522616dbaedfcc6362ce7c" args="(int i) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int McMd::CellList::gridDimension </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Number of cells along axis i. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>index for axis (direction). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html#l00494">494</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html">mcMd/neighbor/CellList.h</a>.</p>

</div>
</div>
<a class="anchor" id="afc404fadea4c7ea9587cd7a3ad15dc1c"></a><!-- doxytag: member="McMd::CellList::totCells" ref="afc404fadea4c7ea9587cd7a3ad15dc1c" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int McMd::CellList::totCells </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get total number of cells in this <a class="el" href="classMcMd_1_1CellList.html" title="A cell list for Atom objects in a periodic system boundary.">CellList</a>. </p>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html#l00352">352</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html">mcMd/neighbor/CellList.h</a>.</p>

<p>Referenced by <a class="el" href="McPairEnergyAverage_8cpp_source.html#l00072">McMd::McPairEnergyAverage::sample()</a>.</p>

</div>
</div>
<a class="anchor" id="ad7d0c6c58497d971a6d0c226283364d9"></a><!-- doxytag: member="McMd::CellList::nAtom" ref="ad7d0c6c58497d971a6d0c226283364d9" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int McMd::CellList::nAtom </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get total number of atoms in this <a class="el" href="classMcMd_1_1CellList.html" title="A cell list for Atom objects in a periodic system boundary.">CellList</a>. </p>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html#l00222">222</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html">mcMd/neighbor/CellList.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a92cddc1af277e7b371fb068426596249"></a><!-- doxytag: member="McMd::CellList::isAllocated" ref="a92cddc1af277e7b371fb068426596249" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool McMd::CellList::isAllocated </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Has memory been allocated for this <a class="el" href="classMcMd_1_1CellList.html" title="A cell list for Atom objects in a periodic system boundary.">CellList</a>? </p>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html#l00497">497</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html">mcMd/neighbor/CellList.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0da7a05fca30435effd0e1d7755c5997"></a><!-- doxytag: member="McMd::CellList::isValid" ref="a0da7a05fca30435effd0e1d7755c5997" args="(int nAtom=&#45;1) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool McMd::CellList::isValid </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nAtom</em> = <code>-1</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return true if valid, or throw Exception. </p>
<p>If nAtom &gt;= 0, check that number of atoms equals nAtom. If nAtom &lt; 0, skip this check.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">nAtom</td><td>number of atoms in atom and position arrays. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if valid, otherwise throw an Exception. </dd></dl>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html#l00237">237</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html">mcMd/neighbor/CellList.cpp</a>.</p>

<p>References <a class="el" href="global_8h_source.html#l00051">UTIL_THROW</a>.</p>

</div>
</div>
<hr/><h2>Friends And Related Function Documentation</h2>
<a class="anchor" id="a470ff7a32beda5d8ccfb5053d59e0c49"></a><!-- doxytag: member="McMd::CellList::::CellListTest" ref="a470ff7a32beda5d8ccfb5053d59e0c49" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">friend class ::CellListTest<code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Grant access to unit test class. </p>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html#l00342">342</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html">mcMd/neighbor/CellList.h</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="aba50a3a17d2657e5f157265e61f91796"></a><!-- doxytag: member="McMd::CellList::MaxNeighbor" ref="aba50a3a17d2657e5f157265e61f91796" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int <a class="el" href="classMcMd_1_1CellList.html#aba50a3a17d2657e5f157265e61f91796">McMd::CellList::MaxNeighbor</a> = 27*<a class="el" href="classMcMd_1_1Cell.html#a7cc8c945fc6918e225cc8d6d2d2c0843">Cell::MaxAtomCell</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Maximum possible number of neighboring atoms. </p>
<p>Use as dimension of the array neighbor passed to <a class="el" href="classMcMd_1_1CellList.html#a5170b4abd47e6070d447408b2e0e8b5d" title="Fill a NeighborArray with pointers to atoms near a specified position.">getNeighbors()</a> and <a class="el" href="classMcMd_1_1CellList.html#af17127e060f6a75699d92d55b5d89ad2" title="Fill an array with pointers to atoms in a cell and neighboring cells.">getCellNeighbors()</a>. </p>

<p>Definition at line <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html#l00067">67</a> of file <a class="el" href="mcMd_2neighbor_2CellList_8h_source.html">mcMd/neighbor/CellList.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="mcMd_2neighbor_2CellList_8h_source.html">mcMd/neighbor/CellList.h</a></li>
<li><a class="el" href="mcMd_2neighbor_2CellList_8cpp_source.html">mcMd/neighbor/CellList.cpp</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Sun Aug 26 2012 06:54:28 for Simpatico by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
