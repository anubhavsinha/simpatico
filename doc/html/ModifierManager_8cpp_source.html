<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Simpatico: ModifierManager.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simpatico
   &#160;<span id="projectnumber">v1.10</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">ModifierManager.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">* Simpatico - Simulation Package for Polymeric and Molecular Liquids</span>
<a name="l00003"></a>00003 <span class="comment">*</span>
<a name="l00004"></a>00004 <span class="comment">* Copyright 2010 - 2014, The Regents of the University of Minnesota</span>
<a name="l00005"></a>00005 <span class="comment">* Distributed under the terms of the GNU General Public License.</span>
<a name="l00006"></a>00006 <span class="comment">*/</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="preprocessor">#include &quot;ModifierManager.h&quot;</span> 
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;ModifierFactory.h&quot;</span> 
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="keyword">namespace </span>DdMd
<a name="l00012"></a>00012 {
<a name="l00013"></a>00013 
<a name="l00014"></a>00014    <span class="keyword">using namespace </span>Util;
<a name="l00015"></a>00015 
<a name="l00016"></a>00016    <span class="comment">/*</span>
<a name="l00017"></a>00017 <span class="comment">   * Default constructor.</span>
<a name="l00018"></a>00018 <span class="comment">   */</span>
<a name="l00019"></a><a class="code" href="classDdMd_1_1ModifierManager.html#ae980b32ad9beb18a4c639a692d534e97">00019</a>    <a class="code" href="classDdMd_1_1ModifierManager.html#ae980b32ad9beb18a4c639a692d534e97" title="Default constructor (for unit testing).">ModifierManager::ModifierManager</a>()
<a name="l00020"></a>00020     : <a class="code" href="classUtil_1_1Manager.html" title="Template container for pointers to objects with a common base class.">Manager</a>&lt;<a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>&gt;(),
<a name="l00021"></a>00021       simulationPtr_(0),
<a name="l00022"></a>00022       setupModifiers_(),
<a name="l00023"></a>00023       preIntegrate1Modifiers_(),
<a name="l00024"></a>00024       postIntegrate1Modifiers_(),
<a name="l00025"></a>00025       preTransformModifiers_(),
<a name="l00026"></a>00026       preExchangeModifiers_(),
<a name="l00027"></a>00027       postExchangeModifiers_(),
<a name="l00028"></a>00028       postNeighborModifiers_(),
<a name="l00029"></a>00029       preUpdateModifiers_(),
<a name="l00030"></a>00030       postUpdateModifiers_(),
<a name="l00031"></a>00031       preForceModifiers_(),
<a name="l00032"></a>00032       postForceModifiers_(),
<a name="l00033"></a>00033       endOfStepModifiers_(),
<a name="l00034"></a>00034       exchangeModifiers_(),
<a name="l00035"></a>00035       updateModifiers_(),
<a name="l00036"></a>00036       reverseUpdateModifiers_()
<a name="l00037"></a>00037    { <a class="code" href="classUtil_1_1ParamComposite.html#a30752567fd7b8b93e5c8476bbe8592c5" title="Set class name string.">setClassName</a>(<span class="stringliteral">&quot;ModifierManager&quot;</span>); }
<a name="l00038"></a>00038 
<a name="l00039"></a>00039    <span class="comment">/*</span>
<a name="l00040"></a>00040 <span class="comment">   * Constructor.</span>
<a name="l00041"></a>00041 <span class="comment">   */</span>
<a name="l00042"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a08ce80a0e156293fe0ac698dd5b322ba">00042</a>    <a class="code" href="classDdMd_1_1ModifierManager.html#ae980b32ad9beb18a4c639a692d534e97" title="Default constructor (for unit testing).">ModifierManager::ModifierManager</a>(<a class="code" href="classDdMd_1_1Simulation.html" title="Main object for a domain-decomposition MD simulation.">Simulation</a>&amp; simulation)
<a name="l00043"></a>00043     : <a class="code" href="classUtil_1_1Manager.html" title="Template container for pointers to objects with a common base class.">Manager</a>&lt;<a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>&gt;(),
<a name="l00044"></a>00044       simulationPtr_(&amp;simulation),
<a name="l00045"></a>00045       setupModifiers_(),
<a name="l00046"></a>00046       preIntegrate1Modifiers_(),
<a name="l00047"></a>00047       postIntegrate1Modifiers_(),
<a name="l00048"></a>00048       preTransformModifiers_(),
<a name="l00049"></a>00049       preExchangeModifiers_(),
<a name="l00050"></a>00050       postExchangeModifiers_(),
<a name="l00051"></a>00051       postNeighborModifiers_(),
<a name="l00052"></a>00052       preUpdateModifiers_(),
<a name="l00053"></a>00053       postUpdateModifiers_(),
<a name="l00054"></a>00054       preForceModifiers_(),
<a name="l00055"></a>00055       postForceModifiers_(),
<a name="l00056"></a>00056       endOfStepModifiers_(),
<a name="l00057"></a>00057       exchangeModifiers_(),
<a name="l00058"></a>00058       updateModifiers_(),
<a name="l00059"></a>00059       reverseUpdateModifiers_()
<a name="l00060"></a>00060    {  <a class="code" href="classUtil_1_1ParamComposite.html#a30752567fd7b8b93e5c8476bbe8592c5" title="Set class name string.">setClassName</a>(<span class="stringliteral">&quot;ModifierManager&quot;</span>); }
<a name="l00061"></a>00061 
<a name="l00062"></a>00062    <span class="comment">/*</span>
<a name="l00063"></a>00063 <span class="comment">   * Destructor.</span>
<a name="l00064"></a>00064 <span class="comment">   */</span>
<a name="l00065"></a><a class="code" href="classDdMd_1_1ModifierManager.html#aff1a7e10b5d13ac0b4e23c960669b7c4">00065</a>    <a class="code" href="classDdMd_1_1ModifierManager.html#aff1a7e10b5d13ac0b4e23c960669b7c4" title="Destructor.">ModifierManager::~ModifierManager</a>()
<a name="l00066"></a>00066    {} 
<a name="l00067"></a>00067 
<a name="l00068"></a>00068    <span class="comment">/*</span>
<a name="l00069"></a>00069 <span class="comment">   * Read parameter file. </span>
<a name="l00070"></a>00070 <span class="comment">   *</span>
<a name="l00071"></a>00071 <span class="comment">   * \param in input parameter file stream.</span>
<a name="l00072"></a>00072 <span class="comment">   */</span>
<a name="l00073"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a20f12ea858bcb575c48003b696e686c1">00073</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#a20f12ea858bcb575c48003b696e686c1" title="Read main block of parameter file.">ModifierManager::readParameters</a>(std::istream &amp;in)
<a name="l00074"></a>00074    {
<a name="l00075"></a>00075       <a class="code" href="classDdMd_1_1ModifierManager.html#a20f12ea858bcb575c48003b696e686c1" title="Read main block of parameter file.">Manager&lt;Modifier&gt;::readParameters</a>(in);
<a name="l00076"></a>00076 
<a name="l00077"></a>00077       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00078"></a>00078       <span class="keywordflow">for</span>  (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classUtil_1_1Manager.html#a222f7a35ec583044c76543bf366b0fe6" title="Get logical size.">size</a>(); ++i) {
<a name="l00079"></a>00079          ptr = &amp;(*this)[i];
<a name="l00080"></a>00080          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a444711c31e55c832b5440ea08c793893" title="Return true if a flag is set, false otherwise.">isSet</a>(<a class="code" href="classDdMd_1_1Modifier_1_1Flags.html#a20828f35b5dca2c59e0666f1adb7ac80" title="Flag to activate setup() function.">Modifier::Flags::Setup</a>)) { 
<a name="l00081"></a>00081             setupModifiers_.<a class="code" href="classUtil_1_1GPArray.html#a82468511e8006c0a9ba15fa3d316bb78" title="Append an element to the end of the sequence.">append</a>(*ptr); 
<a name="l00082"></a>00082          }
<a name="l00083"></a>00083          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a444711c31e55c832b5440ea08c793893" title="Return true if a flag is set, false otherwise.">isSet</a>(<a class="code" href="classDdMd_1_1Modifier_1_1Flags.html#a4577e43e3f690589ce221480019036b4" title="Flag to activate preIntegrate() function.">Modifier::Flags::PreIntegrate1</a>)) { 
<a name="l00084"></a>00084             preIntegrate1Modifiers_.<a class="code" href="classUtil_1_1GPArray.html#a82468511e8006c0a9ba15fa3d316bb78" title="Append an element to the end of the sequence.">append</a>(*ptr); 
<a name="l00085"></a>00085          }
<a name="l00086"></a>00086          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a444711c31e55c832b5440ea08c793893" title="Return true if a flag is set, false otherwise.">isSet</a>(<a class="code" href="classDdMd_1_1Modifier_1_1Flags.html#a1131a4cdf79b1abe09ba122032ad40ea" title="Flag to activate postIntegrate1() function.">Modifier::Flags::PostIntegrate1</a>)) { 
<a name="l00087"></a>00087             postIntegrate1Modifiers_.<a class="code" href="classUtil_1_1GPArray.html#a82468511e8006c0a9ba15fa3d316bb78" title="Append an element to the end of the sequence.">append</a>(*ptr); 
<a name="l00088"></a>00088          }
<a name="l00089"></a>00089          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a444711c31e55c832b5440ea08c793893" title="Return true if a flag is set, false otherwise.">isSet</a>(<a class="code" href="classDdMd_1_1Modifier_1_1Flags.html#a16df2da39f6fd2aa55fb8d330f6eec60" title="Flag to activate preTransform() function.">Modifier::Flags::PreTransform</a>)) { 
<a name="l00090"></a>00090             preTransformModifiers_.<a class="code" href="classUtil_1_1GPArray.html#a82468511e8006c0a9ba15fa3d316bb78" title="Append an element to the end of the sequence.">append</a>(*ptr); 
<a name="l00091"></a>00091          }
<a name="l00092"></a>00092          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a444711c31e55c832b5440ea08c793893" title="Return true if a flag is set, false otherwise.">isSet</a>(<a class="code" href="classDdMd_1_1Modifier_1_1Flags.html#af6392fd53e18220798979d3c1b994527" title="Flag to activate preExchange() function.">Modifier::Flags::PreExchange</a>)) { 
<a name="l00093"></a>00093             preExchangeModifiers_.<a class="code" href="classUtil_1_1GPArray.html#a82468511e8006c0a9ba15fa3d316bb78" title="Append an element to the end of the sequence.">append</a>(*ptr); 
<a name="l00094"></a>00094          }
<a name="l00095"></a>00095          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a444711c31e55c832b5440ea08c793893" title="Return true if a flag is set, false otherwise.">isSet</a>(<a class="code" href="classDdMd_1_1Modifier_1_1Flags.html#a5ec0c0c09a5dd9de4b5048725c277448" title="Flag to activate postExchange() function.">Modifier::Flags::PostExchange</a>)) { 
<a name="l00096"></a>00096             postExchangeModifiers_.<a class="code" href="classUtil_1_1GPArray.html#a82468511e8006c0a9ba15fa3d316bb78" title="Append an element to the end of the sequence.">append</a>(*ptr); 
<a name="l00097"></a>00097          }
<a name="l00098"></a>00098          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a444711c31e55c832b5440ea08c793893" title="Return true if a flag is set, false otherwise.">isSet</a>(<a class="code" href="classDdMd_1_1Modifier_1_1Flags.html#accf026e3e0bd9f8b770e376f61bd2320" title="Flag to activate postNeighbor() function.">Modifier::Flags::PostNeighbor</a>)) { 
<a name="l00099"></a>00099             postNeighborModifiers_.<a class="code" href="classUtil_1_1GPArray.html#a82468511e8006c0a9ba15fa3d316bb78" title="Append an element to the end of the sequence.">append</a>(*ptr); 
<a name="l00100"></a>00100          }
<a name="l00101"></a>00101          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a444711c31e55c832b5440ea08c793893" title="Return true if a flag is set, false otherwise.">isSet</a>(<a class="code" href="classDdMd_1_1Modifier_1_1Flags.html#a41a9c3dfe296e93d33e6e4c897f3b1f9" title="Flag to activate preUpdate() function.">Modifier::Flags::PreUpdate</a>)) { 
<a name="l00102"></a>00102             preUpdateModifiers_.<a class="code" href="classUtil_1_1GPArray.html#a82468511e8006c0a9ba15fa3d316bb78" title="Append an element to the end of the sequence.">append</a>(*ptr); 
<a name="l00103"></a>00103          }
<a name="l00104"></a>00104          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a444711c31e55c832b5440ea08c793893" title="Return true if a flag is set, false otherwise.">isSet</a>(<a class="code" href="classDdMd_1_1Modifier_1_1Flags.html#a1cd3385bcd761d849a6519683457dcef" title="Flag to activate postUpdate() function.">Modifier::Flags::PostUpdate</a>)) { 
<a name="l00105"></a>00105             postUpdateModifiers_.<a class="code" href="classUtil_1_1GPArray.html#a82468511e8006c0a9ba15fa3d316bb78" title="Append an element to the end of the sequence.">append</a>(*ptr); 
<a name="l00106"></a>00106          }
<a name="l00107"></a>00107          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a444711c31e55c832b5440ea08c793893" title="Return true if a flag is set, false otherwise.">isSet</a>(<a class="code" href="classDdMd_1_1Modifier_1_1Flags.html#a30af0af5f3f36a2b7360f850b85d9e60" title="Flag to activate preForce() function.">Modifier::Flags::PreForce</a>)) { 
<a name="l00108"></a>00108             preForceModifiers_.<a class="code" href="classUtil_1_1GPArray.html#a82468511e8006c0a9ba15fa3d316bb78" title="Append an element to the end of the sequence.">append</a>(*ptr); 
<a name="l00109"></a>00109          }
<a name="l00110"></a>00110          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a444711c31e55c832b5440ea08c793893" title="Return true if a flag is set, false otherwise.">isSet</a>(<a class="code" href="classDdMd_1_1Modifier_1_1Flags.html#a20306c53ec4a7d2125ca460387754907" title="Flag to activate postForce() function.">Modifier::Flags::PostForce</a>)) { 
<a name="l00111"></a>00111             postForceModifiers_.<a class="code" href="classUtil_1_1GPArray.html#a82468511e8006c0a9ba15fa3d316bb78" title="Append an element to the end of the sequence.">append</a>(*ptr); 
<a name="l00112"></a>00112          }
<a name="l00113"></a>00113          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a444711c31e55c832b5440ea08c793893" title="Return true if a flag is set, false otherwise.">isSet</a>(<a class="code" href="classDdMd_1_1Modifier_1_1Flags.html#a35684cce636401adf37ba6ac98dd2409" title="Flag to activate endOfStep() function.">Modifier::Flags::EndOfStep</a>)) { 
<a name="l00114"></a>00114             endOfStepModifiers_.<a class="code" href="classUtil_1_1GPArray.html#a82468511e8006c0a9ba15fa3d316bb78" title="Append an element to the end of the sequence.">append</a>(*ptr); 
<a name="l00115"></a>00115          }
<a name="l00116"></a>00116          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a444711c31e55c832b5440ea08c793893" title="Return true if a flag is set, false otherwise.">isSet</a>(<a class="code" href="classDdMd_1_1Modifier_1_1Flags.html#a6f2adb8a32b9d1d6762ff47918376022" title="Flag to activate pack/unpack exchange functions.">Modifier::Flags::Exchange</a>)) { 
<a name="l00117"></a>00117             exchangeModifiers_.<a class="code" href="classUtil_1_1GPArray.html#a82468511e8006c0a9ba15fa3d316bb78" title="Append an element to the end of the sequence.">append</a>(*ptr); 
<a name="l00118"></a>00118          }
<a name="l00119"></a>00119          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a444711c31e55c832b5440ea08c793893" title="Return true if a flag is set, false otherwise.">isSet</a>(<a class="code" href="classDdMd_1_1Modifier_1_1Flags.html#ad37f6f4b6e0aa79727fc26aa803bd15e" title="Flag to activate pack/unpack update functions.">Modifier::Flags::Update</a>)) { 
<a name="l00120"></a>00120             updateModifiers_.<a class="code" href="classUtil_1_1GPArray.html#a82468511e8006c0a9ba15fa3d316bb78" title="Append an element to the end of the sequence.">append</a>(*ptr); 
<a name="l00121"></a>00121          }
<a name="l00122"></a>00122          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a444711c31e55c832b5440ea08c793893" title="Return true if a flag is set, false otherwise.">isSet</a>(<a class="code" href="classDdMd_1_1Modifier_1_1Flags.html#a189a1d4c60d492e0464dcabfd2265d85" title="Flag to activate pack/unpack reverse update functions.">Modifier::Flags::ReverseUpdate</a>)) { 
<a name="l00123"></a>00123             reverseUpdateModifiers_.<a class="code" href="classUtil_1_1GPArray.html#a82468511e8006c0a9ba15fa3d316bb78" title="Append an element to the end of the sequence.">append</a>(*ptr); 
<a name="l00124"></a>00124          }
<a name="l00125"></a>00125       } <span class="comment">// end for i </span>
<a name="l00126"></a>00126    }
<a name="l00127"></a>00127 
<a name="l00128"></a>00128    <span class="comment">// Setup</span>
<a name="l00129"></a>00129 
<a name="l00130"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a3fd957fa8a9d9cc26c9b27429597d9e0">00130</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#a3fd957fa8a9d9cc26c9b27429597d9e0" title="Setup before entering the main loop.">ModifierManager::setup</a>() 
<a name="l00131"></a>00131    {
<a name="l00132"></a>00132       <span class="keywordtype">int</span> n = setupModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00133"></a>00133       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00134"></a>00134          setupModifiers_[i].setup();
<a name="l00135"></a>00135       }
<a name="l00136"></a>00136    }
<a name="l00137"></a>00137  
<a name="l00138"></a>00138    <span class="comment">// Integration actions</span>
<a name="l00139"></a>00139 
<a name="l00140"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a5d6ab4abf7b2243d8bfab7ad2ad91f78">00140</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#a5d6ab4abf7b2243d8bfab7ad2ad91f78" title="Call just before the first step of velocity-Verlet algorithm.">ModifierManager::preIntegrate1</a>(<span class="keywordtype">long</span> iStep)
<a name="l00141"></a>00141    {
<a name="l00142"></a>00142       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00143"></a>00143       <span class="keywordtype">int</span> n = preIntegrate1Modifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00144"></a>00144       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00145"></a>00145          ptr = &amp;preIntegrate1Modifiers_[i];
<a name="l00146"></a>00146          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a6a44259d2652b7da08a50a5e2d161c94" title="Return true iff iStep is a multiple of the interval.">isAtInterval</a>(iStep)) {
<a name="l00147"></a>00147             ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a32632f4cc0636c3b7ff0afed2e510078" title="Call just before the first step of velocity-Verlet algorithm.">preIntegrate1</a>(iStep);
<a name="l00148"></a>00148          }
<a name="l00149"></a>00149       }
<a name="l00150"></a>00150    }
<a name="l00151"></a>00151  
<a name="l00152"></a><a class="code" href="classDdMd_1_1ModifierManager.html#ab622f0c2abe8d7076e66e171d3fa61fe">00152</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#ab622f0c2abe8d7076e66e171d3fa61fe" title="Call just after the first step of velocity-Verlet algorithm.">ModifierManager::postIntegrate1</a>(<span class="keywordtype">long</span> iStep)
<a name="l00153"></a>00153    {
<a name="l00154"></a>00154       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00155"></a>00155       <span class="keywordtype">int</span> n = postIntegrate1Modifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00156"></a>00156       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00157"></a>00157          ptr = &amp;postIntegrate1Modifiers_[i];
<a name="l00158"></a>00158          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a6a44259d2652b7da08a50a5e2d161c94" title="Return true iff iStep is a multiple of the interval.">isAtInterval</a>(iStep)) {
<a name="l00159"></a>00159             ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#add9f80fe9fe6ba1d7571c14a6ace6f3b" title="Call just after the first step of velocity-Verlet algorithm.">postIntegrate1</a>(iStep);
<a name="l00160"></a>00160          } 
<a name="l00161"></a>00161       }
<a name="l00162"></a>00162    }
<a name="l00163"></a>00163  
<a name="l00164"></a><a class="code" href="classDdMd_1_1ModifierManager.html#af4b310031ccd6a440ab633c4534438ab">00164</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#af4b310031ccd6a440ab633c4534438ab" title="Call on exchange steps before transforming to scaled coordinates.">ModifierManager::preTransform</a>(<span class="keywordtype">long</span> iStep)
<a name="l00165"></a>00165    {
<a name="l00166"></a>00166       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00167"></a>00167       <span class="keywordtype">int</span> n = preTransformModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00168"></a>00168       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00169"></a>00169          ptr = &amp;preTransformModifiers_[i];
<a name="l00170"></a>00170          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a6a44259d2652b7da08a50a5e2d161c94" title="Return true iff iStep is a multiple of the interval.">isAtInterval</a>(iStep)) {
<a name="l00171"></a>00171             ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a08264b6be3ace3281592c3dbc97a5593" title="Call on exchange steps before transforming to scaled atomic coordinates.">preTransform</a>(iStep);
<a name="l00172"></a>00172          }
<a name="l00173"></a>00173       }
<a name="l00174"></a>00174    }
<a name="l00175"></a>00175  
<a name="l00176"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a5d336bbc1d01cb76e7838621b2ad35a7">00176</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#a5d336bbc1d01cb76e7838621b2ad35a7" title="Call on exchange steps after transforming, before exchanging.">ModifierManager::preExchange</a>(<span class="keywordtype">long</span> iStep)
<a name="l00177"></a>00177    {
<a name="l00178"></a>00178       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00179"></a>00179       <span class="keywordtype">int</span> n = preExchangeModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00180"></a>00180       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00181"></a>00181          ptr = &amp;preExchangeModifiers_[i];
<a name="l00182"></a>00182          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a6a44259d2652b7da08a50a5e2d161c94" title="Return true iff iStep is a multiple of the interval.">isAtInterval</a>(iStep)) {
<a name="l00183"></a>00183             ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#ad07ba52e309b93db8cc3018f2f54b330" title="Call on exchange steps after transforming but before exchanging atoms.">preExchange</a>(iStep);
<a name="l00184"></a>00184          }
<a name="l00185"></a>00185       }
<a name="l00186"></a>00186    }
<a name="l00187"></a>00187  
<a name="l00188"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a3f6be73e9473c9424c101af09c96b9f6">00188</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#a3f6be73e9473c9424c101af09c96b9f6" title="Call on exchange steps after atom exchange, before reneighboring.">ModifierManager::postExchange</a>(<span class="keywordtype">long</span> iStep)
<a name="l00189"></a>00189    {
<a name="l00190"></a>00190       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00191"></a>00191       <span class="keywordtype">int</span> n = postExchangeModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00192"></a>00192       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00193"></a>00193          ptr = &amp;postExchangeModifiers_[i];
<a name="l00194"></a>00194          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a6a44259d2652b7da08a50a5e2d161c94" title="Return true iff iStep is a multiple of the interval.">isAtInterval</a>(iStep)) {
<a name="l00195"></a>00195             ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a712d2b2e70cc23268a942216199dbd0e" title="Call on exchange steps right after atom exchange, but before reneighboring.">postExchange</a>(iStep);
<a name="l00196"></a>00196          }
<a name="l00197"></a>00197       }
<a name="l00198"></a>00198    }
<a name="l00199"></a>00199  
<a name="l00200"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a122a77482e07a375de33dfca2fc00557">00200</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#a122a77482e07a375de33dfca2fc00557" title="Call on exchange steps after re-building the neighbor list.">ModifierManager::postNeighbor</a>(<span class="keywordtype">long</span> iStep)
<a name="l00201"></a>00201    {
<a name="l00202"></a>00202       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00203"></a>00203       <span class="keywordtype">int</span> n = postNeighborModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00204"></a>00204       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00205"></a>00205          ptr = &amp;postNeighborModifiers_[i];
<a name="l00206"></a>00206          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a6a44259d2652b7da08a50a5e2d161c94" title="Return true iff iStep is a multiple of the interval.">isAtInterval</a>(iStep)) {
<a name="l00207"></a>00207             ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a54f85e90cbb33c415f1ee11188caa169" title="Call on exchange steps after re-building neighbor list (reneighboring).">postNeighbor</a>(iStep);
<a name="l00208"></a>00208          }
<a name="l00209"></a>00209       }
<a name="l00210"></a>00210    }
<a name="l00211"></a>00211  
<a name="l00212"></a><a class="code" href="classDdMd_1_1ModifierManager.html#af350a9031f690b381a330197ed3f6f8d">00212</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#af350a9031f690b381a330197ed3f6f8d" title="Call on update steps before updating ghost positions.">ModifierManager::preUpdate</a>(<span class="keywordtype">long</span> iStep)
<a name="l00213"></a>00213    {
<a name="l00214"></a>00214       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00215"></a>00215       <span class="keywordtype">int</span> n = preUpdateModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00216"></a>00216       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00217"></a>00217          ptr = &amp;preUpdateModifiers_[i];
<a name="l00218"></a>00218          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a6a44259d2652b7da08a50a5e2d161c94" title="Return true iff iStep is a multiple of the interval.">isAtInterval</a>(iStep)) {
<a name="l00219"></a>00219             ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a1946d36285aceb25546c2ebbd88ce48b" title="Call on update steps before updating ghost positions.">preUpdate</a>(iStep);
<a name="l00220"></a>00220          }
<a name="l00221"></a>00221       }
<a name="l00222"></a>00222    }
<a name="l00223"></a>00223  
<a name="l00224"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a08e0e8a8baea723d1f9107664464a984">00224</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#a08e0e8a8baea723d1f9107664464a984" title="Call on update steps after updating ghost positions.">ModifierManager::postUpdate</a>(<span class="keywordtype">long</span> iStep)
<a name="l00225"></a>00225    {
<a name="l00226"></a>00226       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00227"></a>00227       <span class="keywordtype">int</span> n = postUpdateModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00228"></a>00228       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00229"></a>00229          ptr = &amp;postUpdateModifiers_[i];
<a name="l00230"></a>00230          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a6a44259d2652b7da08a50a5e2d161c94" title="Return true iff iStep is a multiple of the interval.">isAtInterval</a>(iStep)) {
<a name="l00231"></a>00231             ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#acccc7ed8f6c2a4c13fdb85aa2113389c" title="Call on update steps after updating ghost positions.">postUpdate</a>(iStep);
<a name="l00232"></a>00232          }
<a name="l00233"></a>00233       }
<a name="l00234"></a>00234    }
<a name="l00235"></a>00235  
<a name="l00236"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a94449bcfb5c40e96c637b193f2f69a70">00236</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#a94449bcfb5c40e96c637b193f2f69a70" title="Call after updating but before calculating forces.">ModifierManager::preForce</a>(<span class="keywordtype">long</span> iStep)
<a name="l00237"></a>00237    {
<a name="l00238"></a>00238       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00239"></a>00239       <span class="keywordtype">int</span> n = preForceModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00240"></a>00240       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00241"></a>00241          ptr = &amp;preForceModifiers_[i];
<a name="l00242"></a>00242          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a6a44259d2652b7da08a50a5e2d161c94" title="Return true iff iStep is a multiple of the interval.">isAtInterval</a>(iStep)) {
<a name="l00243"></a>00243             ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a1b796d9d8ce4a6f2d2d09216e1cd7227" title="Call after updating but before calculating forces.">preForce</a>(iStep);
<a name="l00244"></a>00244          }
<a name="l00245"></a>00245       }
<a name="l00246"></a>00246    }
<a name="l00247"></a>00247  
<a name="l00248"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a77f6cee4d1c3c2ddd01e6e6298d3cd0a">00248</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#a77f6cee4d1c3c2ddd01e6e6298d3cd0a" title="Call after calculating forces.">ModifierManager::postForce</a>(<span class="keywordtype">long</span> iStep)
<a name="l00249"></a>00249    {
<a name="l00250"></a>00250       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00251"></a>00251       <span class="keywordtype">int</span> n = postForceModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00252"></a>00252       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00253"></a>00253          ptr = &amp;postForceModifiers_[i];
<a name="l00254"></a>00254          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a6a44259d2652b7da08a50a5e2d161c94" title="Return true iff iStep is a multiple of the interval.">isAtInterval</a>(iStep)) {
<a name="l00255"></a>00255             ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#aa38e03e0d23130118a4b6ccdce29d036" title="Call after calculating forces.">postForce</a>(iStep);
<a name="l00256"></a>00256          }
<a name="l00257"></a>00257       }
<a name="l00258"></a>00258    }
<a name="l00259"></a>00259  
<a name="l00260"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a39c5648bc389bfe86debb9b6dca18754">00260</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#a39c5648bc389bfe86debb9b6dca18754" title="Call after 2nd integration step, at end of the time step.">ModifierManager::endOfStep</a>(<span class="keywordtype">long</span> iStep)
<a name="l00261"></a>00261    {
<a name="l00262"></a>00262       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00263"></a>00263       <span class="keywordtype">int</span> n = endOfStepModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00264"></a>00264       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00265"></a>00265          ptr = &amp;endOfStepModifiers_[i];
<a name="l00266"></a>00266          <span class="keywordflow">if</span> (ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a6a44259d2652b7da08a50a5e2d161c94" title="Return true iff iStep is a multiple of the interval.">isAtInterval</a>(iStep)) {
<a name="l00267"></a>00267             ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a696dd215013562ddfc66aa1c934a0f47" title="Call at the end of the time step.">endOfStep</a>(iStep);
<a name="l00268"></a>00268          }
<a name="l00269"></a>00269       }
<a name="l00270"></a>00270    }
<a name="l00271"></a>00271 
<a name="l00272"></a>00272    <span class="comment">// Communication</span>
<a name="l00273"></a>00273 
<a name="l00274"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a1fcae771324e53c26cd77f19cd446b15">00274</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#a1fcae771324e53c26cd77f19cd446b15" title="Pack data into buffer used to exchange atoms.">ModifierManager::packExchange</a>(<span class="keywordtype">long</span> iStep)
<a name="l00275"></a>00275    {
<a name="l00276"></a>00276       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00277"></a>00277       <span class="keywordtype">int</span> n = exchangeModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00278"></a>00278       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00279"></a>00279          ptr = &amp;exchangeModifiers_[i];
<a name="l00280"></a>00280          ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a40e3b28db9251d4726310cef5a861c2d" title="Pack data into buffer used to exchange atoms.">packExchange</a>();
<a name="l00281"></a>00281       }
<a name="l00282"></a>00282    }
<a name="l00283"></a>00283  
<a name="l00284"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a618ebb486ad5155571673ca5b8dac385">00284</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#a618ebb486ad5155571673ca5b8dac385" title="Unpack data from buffer used to exchange atoms.">ModifierManager::unpackExchange</a>(<span class="keywordtype">long</span> iStep)
<a name="l00285"></a>00285    {
<a name="l00286"></a>00286       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00287"></a>00287       <span class="keywordtype">int</span> n = exchangeModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00288"></a>00288       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00289"></a>00289          ptr = &amp;exchangeModifiers_[i];
<a name="l00290"></a>00290          ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a68715c6fddd38a9acea75ed3722a2528" title="Unpack data from buffer used to exchange atoms.">unpackExchange</a>();
<a name="l00291"></a>00291       }
<a name="l00292"></a>00292    }
<a name="l00293"></a>00293  
<a name="l00294"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a8eafee6e225e5d81ede65682c7742674">00294</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#a8eafee6e225e5d81ede65682c7742674" title="Pack data into buffer used to update ghost positions.">ModifierManager::packUpdate</a>(<span class="keywordtype">long</span> iStep)
<a name="l00295"></a>00295    {
<a name="l00296"></a>00296       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00297"></a>00297       <span class="keywordtype">int</span> n = updateModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00298"></a>00298       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00299"></a>00299          ptr = &amp;updateModifiers_[i];
<a name="l00300"></a>00300          ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#af2edeced53a287121cb7c95f04d53e69" title="Pack data into buffer used to update ghost positions.">packUpdate</a>();
<a name="l00301"></a>00301       }
<a name="l00302"></a>00302    }
<a name="l00303"></a>00303  
<a name="l00304"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a5ee222c74738d7a317ad27d74555a6ff">00304</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#a5ee222c74738d7a317ad27d74555a6ff" title="Unpack data from buffer used to update ghost positions.">ModifierManager::unpackUpdate</a>(<span class="keywordtype">long</span> iStep)
<a name="l00305"></a>00305    {
<a name="l00306"></a>00306       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00307"></a>00307       <span class="keywordtype">int</span> n = updateModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00308"></a>00308       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00309"></a>00309          ptr = &amp;updateModifiers_[i];
<a name="l00310"></a>00310          ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a784c125ef4b99f7f9885639bb9290049" title="Unpack data from buffer used to update ghost positions.">unpackUpdate</a>();
<a name="l00311"></a>00311       }
<a name="l00312"></a>00312    }
<a name="l00313"></a>00313 
<a name="l00314"></a><a class="code" href="classDdMd_1_1ModifierManager.html#ac8c49d9070abd0e561346c34d69904c9">00314</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#ac8c49d9070abd0e561346c34d69904c9" title="Pack data into buffer used to reverse update forces.">ModifierManager::packReverseUpdate</a>(<span class="keywordtype">long</span> iStep)
<a name="l00315"></a>00315    {
<a name="l00316"></a>00316       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00317"></a>00317       <span class="keywordtype">int</span> n = reverseUpdateModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00318"></a>00318       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00319"></a>00319          ptr = &amp;reverseUpdateModifiers_[i];
<a name="l00320"></a>00320          ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#ab86562215398c06774f26d11d945cb40" title="Pack data into buffer used to reverse update forces.">packReverseUpdate</a>();
<a name="l00321"></a>00321       }
<a name="l00322"></a>00322    }
<a name="l00323"></a>00323  
<a name="l00324"></a><a class="code" href="classDdMd_1_1ModifierManager.html#ad6dc60e3392d4e01803161d1c37f4159">00324</a>    <span class="keywordtype">void</span> <a class="code" href="classDdMd_1_1ModifierManager.html#ad6dc60e3392d4e01803161d1c37f4159" title="Unpack data from the buffer used to reverse update forces.">ModifierManager::unpackReverseUpdate</a>(<span class="keywordtype">long</span> iStep)
<a name="l00325"></a>00325    {
<a name="l00326"></a>00326       <a class="code" href="classDdMd_1_1Modifier.html" title="A Modifier can modify the time evolution of the simulation.">Modifier</a>* ptr;
<a name="l00327"></a>00327       <span class="keywordtype">int</span> n = reverseUpdateModifiers_.<a class="code" href="classUtil_1_1PArray.html#a94498ac5aa7b6398c381f5101fb64f38" title="Return logical size.">size</a>();
<a name="l00328"></a>00328       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {
<a name="l00329"></a>00329          ptr = &amp;reverseUpdateModifiers_[i];
<a name="l00330"></a>00330          ptr-&gt;<a class="code" href="classDdMd_1_1Modifier.html#a52e6408736c81a9e2d9a907b2aa5420d" title="Unpack data from the buffer used to reverse update forces.">unpackReverseUpdate</a>();
<a name="l00331"></a>00331       }
<a name="l00332"></a>00332    }
<a name="l00333"></a>00333 
<a name="l00334"></a>00334    <span class="comment">/*</span>
<a name="l00335"></a>00335 <span class="comment">   * Return pointer to default Modifier factory.</span>
<a name="l00336"></a>00336 <span class="comment">   */</span>
<a name="l00337"></a><a class="code" href="classDdMd_1_1ModifierManager.html#a647f81b50e79edd37b0ed1d15fa0db5f">00337</a>    <a class="code" href="classUtil_1_1Factory.html">Factory&lt;Modifier&gt;</a>* <a class="code" href="classDdMd_1_1ModifierManager.html#a647f81b50e79edd37b0ed1d15fa0db5f" title="Return pointer to a new default factory.">ModifierManager::newDefaultFactory</a>()<span class="keyword"> const</span>
<a name="l00338"></a>00338 <span class="keyword">   </span>{  <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classDdMd_1_1ModifierFactory.html" title="Factory for DdMd::Modifier objects.">ModifierFactory</a>(*simulationPtr_); }
<a name="l00339"></a>00339  
<a name="l00340"></a>00340 }
</pre></div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.3-->
<!-- start footer part -->


<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 1 2014 21:58:09 for Simpatico by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
