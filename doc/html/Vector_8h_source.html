<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Simpatico: Vector.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simpatico&#160;<span id="projectnumber">v0.8</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_1f5833e5a6ae4f3b158cdaf1cc06a4a1.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_1ac4cd60fc166a1e0eba5ea680be1316.html">util</a>      </li>
      <li class="navelem"><a class="el" href="dir_9bdcc34736af3a5ce12f5e9ba9bae099.html">space</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Vector.h</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef VECTOR_H</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define VECTOR_H</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="comment">/*</span>
<a name="l00005"></a>00005 <span class="comment">* Simpatico - Simulation Package for Polymeric and Molecular Liquids</span>
<a name="l00006"></a>00006 <span class="comment">*</span>
<a name="l00007"></a>00007 <span class="comment">* Copyright 2010, David Morse (morse@cems.umn.edu)</span>
<a name="l00008"></a>00008 <span class="comment">* Distributed under the terms of the GNU General Public License.</span>
<a name="l00009"></a>00009 <span class="comment">*/</span>
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;util/space/Dimension.h&gt;</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#ifdef UTIL_MPI</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span><span class="preprocessor">#include &lt;util/mpi/MpiTraits.h&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#endif</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="keyword">namespace </span>Util
<a name="l00021"></a>00021 {
<a name="l00022"></a>00022 
<a name="l00074"></a><a class="code" href="classUtil_1_1Vector.html">00074</a>    <span class="keyword">class </span><a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>
<a name="l00075"></a>00075    {
<a name="l00076"></a>00076 
<a name="l00077"></a>00077    <span class="keyword">public</span>:
<a name="l00078"></a>00078 
<a name="l00080"></a>00080 
<a name="l00081"></a>00081       
<a name="l00085"></a>00085       <a class="code" href="classUtil_1_1Vector.html#a4df026156780bc0ca651c342b7d6daa4" title="Default constructor.">Vector</a>();
<a name="l00086"></a>00086 
<a name="l00090"></a>00090       <a class="code" href="classUtil_1_1Vector.html#a4df026156780bc0ca651c342b7d6daa4" title="Default constructor.">Vector</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v);
<a name="l00091"></a>00091 
<a name="l00097"></a>00097       <span class="keyword">explicit</span> <a class="code" href="classUtil_1_1Vector.html#a4df026156780bc0ca651c342b7d6daa4" title="Default constructor.">Vector</a>(<span class="keywordtype">double</span> scalar);
<a name="l00098"></a>00098 
<a name="l00104"></a>00104       <span class="keyword">explicit</span> <a class="code" href="classUtil_1_1Vector.html#a4df026156780bc0ca651c342b7d6daa4" title="Default constructor.">Vector</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>* v);
<a name="l00105"></a>00105 
<a name="l00113"></a>00113       <a class="code" href="classUtil_1_1Vector.html#a4df026156780bc0ca651c342b7d6daa4" title="Default constructor.">Vector</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z=0.0);
<a name="l00114"></a>00114 
<a name="l00116"></a>00116       
<a name="l00120"></a>00120       <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#ad9d471a74fb7cd01b0c3ab87309cfbef" title="Set all elements of a 3D vector to zero.">zero</a>();
<a name="l00121"></a>00121 
<a name="l00130"></a>00130       <span class="keyword">template</span> &lt;<span class="keyword">class</span> Archive&gt;
<a name="l00131"></a>00131       <span class="keywordtype">void</span> <a class="code" href="classUtil_1_1Vector.html#a6765e839ab267e4959384e35a4112451" title="Serialize to/from an archive.">serialize</a>(Archive&amp; ar, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> version);
<a name="l00132"></a>00132 
<a name="l00134"></a>00134 
<a name="l00135"></a>00135       
<a name="l00141"></a>00141       <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#a6b0640fd4a7fe0c028f82b099643e5f8" title="Copy assignment.">operator=</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v);
<a name="l00142"></a>00142 
<a name="l00148"></a>00148       <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#a6b0640fd4a7fe0c028f82b099643e5f8" title="Copy assignment.">operator=</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>* v);
<a name="l00149"></a>00149 
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 
<a name="l00153"></a>00153       
<a name="l00161"></a>00161       <span class="keywordtype">void</span> <a class="code" href="classUtil_1_1Vector.html#aa5beaa0144bb71199169a37c9fc20834" title="Add vector dv to this vector.">operator+=</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; dv);
<a name="l00162"></a>00162 
<a name="l00170"></a>00170       <span class="keywordtype">void</span> <a class="code" href="classUtil_1_1Vector.html#aa6dddacebf727e19cf8e77ad2947d52c" title="Subtract vector dv from this vector.">operator-=</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; dv);
<a name="l00171"></a>00171 
<a name="l00179"></a>00179       <span class="keywordtype">void</span> <a class="code" href="classUtil_1_1Vector.html#a2973f1e626cbfbf2345118fafbdac72c" title="Multiply this vector by scalar s.">operator*=</a>(<span class="keywordtype">double</span> s);
<a name="l00180"></a>00180 
<a name="l00188"></a>00188       <span class="keywordtype">void</span> <a class="code" href="classUtil_1_1Vector.html#ab2252222282d488c4210df0bc99f68b4" title="Divide this vector by scalar s.">operator/=</a>(<span class="keywordtype">double</span> s);
<a name="l00189"></a>00189 
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 
<a name="l00193"></a>00193       
<a name="l00200"></a>00200       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="classUtil_1_1Vector.html#a3228e6aa76fb6d9ed773ddde4725aed5" title="Return one Cartesian element by value.">operator[]</a>(<span class="keywordtype">int</span> i) <span class="keyword">const</span>;
<a name="l00201"></a>00201 
<a name="l00208"></a>00208       <span class="keywordtype">double</span>&amp; <a class="code" href="classUtil_1_1Vector.html#a3228e6aa76fb6d9ed773ddde4725aed5" title="Return one Cartesian element by value.">operator[]</a>(<span class="keywordtype">int</span> i);
<a name="l00209"></a>00209 
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 
<a name="l00213"></a>00213       
<a name="l00219"></a>00219       <span class="keywordtype">double</span> <a class="code" href="classUtil_1_1Vector.html#ac8e155d7aa8c019159787bd6ac797559" title="Return square magnitude of this vector.">square</a>() <span class="keyword">const</span>;
<a name="l00220"></a>00220 
<a name="l00226"></a>00226       <span class="keywordtype">double</span> <a class="code" href="classUtil_1_1Vector.html#a8eccd53c4cb659df8fff6d41ae058752" title="Return absolute magnitude of this vector.">abs</a>() <span class="keyword">const</span>;
<a name="l00227"></a>00227 
<a name="l00234"></a>00234       <span class="keywordtype">double</span> <a class="code" href="classUtil_1_1Vector.html#a5431123ac320a0ed069d9c7a30702c7b" title="Return dot product of this vector and vector v.">dot</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v) <span class="keyword">const</span>;
<a name="l00235"></a>00235 
<a name="l00242"></a>00242       <span class="keywordtype">double</span> <a class="code" href="classUtil_1_1Vector.html#acd1887e9de7debda9916bc9b00cf2cfb" title="Return projection of this vector along vector p.">projection</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; p) <span class="keyword">const</span>;
<a name="l00243"></a>00243 
<a name="l00245"></a>00245 
<a name="l00246"></a>00246 
<a name="l00247"></a>00247       
<a name="l00256"></a>00256       <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#aebaf961fa5120510548d94987edbcc0f" title="Add vectors v1 and v2.">add</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v1, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v2);
<a name="l00257"></a>00257 
<a name="l00267"></a>00267       <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#a1d7c5b73ae56a7ad991a6c54517698c2" title="Subtract vector v2 from v1.">subtract</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v1, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v2);
<a name="l00268"></a>00268 
<a name="l00278"></a>00278       <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#a93125fcca5b3af76a88698903291bcbd" title="Multiply a vector v by a scalar s.">multiply</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v, <span class="keywordtype">double</span> s);
<a name="l00279"></a>00279 
<a name="l00289"></a>00289       <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#ac80181cd4feb853a58138081a03cb030" title="Divide vector v by scalar s.">divide</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v, <span class="keywordtype">double</span> s);
<a name="l00290"></a>00290 
<a name="l00300"></a>00300       <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#acfbcd7ced2dcefafe5ee5ceb26fd4b00" title="Calculate cross product of vectors v1 and v2.">cross</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v1, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v2);
<a name="l00301"></a>00301 
<a name="l00310"></a>00310       <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#ad0f5aa1053c8260f14d39aa7e8543033" title="Calculate unit vector parallel to input vector v.">versor</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v);
<a name="l00311"></a>00311 
<a name="l00325"></a>00325       <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#a2adeea6369465539266a632251f2e550" title="Calculate component of vector v parallel to vector p.">parallel</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; p);
<a name="l00326"></a>00326 
<a name="l00337"></a>00337       <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#ac10612d4ef7728740e93625c6cfcf8fd" title="Calculate component of vector v transverse to vector p.">transverse</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; p);
<a name="l00338"></a>00338 
<a name="l00340"></a>00340 
<a name="l00341"></a>00341 
<a name="l00342"></a>00342      
<a name="l00346"></a>00346       <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classUtil_1_1Vector.html#a608e10d093425c9228f10ed3c4994598" title="Initialize Zero Vector.">initStatic</a>();
<a name="l00347"></a>00347 
<a name="l00349"></a><a class="code" href="classUtil_1_1Vector.html#a9295b4b42a83e7087e7eb10e4a65fa5d">00349</a>       <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a> <a class="code" href="classUtil_1_1Vector.html#a9295b4b42a83e7087e7eb10e4a65fa5d" title="Zero Vector = {0.0, 0.0, 0.0}.">Zero</a>;
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 <span class="preprocessor">      #ifdef UTIL_MPI</span>
<a name="l00352"></a>00352 <span class="preprocessor"></span>
<a name="l00355"></a>00355       <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classUtil_1_1Vector.html#a8170d98ea8b055e49ef256d15cfbc5af" title="Commit MPI datatype MpiTraits&amp;lt;Vector&amp;gt;::type.">commitMpiType</a>();
<a name="l00356"></a>00356 <span class="preprocessor">      #endif</span>
<a name="l00357"></a>00357 <span class="preprocessor"></span>
<a name="l00359"></a>00359 
<a name="l00360"></a>00360    <span class="keyword">private</span>:
<a name="l00361"></a>00361 
<a name="l00363"></a>00363       <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> Width = 25;
<a name="l00364"></a>00364 
<a name="l00366"></a>00366       <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> Precision = 17;
<a name="l00367"></a>00367 
<a name="l00369"></a>00369       <span class="keywordtype">double</span> elem_[<a class="code" href="group__Space__Module.html#ga727ca0103c14a6e65aede427fd58a2a7" title="Dimensionality of space.">Dimension</a>];
<a name="l00370"></a>00370 
<a name="l00371"></a>00371    <span class="comment">//friends:</span>
<a name="l00372"></a>00372 
<a name="l00373"></a>00373       <span class="keyword">friend</span> <span class="keywordtype">bool</span> <a class="code" href="classUtil_1_1Vector.html#a7910afb9c9dbb82f155e980c6eba1538" title="Equality for Vectors.">operator == </a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v1, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v2);
<a name="l00374"></a>00374 
<a name="l00375"></a>00375       <span class="keyword">friend</span> <span class="keywordtype">bool</span> <a class="code" href="classUtil_1_1Vector.html#a7910afb9c9dbb82f155e980c6eba1538" title="Equality for Vectors.">operator == </a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v1, <span class="keyword">const</span> <span class="keywordtype">double</span>* v2);
<a name="l00376"></a>00376 
<a name="l00377"></a>00377       <span class="keyword">friend</span> std::istream&amp; <a class="code" href="classUtil_1_1Vector.html#a010b803aa828265fbea4ea76c25b02b2" title="istream extractor for a Vector.">operator &gt;&gt; </a>(std::istream&amp; in, <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a> &amp;vector);
<a name="l00378"></a>00378 
<a name="l00379"></a>00379       <span class="keyword">friend</span> std::ostream&amp; <a class="code" href="classUtil_1_1Vector.html#ae295e87eb813266c27e75d2809df2acc" title="ostream inserter for a Vector.">operator &lt;&lt; </a>(std::ostream&amp; out, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a> &amp;vector);
<a name="l00380"></a>00380 
<a name="l00381"></a>00381    };
<a name="l00382"></a>00382 
<a name="l00384"></a>00384    <span class="keywordtype">bool</span> <a class="code" href="namespaceUtil.html#a00539479fc6b2c7dda82313bc6e53e92" title="Are two PointSymmetry objects equivalent?">operator == </a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v1, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v2);
<a name="l00385"></a>00385 
<a name="l00387"></a>00387    <span class="keywordtype">bool</span> <a class="code" href="namespaceUtil.html#a00539479fc6b2c7dda82313bc6e53e92" title="Are two PointSymmetry objects equivalent?">operator == </a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v1, <span class="keyword">const</span> <span class="keywordtype">double</span>* v2);
<a name="l00388"></a>00388 
<a name="l00390"></a>00390    <span class="keywordtype">bool</span> <a class="code" href="namespaceUtil.html#a00539479fc6b2c7dda82313bc6e53e92" title="Are two PointSymmetry objects equivalent?">operator == </a>(<span class="keyword">const</span> <span class="keywordtype">double</span>* v1, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v2);
<a name="l00391"></a>00391 
<a name="l00393"></a>00393    <span class="keywordtype">bool</span> <a class="code" href="namespaceUtil.html#ad53616d4d38159bc63d98dadfd008f8d" title="Are two PointSymmetry objects not equivalent?">operator != </a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v1, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v2);
<a name="l00394"></a>00394 
<a name="l00396"></a>00396    <span class="keywordtype">bool</span> <a class="code" href="namespaceUtil.html#ad53616d4d38159bc63d98dadfd008f8d" title="Are two PointSymmetry objects not equivalent?">operator != </a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v1, <span class="keyword">const</span> <span class="keywordtype">double</span>* v2);
<a name="l00397"></a>00397 
<a name="l00399"></a>00399    <span class="keywordtype">bool</span> <a class="code" href="namespaceUtil.html#ad53616d4d38159bc63d98dadfd008f8d" title="Are two PointSymmetry objects not equivalent?">operator != </a>(<span class="keyword">const</span> <span class="keywordtype">double</span>* v1, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v2);
<a name="l00400"></a>00400 
<a name="l00410"></a>00410    std::istream&amp; <a class="code" href="namespaceUtil.html#a993c7220c84aadae4eb1085cef083e74" title="istream extractor for a OrthorhombicBoundary.">operator &gt;&gt; </a>(std::istream&amp; in, <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a> &amp;vector);
<a name="l00411"></a>00411 
<a name="l00420"></a>00420    std::ostream&amp; <a class="code" href="namespaceUtil.html#a7a94bc3185d3be0028eacd3076edb6d3" title="ostream inserter for an OrthorhombicBoundary.">operator &lt;&lt; </a>(std::ostream&amp; out, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a> &amp;vector);
<a name="l00421"></a>00421 
<a name="l00422"></a>00422 <span class="preprocessor">   #ifdef UTIL_MPI</span>
<a name="l00423"></a>00423 <span class="preprocessor"></span>
<a name="l00427"></a>00427    <span class="keyword">template</span> &lt;&gt;
<a name="l00428"></a><a class="code" href="classUtil_1_1MpiTraits_3_01Vector_01_4.html">00428</a>    <span class="keyword">class </span><a class="code" href="classUtil_1_1MpiTraits.html" title="Default MpiTraits class.">MpiTraits</a>&lt;<a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&gt;
<a name="l00429"></a>00429    {  
<a name="l00430"></a>00430    <span class="keyword">public</span>:  
<a name="l00431"></a><a class="code" href="classUtil_1_1MpiTraits_3_01Vector_01_4.html#a94a4825c5b6a741265d65e260050cfce">00431</a>       <span class="keyword">static</span> MPI::Datatype <a class="code" href="classUtil_1_1MpiTraits_3_01Vector_01_4.html#a94a4825c5b6a741265d65e260050cfce" title="MPI Datatype.">type</a>;   
<a name="l00432"></a><a class="code" href="classUtil_1_1MpiTraits_3_01Vector_01_4.html#a62a39495a18407e8f4251ff3e60c1b5a">00432</a>       <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classUtil_1_1MpiTraits_3_01Vector_01_4.html#a62a39495a18407e8f4251ff3e60c1b5a" title="Is the MPI type initialized?">hasType</a>;         
<a name="l00433"></a>00433    };
<a name="l00434"></a>00434 
<a name="l00435"></a>00435 <span class="preprocessor">   #endif</span>
<a name="l00436"></a>00436 <span class="preprocessor"></span>
<a name="l00437"></a>00437    <span class="comment">// Inline methods</span>
<a name="l00438"></a>00438 
<a name="l00439"></a>00439    <span class="comment">/*</span>
<a name="l00440"></a>00440 <span class="comment">   * Default constructor</span>
<a name="l00441"></a>00441 <span class="comment">   */</span>
<a name="l00442"></a>00442    <span class="keyword">inline</span>
<a name="l00443"></a><a class="code" href="classUtil_1_1Vector.html#a4df026156780bc0ca651c342b7d6daa4">00443</a>    <a class="code" href="classUtil_1_1Vector.html#a4df026156780bc0ca651c342b7d6daa4" title="Default constructor.">Vector::Vector</a>()
<a name="l00444"></a>00444    {}
<a name="l00445"></a>00445 
<a name="l00446"></a>00446    <span class="comment">/*</span>
<a name="l00447"></a>00447 <span class="comment">   * Copy constructor</span>
<a name="l00448"></a>00448 <span class="comment">   */</span>
<a name="l00449"></a>00449    <span class="keyword">inline</span>
<a name="l00450"></a><a class="code" href="classUtil_1_1Vector.html#a75b374531b6b2c229c630a07324acca8">00450</a>    <a class="code" href="classUtil_1_1Vector.html#a4df026156780bc0ca651c342b7d6daa4" title="Default constructor.">Vector::Vector</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v)
<a name="l00451"></a>00451    {
<a name="l00452"></a>00452       elem_[0] = v.elem_[0];
<a name="l00453"></a>00453       elem_[1] = v.elem_[1];
<a name="l00454"></a>00454       elem_[2] = v.elem_[2];
<a name="l00455"></a>00455    }
<a name="l00456"></a>00456 
<a name="l00457"></a>00457    <span class="comment">/*</span>
<a name="l00458"></a>00458 <span class="comment">   * Constructor, initialize all elements to a scalar value.</span>
<a name="l00459"></a>00459 <span class="comment">   */</span>
<a name="l00460"></a>00460    <span class="keyword">inline</span>
<a name="l00461"></a><a class="code" href="classUtil_1_1Vector.html#a205fab513a99c65fb5192d1068c80995">00461</a>    <a class="code" href="classUtil_1_1Vector.html#a4df026156780bc0ca651c342b7d6daa4" title="Default constructor.">Vector::Vector</a>(<span class="keywordtype">double</span> scalar)
<a name="l00462"></a>00462    {
<a name="l00463"></a>00463       elem_[0] = scalar;
<a name="l00464"></a>00464       elem_[1] = scalar;
<a name="l00465"></a>00465       elem_[2] = scalar;
<a name="l00466"></a>00466    }
<a name="l00467"></a>00467 
<a name="l00468"></a>00468    <span class="comment">/*</span>
<a name="l00469"></a>00469 <span class="comment">   * Construct Vector from C double[3] array.</span>
<a name="l00470"></a>00470 <span class="comment">   */</span>
<a name="l00471"></a>00471    <span class="keyword">inline</span>
<a name="l00472"></a><a class="code" href="classUtil_1_1Vector.html#a9d799207ae4f33bfc2bbbbd8d33ac3f3">00472</a>    <a class="code" href="classUtil_1_1Vector.html#a4df026156780bc0ca651c342b7d6daa4" title="Default constructor.">Vector::Vector</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>* v)
<a name="l00473"></a>00473    {
<a name="l00474"></a>00474       elem_[0] = v[0];
<a name="l00475"></a>00475       elem_[1] = v[1];
<a name="l00476"></a>00476       elem_[2] = v[2];
<a name="l00477"></a>00477    }
<a name="l00478"></a>00478 
<a name="l00479"></a>00479    <span class="comment">/*</span>
<a name="l00480"></a>00480 <span class="comment">   * Construct Vector from its coordinates.</span>
<a name="l00481"></a>00481 <span class="comment">   */</span>
<a name="l00482"></a>00482    <span class="keyword">inline</span>
<a name="l00483"></a><a class="code" href="classUtil_1_1Vector.html#ac2108e4db177c89e4d18f0894a197619">00483</a>    <a class="code" href="classUtil_1_1Vector.html#a4df026156780bc0ca651c342b7d6daa4" title="Default constructor.">Vector::Vector</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z)
<a name="l00484"></a>00484    {
<a name="l00485"></a>00485       elem_[0] = x;
<a name="l00486"></a>00486       elem_[1] = y;
<a name="l00487"></a>00487       elem_[2] = z;
<a name="l00488"></a>00488    }
<a name="l00489"></a>00489 
<a name="l00490"></a>00490    <span class="comment">/*</span>
<a name="l00491"></a>00491 <span class="comment">   * Set all elements of a 3D vector to zero.</span>
<a name="l00492"></a>00492 <span class="comment">   */</span>
<a name="l00493"></a>00493    <span class="keyword">inline</span>
<a name="l00494"></a><a class="code" href="classUtil_1_1Vector.html#ad9d471a74fb7cd01b0c3ab87309cfbef">00494</a>    <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#ad9d471a74fb7cd01b0c3ab87309cfbef" title="Set all elements of a 3D vector to zero.">Vector::zero</a>()
<a name="l00495"></a>00495    {
<a name="l00496"></a>00496       elem_[0] = 0.0;
<a name="l00497"></a>00497       elem_[1] = 0.0;
<a name="l00498"></a>00498       elem_[2] = 0.0;
<a name="l00499"></a>00499       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00500"></a>00500    }
<a name="l00501"></a>00501 
<a name="l00502"></a>00502    <span class="comment">/*</span>
<a name="l00503"></a>00503 <span class="comment">   * Assignment.</span>
<a name="l00504"></a>00504 <span class="comment">   */</span>
<a name="l00505"></a>00505    <span class="keyword">inline</span>
<a name="l00506"></a><a class="code" href="classUtil_1_1Vector.html#a6b0640fd4a7fe0c028f82b099643e5f8">00506</a>    <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#a6b0640fd4a7fe0c028f82b099643e5f8" title="Copy assignment.">Vector::operator=</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v)
<a name="l00507"></a>00507    {
<a name="l00508"></a>00508       elem_[0] = v.elem_[0];
<a name="l00509"></a>00509       elem_[1] = v.elem_[1];
<a name="l00510"></a>00510       elem_[2] = v.elem_[2];
<a name="l00511"></a>00511       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00512"></a>00512    }
<a name="l00513"></a>00513 
<a name="l00514"></a>00514    <span class="comment">/*</span>
<a name="l00515"></a>00515 <span class="comment">   * Assignment from C double[] array.</span>
<a name="l00516"></a>00516 <span class="comment">   */</span>
<a name="l00517"></a>00517    <span class="keyword">inline</span>
<a name="l00518"></a><a class="code" href="classUtil_1_1Vector.html#af0b15d8ae7ec4f96d0760f259fb3735b">00518</a>    <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#a6b0640fd4a7fe0c028f82b099643e5f8" title="Copy assignment.">Vector::operator=</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>* v)
<a name="l00519"></a>00519    {
<a name="l00520"></a>00520       elem_[0] = v[0];
<a name="l00521"></a>00521       elem_[1] = v[1];
<a name="l00522"></a>00522       elem_[2] = v[2];
<a name="l00523"></a>00523       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00524"></a>00524    }
<a name="l00525"></a>00525 
<a name="l00526"></a>00526    <span class="comment">/*</span>
<a name="l00527"></a>00527 <span class="comment">   * Add vector dv to this vector.</span>
<a name="l00528"></a>00528 <span class="comment">   */</span>
<a name="l00529"></a>00529    <span class="keyword">inline</span>
<a name="l00530"></a><a class="code" href="classUtil_1_1Vector.html#aa5beaa0144bb71199169a37c9fc20834">00530</a>    <span class="keywordtype">void</span> <a class="code" href="classUtil_1_1Vector.html#aa5beaa0144bb71199169a37c9fc20834" title="Add vector dv to this vector.">Vector::operator+=</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; dv)
<a name="l00531"></a>00531    {
<a name="l00532"></a>00532       elem_[0] += dv.elem_[0];
<a name="l00533"></a>00533       elem_[1] += dv.elem_[1];
<a name="l00534"></a>00534       elem_[2] += dv.elem_[2];
<a name="l00535"></a>00535    }
<a name="l00536"></a>00536 
<a name="l00537"></a>00537    <span class="comment">/*</span>
<a name="l00538"></a>00538 <span class="comment">   * Subtract vector dv from this vector.</span>
<a name="l00539"></a>00539 <span class="comment">   */</span>
<a name="l00540"></a>00540    <span class="keyword">inline</span>
<a name="l00541"></a><a class="code" href="classUtil_1_1Vector.html#aa6dddacebf727e19cf8e77ad2947d52c">00541</a>    <span class="keywordtype">void</span> <a class="code" href="classUtil_1_1Vector.html#aa6dddacebf727e19cf8e77ad2947d52c" title="Subtract vector dv from this vector.">Vector::operator-=</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; dv)
<a name="l00542"></a>00542    {
<a name="l00543"></a>00543       elem_[0] -= dv.elem_[0];
<a name="l00544"></a>00544       elem_[1] -= dv.elem_[1];
<a name="l00545"></a>00545       elem_[2] -= dv.elem_[2];
<a name="l00546"></a>00546    }
<a name="l00547"></a>00547 
<a name="l00548"></a>00548    <span class="comment">/*</span>
<a name="l00549"></a>00549 <span class="comment">   * Multiply this vector by scalar s.</span>
<a name="l00550"></a>00550 <span class="comment">   */</span>
<a name="l00551"></a>00551    <span class="keyword">inline</span>
<a name="l00552"></a><a class="code" href="classUtil_1_1Vector.html#a2973f1e626cbfbf2345118fafbdac72c">00552</a>    <span class="keywordtype">void</span> <a class="code" href="classUtil_1_1Vector.html#a2973f1e626cbfbf2345118fafbdac72c" title="Multiply this vector by scalar s.">Vector::operator*=</a>(<span class="keywordtype">double</span> s)
<a name="l00553"></a>00553    {
<a name="l00554"></a>00554       elem_[0] *= s;
<a name="l00555"></a>00555       elem_[1] *= s;
<a name="l00556"></a>00556       elem_[2] *= s;
<a name="l00557"></a>00557    }
<a name="l00558"></a>00558 
<a name="l00559"></a>00559    <span class="comment">/*</span>
<a name="l00560"></a>00560 <span class="comment">   * Divide this vector by scalar s.</span>
<a name="l00561"></a>00561 <span class="comment">   */</span>
<a name="l00562"></a>00562    <span class="keyword">inline</span>
<a name="l00563"></a><a class="code" href="classUtil_1_1Vector.html#ab2252222282d488c4210df0bc99f68b4">00563</a>    <span class="keywordtype">void</span> <a class="code" href="classUtil_1_1Vector.html#ab2252222282d488c4210df0bc99f68b4" title="Divide this vector by scalar s.">Vector::operator/=</a>(<span class="keywordtype">double</span> s)
<a name="l00564"></a>00564    {
<a name="l00565"></a>00565       elem_[0] /= s;
<a name="l00566"></a>00566       elem_[1] /= s;
<a name="l00567"></a>00567       elem_[2] /= s;
<a name="l00568"></a>00568    }
<a name="l00569"></a>00569 
<a name="l00570"></a>00570    <span class="comment">/*</span>
<a name="l00571"></a>00571 <span class="comment">   * Return one Cartesian element by value.</span>
<a name="l00572"></a>00572 <span class="comment">   */</span>
<a name="l00573"></a>00573    <span class="keyword">inline</span>
<a name="l00574"></a><a class="code" href="classUtil_1_1Vector.html#a3228e6aa76fb6d9ed773ddde4725aed5">00574</a>    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="classUtil_1_1Vector.html#a3228e6aa76fb6d9ed773ddde4725aed5" title="Return one Cartesian element by value.">Vector::operator[]</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const</span>
<a name="l00575"></a>00575 <span class="keyword">   </span>{ <span class="keywordflow">return</span> elem_[i]; }
<a name="l00576"></a>00576 
<a name="l00577"></a>00577    <span class="comment">/*</span>
<a name="l00578"></a>00578 <span class="comment">   * Return a reference to one element of the vector.</span>
<a name="l00579"></a>00579 <span class="comment">   */</span>
<a name="l00580"></a>00580    <span class="keyword">inline</span>
<a name="l00581"></a><a class="code" href="classUtil_1_1Vector.html#a5377f9c84a816c394a00f1d251c868c3">00581</a>    <span class="keywordtype">double</span>&amp; <a class="code" href="classUtil_1_1Vector.html#a3228e6aa76fb6d9ed773ddde4725aed5" title="Return one Cartesian element by value.">Vector::operator[]</a>(<span class="keywordtype">int</span> i)
<a name="l00582"></a>00582    { <span class="keywordflow">return</span> elem_[i]; }
<a name="l00583"></a>00583 
<a name="l00584"></a>00584    <span class="comment">/*</span>
<a name="l00585"></a>00585 <span class="comment">   * Return square magnitude of this vector.</span>
<a name="l00586"></a>00586 <span class="comment">   */</span>
<a name="l00587"></a>00587    <span class="keyword">inline</span>
<a name="l00588"></a><a class="code" href="classUtil_1_1Vector.html#ac8e155d7aa8c019159787bd6ac797559">00588</a>    <span class="keywordtype">double</span> <a class="code" href="classUtil_1_1Vector.html#ac8e155d7aa8c019159787bd6ac797559" title="Return square magnitude of this vector.">Vector::square</a>()<span class="keyword"> const</span>
<a name="l00589"></a>00589 <span class="keyword">   </span>{
<a name="l00590"></a>00590       <span class="keywordflow">return</span> elem_[0]*elem_[0] + elem_[1]*elem_[1] + elem_[2]*elem_[2] ;
<a name="l00591"></a>00591    }
<a name="l00592"></a>00592 
<a name="l00593"></a>00593    <span class="comment">/*</span>
<a name="l00594"></a>00594 <span class="comment">   * Return absolute magnitude of this vector.</span>
<a name="l00595"></a>00595 <span class="comment">   */</span>
<a name="l00596"></a>00596    <span class="keyword">inline</span>
<a name="l00597"></a><a class="code" href="classUtil_1_1Vector.html#a8eccd53c4cb659df8fff6d41ae058752">00597</a>    <span class="keywordtype">double</span> <a class="code" href="classUtil_1_1Vector.html#a8eccd53c4cb659df8fff6d41ae058752" title="Return absolute magnitude of this vector.">Vector::abs</a>()<span class="keyword"> const</span>
<a name="l00598"></a>00598 <span class="keyword">   </span>{ <span class="keywordflow">return</span> sqrt(<a class="code" href="classUtil_1_1Vector.html#ac8e155d7aa8c019159787bd6ac797559" title="Return square magnitude of this vector.">square</a>()) ;}
<a name="l00599"></a>00599 
<a name="l00600"></a>00600    <span class="comment">/*</span>
<a name="l00601"></a>00601 <span class="comment">   * Return dot product of this vector and vector v.</span>
<a name="l00602"></a>00602 <span class="comment">   */</span>
<a name="l00603"></a>00603    <span class="keyword">inline</span>
<a name="l00604"></a><a class="code" href="classUtil_1_1Vector.html#a5431123ac320a0ed069d9c7a30702c7b">00604</a>    <span class="keywordtype">double</span> <a class="code" href="classUtil_1_1Vector.html#a5431123ac320a0ed069d9c7a30702c7b" title="Return dot product of this vector and vector v.">Vector::dot</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v)<span class="keyword"> const</span>
<a name="l00605"></a>00605 <span class="keyword">   </span>{
<a name="l00606"></a>00606       <span class="keywordflow">return</span> elem_[0]*v.elem_[0] + elem_[1]*v.elem_[1] + elem_[2]*v.elem_[2];
<a name="l00607"></a>00607    }
<a name="l00608"></a>00608 
<a name="l00609"></a>00609    <span class="comment">/*</span>
<a name="l00610"></a>00610 <span class="comment">   * Return projection of this vector along vector p.</span>
<a name="l00611"></a>00611 <span class="comment">   */</span>
<a name="l00612"></a>00612    <span class="keyword">inline</span>
<a name="l00613"></a><a class="code" href="classUtil_1_1Vector.html#acd1887e9de7debda9916bc9b00cf2cfb">00613</a>    <span class="keywordtype">double</span> <a class="code" href="classUtil_1_1Vector.html#acd1887e9de7debda9916bc9b00cf2cfb" title="Return projection of this vector along vector p.">Vector::projection</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; p)<span class="keyword"> const</span>
<a name="l00614"></a>00614 <span class="keyword">   </span>{
<a name="l00615"></a>00615       <span class="keywordtype">double</span> abs_p = p.<a class="code" href="classUtil_1_1Vector.html#a8eccd53c4cb659df8fff6d41ae058752" title="Return absolute magnitude of this vector.">abs</a>();
<a name="l00616"></a>00616       <span class="keywordflow">if</span> (abs_p &gt; 1.0E-8) {
<a name="l00617"></a>00617          <span class="keywordflow">return</span> <a class="code" href="classUtil_1_1Vector.html#a5431123ac320a0ed069d9c7a30702c7b" title="Return dot product of this vector and vector v.">dot</a>(p)/abs_p;
<a name="l00618"></a>00618       } <span class="keywordflow">else</span> {
<a name="l00619"></a>00619          <span class="keywordflow">return</span> 0.0;
<a name="l00620"></a>00620       }
<a name="l00621"></a>00621    }
<a name="l00622"></a>00622 
<a name="l00623"></a>00623    <span class="comment">/*</span>
<a name="l00624"></a>00624 <span class="comment">   * Add vectors v1 and v2.</span>
<a name="l00625"></a>00625 <span class="comment">   *</span>
<a name="l00626"></a>00626 <span class="comment">   * Upon return, *this = v1 + v2.</span>
<a name="l00627"></a>00627 <span class="comment">   */</span>
<a name="l00628"></a>00628    <span class="keyword">inline</span>
<a name="l00629"></a><a class="code" href="classUtil_1_1Vector.html#aebaf961fa5120510548d94987edbcc0f">00629</a>    <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#aebaf961fa5120510548d94987edbcc0f" title="Add vectors v1 and v2.">Vector::add</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v1, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v2)
<a name="l00630"></a>00630    {
<a name="l00631"></a>00631       elem_[0] = v1.elem_[0] + v2.elem_[0];
<a name="l00632"></a>00632       elem_[1] = v1.elem_[1] + v2.elem_[1];
<a name="l00633"></a>00633       elem_[2] = v1.elem_[2] + v2.elem_[2];
<a name="l00634"></a>00634       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00635"></a>00635    }
<a name="l00636"></a>00636 
<a name="l00637"></a>00637    <span class="comment">/*</span>
<a name="l00638"></a>00638 <span class="comment">   * Subtract vector v2 from v1.</span>
<a name="l00639"></a>00639 <span class="comment">   *</span>
<a name="l00640"></a>00640 <span class="comment">   * Upon return, *this = v1 - v2.</span>
<a name="l00641"></a>00641 <span class="comment">   * \return modified invoking vector</span>
<a name="l00642"></a>00642 <span class="comment">   */</span>
<a name="l00643"></a>00643    <span class="keyword">inline</span>
<a name="l00644"></a><a class="code" href="classUtil_1_1Vector.html#a1d7c5b73ae56a7ad991a6c54517698c2">00644</a>    <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#a1d7c5b73ae56a7ad991a6c54517698c2" title="Subtract vector v2 from v1.">Vector::subtract</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v1, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v2)
<a name="l00645"></a>00645    {
<a name="l00646"></a>00646       elem_[0] = v1.elem_[0] - v2.elem_[0];
<a name="l00647"></a>00647       elem_[1] = v1.elem_[1] - v2.elem_[1];
<a name="l00648"></a>00648       elem_[2] = v1.elem_[2] - v2.elem_[2];
<a name="l00649"></a>00649       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00650"></a>00650    }
<a name="l00651"></a>00651 
<a name="l00652"></a>00652    <span class="comment">/*</span>
<a name="l00653"></a>00653 <span class="comment">   * Multiply a vector v by a scalar s.</span>
<a name="l00654"></a>00654 <span class="comment">   *</span>
<a name="l00655"></a>00655 <span class="comment">   * Upon return, *this = v*s.</span>
<a name="l00656"></a>00656 <span class="comment">   */</span>
<a name="l00657"></a>00657    <span class="keyword">inline</span>
<a name="l00658"></a><a class="code" href="classUtil_1_1Vector.html#a93125fcca5b3af76a88698903291bcbd">00658</a>    <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#a93125fcca5b3af76a88698903291bcbd" title="Multiply a vector v by a scalar s.">Vector::multiply</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v, <span class="keywordtype">double</span> s)
<a name="l00659"></a>00659    {
<a name="l00660"></a>00660       elem_[0] = v.elem_[0]*s;
<a name="l00661"></a>00661       elem_[1] = v.elem_[1]*s;
<a name="l00662"></a>00662       elem_[2] = v.elem_[2]*s;
<a name="l00663"></a>00663       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00664"></a>00664    }
<a name="l00665"></a>00665 
<a name="l00666"></a>00666    <span class="comment">/*</span>
<a name="l00667"></a>00667 <span class="comment">   * Divide vector v by scalar s.</span>
<a name="l00668"></a>00668 <span class="comment">   *</span>
<a name="l00669"></a>00669 <span class="comment">   * Upon return, *this = v/s;</span>
<a name="l00670"></a>00670 <span class="comment">   */</span>
<a name="l00671"></a>00671    <span class="keyword">inline</span>
<a name="l00672"></a><a class="code" href="classUtil_1_1Vector.html#ac80181cd4feb853a58138081a03cb030">00672</a>    <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#ac80181cd4feb853a58138081a03cb030" title="Divide vector v by scalar s.">Vector::divide</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v, <span class="keywordtype">double</span> s)
<a name="l00673"></a>00673    {
<a name="l00674"></a>00674       elem_[0] = v.elem_[0]/s;
<a name="l00675"></a>00675       elem_[1] = v.elem_[1]/s;
<a name="l00676"></a>00676       elem_[2] = v.elem_[2]/s;
<a name="l00677"></a>00677       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00678"></a>00678    }
<a name="l00679"></a>00679 
<a name="l00680"></a>00680    <span class="comment">/*</span>
<a name="l00681"></a>00681 <span class="comment">   * Calculate cross product of vectors v1 and v2.</span>
<a name="l00682"></a>00682 <span class="comment">   *</span>
<a name="l00683"></a>00683 <span class="comment">   * Upon return, *this = v1 x v2.</span>
<a name="l00684"></a>00684 <span class="comment">   */</span>
<a name="l00685"></a>00685    <span class="keyword">inline</span>
<a name="l00686"></a><a class="code" href="classUtil_1_1Vector.html#acfbcd7ced2dcefafe5ee5ceb26fd4b00">00686</a>    <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#acfbcd7ced2dcefafe5ee5ceb26fd4b00" title="Calculate cross product of vectors v1 and v2.">Vector::cross</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v1, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v2)
<a name="l00687"></a>00687    {
<a name="l00688"></a>00688       elem_[0] = v1.elem_[1]*v2.elem_[2] - v1.elem_[2]*v2.elem_[1];
<a name="l00689"></a>00689       elem_[1] = v1.elem_[2]*v2.elem_[0] - v1.elem_[0]*v2.elem_[2];
<a name="l00690"></a>00690       elem_[2] = v1.elem_[0]*v2.elem_[1] - v1.elem_[1]*v2.elem_[0];
<a name="l00691"></a>00691       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00692"></a>00692    }
<a name="l00693"></a>00693 
<a name="l00699"></a>00699    <span class="keyword">inline</span>
<a name="l00700"></a><a class="code" href="classUtil_1_1Vector.html#ad0f5aa1053c8260f14d39aa7e8543033">00700</a>    <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#ad0f5aa1053c8260f14d39aa7e8543033" title="Calculate unit vector parallel to input vector v.">Vector::versor</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v)
<a name="l00701"></a>00701    {
<a name="l00702"></a>00702       <span class="keywordtype">double</span> vabs = v.<a class="code" href="classUtil_1_1Vector.html#a8eccd53c4cb659df8fff6d41ae058752" title="Return absolute magnitude of this vector.">abs</a>();
<a name="l00703"></a>00703       <span class="keywordflow">if</span> ( vabs &gt; 1.0E-8 ) {
<a name="l00704"></a>00704          vabs = 1.0/vabs;
<a name="l00705"></a>00705          elem_[0] = v.elem_[0]*vabs;
<a name="l00706"></a>00706          elem_[1] = v.elem_[1]*vabs;
<a name="l00707"></a>00707          elem_[2] = v.elem_[2]*vabs;
<a name="l00708"></a>00708       } <span class="keywordflow">else</span> {
<a name="l00709"></a>00709          elem_[0] = 1.0;
<a name="l00710"></a>00710          elem_[1] = 0.0;
<a name="l00711"></a>00711          elem_[2] = 0.0;
<a name="l00712"></a>00712       };
<a name="l00713"></a>00713       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00714"></a>00714    }
<a name="l00715"></a>00715 
<a name="l00716"></a>00716    <span class="comment">/*</span>
<a name="l00717"></a>00717 <span class="comment">   * Calculate component of vector v parallel to vector p.</span>
<a name="l00718"></a>00718 <span class="comment">   *</span>
<a name="l00719"></a>00719 <span class="comment">   * Upon return, the invoking vector is equal to the vector projection of</span>
<a name="l00720"></a>00720 <span class="comment">   * vector v along a direction parallel to vector p.</span>
<a name="l00721"></a>00721 <span class="comment">   */</span>
<a name="l00722"></a>00722    <span class="keyword">inline</span>
<a name="l00723"></a><a class="code" href="classUtil_1_1Vector.html#a2adeea6369465539266a632251f2e550">00723</a>    <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#a2adeea6369465539266a632251f2e550" title="Calculate component of vector v parallel to vector p.">Vector::parallel</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; p)
<a name="l00724"></a>00724    {
<a name="l00725"></a>00725       <span class="keywordtype">double</span> pp, fac;
<a name="l00726"></a>00726       pp = p.<a class="code" href="classUtil_1_1Vector.html#ac8e155d7aa8c019159787bd6ac797559" title="Return square magnitude of this vector.">square</a>();
<a name="l00727"></a>00727       <span class="keywordflow">if</span> (pp &gt; 1.0E-8) {
<a name="l00728"></a>00728          fac = v.<a class="code" href="classUtil_1_1Vector.html#a5431123ac320a0ed069d9c7a30702c7b" title="Return dot product of this vector and vector v.">dot</a>(p)/pp;
<a name="l00729"></a>00729       } <span class="keywordflow">else</span> {
<a name="l00730"></a>00730          fac = 0.0;
<a name="l00731"></a>00731       }
<a name="l00732"></a>00732       elem_[0] = p.elem_[0]*fac;
<a name="l00733"></a>00733       elem_[1] = p.elem_[1]*fac;
<a name="l00734"></a>00734       elem_[2] = p.elem_[2]*fac;
<a name="l00735"></a>00735       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00736"></a>00736    }
<a name="l00737"></a>00737 
<a name="l00744"></a>00744    <span class="keyword">inline</span>
<a name="l00745"></a><a class="code" href="classUtil_1_1Vector.html#ac10612d4ef7728740e93625c6cfcf8fd">00745</a>    <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; <a class="code" href="classUtil_1_1Vector.html#ac10612d4ef7728740e93625c6cfcf8fd" title="Calculate component of vector v transverse to vector p.">Vector::transverse</a>(<span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; v, <span class="keyword">const</span> <a class="code" href="classUtil_1_1Vector.html" title="A Vector is a Cartesian vector.">Vector</a>&amp; p)
<a name="l00746"></a>00746    {
<a name="l00747"></a>00747       <span class="keywordtype">double</span> pp, fac;
<a name="l00748"></a>00748       pp = p.<a class="code" href="classUtil_1_1Vector.html#ac8e155d7aa8c019159787bd6ac797559" title="Return square magnitude of this vector.">square</a>();
<a name="l00749"></a>00749       <span class="keywordflow">if</span> (pp &gt; 1.0E-8) {
<a name="l00750"></a>00750          fac = v.<a class="code" href="classUtil_1_1Vector.html#a5431123ac320a0ed069d9c7a30702c7b" title="Return dot product of this vector and vector v.">dot</a>(p)/pp;
<a name="l00751"></a>00751       } <span class="keywordflow">else</span> {
<a name="l00752"></a>00752          fac = 0.0;
<a name="l00753"></a>00753       }
<a name="l00754"></a>00754       elem_[0] = v.elem_[0] - p.elem_[0]*fac;
<a name="l00755"></a>00755       elem_[1] = v.elem_[1] - p.elem_[1]*fac;
<a name="l00756"></a>00756       elem_[2] = v.elem_[2] - p.elem_[2]*fac;
<a name="l00757"></a>00757       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00758"></a>00758    }
<a name="l00759"></a>00759 
<a name="l00760"></a>00760    <span class="comment">/*</span>
<a name="l00761"></a>00761 <span class="comment">   * Serialize to/from an archive.</span>
<a name="l00762"></a>00762 <span class="comment">   */</span>
<a name="l00763"></a>00763    <span class="keyword">template</span> &lt;<span class="keyword">class</span> Archive&gt;
<a name="l00764"></a><a class="code" href="classUtil_1_1Vector.html#a6765e839ab267e4959384e35a4112451">00764</a>    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classUtil_1_1Vector.html#a6765e839ab267e4959384e35a4112451" title="Serialize to/from an archive.">Vector::serialize</a>(Archive&amp; ar, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> version)
<a name="l00765"></a>00765    { 
<a name="l00766"></a>00766       ar &amp; elem_[0];
<a name="l00767"></a>00767       ar &amp; elem_[1];
<a name="l00768"></a>00768       ar &amp; elem_[2];
<a name="l00769"></a>00769    }
<a name="l00770"></a>00770 
<a name="l00771"></a>00771 } 
<a name="l00772"></a>00772 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Sat Jun 16 2012 20:50:49 for Simpatico by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
