<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Simpatico: CellList Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simpatico&#160;<span id="projectnumber">v0.8</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespaceDdMd.html">DdMd</a>      </li>
      <li class="navelem"><a class="el" href="classDdMd_1_1CellList.html">CellList</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<h1>CellList Class Reference<div class="ingroups"><a class="el" href="group__DdMd__Neighbor__Module.html">Nonbonded Neighbors</a></div></h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="DdMd::CellList" --><hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>A cell list used only to identify nearby atom pairs. </p>
<p>An <a class="el" href="classDdMd_1_1CellList.html" title="A cell list used only to identify nearby atom pairs.">CellList</a> divides the domain owned by a processor, plus a frame containing ghost particles, into a grid of cells, such that the length of each cell in each of Cartesian direction is greater than a specified cutoff distance.</p>
<p>All operations of this class are local (no MPI).</p>
<p>Building a <a class="el" href="classDdMd_1_1CellList.html" title="A cell list used only to identify nearby atom pairs.">CellList</a> (usage): </p>
<div class="fragment"><pre class="fragment">    AtomStorage storage;
    <a class="code" href="classDdMd_1_1CellList.html#a9a3af8501f8608e8d5fdecfbe0c85f8e" title="Constructor.">CellList</a> cellList;
    Vector   lower;        <span class="comment">// Vector of lower bounds (local atoms)</span>
    Vector   upper;        <span class="comment">// Vector of upper bounds (local atoms)</span>
    <span class="keywordtype">double</span>   cutoff;       <span class="comment">// minimum cell dimension</span>
    <span class="keywordtype">int</span>      <a class="code" href="classDdMd_1_1CellList.html#a72fbb50e40dfdc5f3710e54aac41b97e" title="Maximum number of atoms for which space is allocated.">atomCapacity</a>  <span class="comment">// max number of atoms on this processor</span>

    <span class="comment">// Bounds on lower and upper used here to allocate memory.</span>
    cellList.allocate(<a class="code" href="classDdMd_1_1CellList.html#a72fbb50e40dfdc5f3710e54aac41b97e" title="Maximum number of atoms for which space is allocated.">atomCapacity</a>, lower, upper, cutoff);
  
    <span class="comment">// Make the actual grid.</span>
    cellList.makeGrid(lower, upper, cutoff);

    <span class="comment">// Place all atoms and ghosts</span>
    cellList.clear();
    AtomStorage::AtomIterator  atomIter;
    <span class="keywordflow">for</span> (storage.begin(atomIter); atomIter.notEnd(); ++atomIter) {
       cellList.placeAtom(*atomIter);
    }
    AtomStorage::GhostIterator ghostIter;
    <span class="keywordflow">for</span> (storage.begin(ghostIter); ghostIter.notEnd(); ++ghostIter){
       cellList.placeAtom(*ghostIter);
    }
    
    <span class="comment">// Build cell list</span>
    cellList.build();
</pre></div><p>The atomCapacity parameter should be set equal to the sum of atomCapacity and the ghostCapacity of the associated atomStorage, which is the maximum total number of atoms that can exist on this processor.</p>
<p>See <a class="el" href="classDdMd_1_1Cell.html" title="A single Cell in a CellList.">Cell</a> documentation for an example of how to iterate over local cells and neighboring atom pairs. </p>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html#l00075">75</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html">ddMd/neighbor/CellList.h</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="ddMd_2neighbor_2CellList_8h_source.html">CellList.h</a>&gt;</code></p>

<p><a href="classDdMd_1_1CellList-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><b>AtomTag</b></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#a9a3af8501f8608e8d5fdecfbe0c85f8e">CellList</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a9a3af8501f8608e8d5fdecfbe0c85f8e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#ac5ddcb849045a381aa407e75d80c7f5f">~CellList</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#ac5ddcb849045a381aa407e75d80c7f5f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#a97346dcf4a96ecbbc279eaaa12629371">allocate</a> (int atomCapacity, const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;lower, const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;upper, double cutoff)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for this <a class="el" href="classDdMd_1_1CellList.html" title="A cell list used only to identify nearby atom pairs.">CellList</a>.  <a href="#a97346dcf4a96ecbbc279eaaa12629371"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#a9b8bff08d561156cd51152e8b396cf58">makeGrid</a> (const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;lower, const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;upper, double cutoff)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Make the cell grid.  <a href="#a9b8bff08d561156cd51152e8b396cf58"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#a40f73e573c2cc4906a2ae2261e02389d">placeAtom</a> (<a class="el" href="classDdMd_1_1Atom.html">Atom</a> &amp;atom)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the appropriate cell for an <a class="el" href="classDdMd_1_1Atom.html" title="A point particle.">Atom</a>, based on its position.  <a href="#a40f73e573c2cc4906a2ae2261e02389d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#a7740c7ab195c03ac140f1f75f633470f">build</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the cell list.  <a href="#a7740c7ab195c03ac140f1f75f633470f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the cell list to its empty state (no Atoms).  <a href="#ac8bb3912a3ce86b15842e79d0b421204"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classUtil_1_1Grid.html">Grid</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#ae85ec1ce4bd74bc16569c104e711bbdc">grid</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return Grid object by const reference.  <a href="#ae85ec1ce4bd74bc16569c104e711bbdc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#a039b61f9a54603c3def80654ab509d3e">cellLength</a> (int i) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Dimension of each cell in direction i.  <a href="#a039b61f9a54603c3def80654ab509d3e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#aaf595bbc4fbae892199c0ffa729db78c">cellIndexFromPosition</a> (const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;position) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the index of the cell that contains a position Vector.  <a href="#aaf595bbc4fbae892199c0ffa729db78c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classDdMd_1_1Cell.html">Cell</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#a24f37d2e5f584a4e63daf74901524021">begin</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to first local cell in linked list.  <a href="#a24f37d2e5f584a4e63daf74901524021"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classDdMd_1_1Cell.html">Cell</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#aeea2877f703eaee565045618dcf694b7">cell</a> (int i) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a specified cell by const reference.  <a href="#aeea2877f703eaee565045618dcf694b7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#ac91579bd63979a294891d330a5533838">nAtom</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total number of atoms (local and ghost) in this <a class="el" href="classDdMd_1_1CellList.html" title="A cell list used only to identify nearby atom pairs.">CellList</a>.  <a href="#ac91579bd63979a294891d330a5533838"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#aef1c19a0c1e5442f7b9ee3bbd39d6413">nReject</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get number of atoms that were rejected (not placed in cells)  <a href="#aef1c19a0c1e5442f7b9ee3bbd39d6413"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#a72fbb50e40dfdc5f3710e54aac41b97e">atomCapacity</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of atoms for which space is allocated.  <a href="#a72fbb50e40dfdc5f3710e54aac41b97e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#ae1b737ba0b8a4b2fc8814035d132dc99">cellCapacity</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of cells for which space has been allocated.  <a href="#ae1b737ba0b8a4b2fc8814035d132dc99"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#a0bcdab3616db481dd211594529479f94">isAllocated</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Has memory been allocated for this <a class="el" href="classDdMd_1_1CellList.html" title="A cell list used only to identify nearby atom pairs.">CellList</a>?  <a href="#a0bcdab3616db481dd211594529479f94"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#af10d7be2a4678e55f767b3149a03fd56">isBuilt</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Has this <a class="el" href="classDdMd_1_1CellList.html" title="A cell list used only to identify nearby atom pairs.">CellList</a> been built?  <a href="#af10d7be2a4678e55f767b3149a03fd56"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDdMd_1_1CellList.html#aac1b70a2ed67ead038c4d3f5ac4d8a81">isValid</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return true if valid, or throw Exception.  <a href="#aac1b70a2ed67ead038c4d3f5ac4d8a81"></a><br/></td></tr>
</table>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a9a3af8501f8608e8d5fdecfbe0c85f8e"></a><!-- doxytag: member="DdMd::CellList::CellList" ref="a9a3af8501f8608e8d5fdecfbe0c85f8e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDdMd_1_1CellList.html">CellList</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor. </p>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html#l00025">25</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html">ddMd/neighbor/CellList.cpp</a>.</p>

<p>References <a class="el" href="Dimension_8h_source.html#l00019">Util::Dimension</a>.</p>

</div>
</div>
<a class="anchor" id="ac5ddcb849045a381aa407e75d80c7f5f"></a><!-- doxytag: member="DdMd::CellList::~CellList" ref="ac5ddcb849045a381aa407e75d80c7f5f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="classDdMd_1_1CellList.html">CellList</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destructor. </p>
<p>Deallocates array of <a class="el" href="classDdMd_1_1Cell.html" title="A single Cell in a CellList.">Cell</a> objects, if necessary. </p>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html#l00037">37</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html">ddMd/neighbor/CellList.cpp</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a97346dcf4a96ecbbc279eaaa12629371"></a><!-- doxytag: member="DdMd::CellList::allocate" ref="a97346dcf4a96ecbbc279eaaa12629371" args="(int atomCapacity, const Vector &amp;lower, const Vector &amp;upper, double cutoff)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void allocate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>atomCapacity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>lower</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>upper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allocate memory for this <a class="el" href="classDdMd_1_1CellList.html" title="A cell list used only to identify nearby atom pairs.">CellList</a>. </p>
<p>This function:</p>
<ul>
<li>Allocates an array of atomCapacity Tag objects.</li>
<li>Allocates an array of atomCapacity Atom* objects.</li>
<li>Allocates an array of <a class="el" href="classDdMd_1_1Cell.html" title="A single Cell in a CellList.">Cell</a> objects sized for this boundary.</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">atomCapacity</td><td>dimension of global array of atoms </td></tr>
    <tr><td class="paramname">lower</td><td>lower bound used to allocate array of cells. </td></tr>
    <tr><td class="paramname">upper</td><td>upper bound used to allocate array of cells. </td></tr>
    <tr><td class="paramname">cutoff</td><td>minimum dimension of a cell in any direction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html#l00043">43</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html">ddMd/neighbor/CellList.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9b8bff08d561156cd51152e8b396cf58"></a><!-- doxytag: member="DdMd::CellList::makeGrid" ref="a9b8bff08d561156cd51152e8b396cf58" args="(const Vector &amp;lower, const Vector &amp;upper, double cutoff)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void makeGrid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>lower</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>upper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Make the cell grid. </p>
<p>The number of cells in each direction is chosen such that the dimension of each cell in each direction is greater than or equal to the cutoff parameter. To calculate nonbonded pair interaction energies, the cutoff parameter should thus be equal to or greater than the maximum range of nonbonded interactions.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">lower</td><td>lower bound of local atom coordinates. </td></tr>
    <tr><td class="paramname">upper</td><td>upper bound of local atom coordinates. </td></tr>
    <tr><td class="paramname">cutoff</td><td>minimum dimension of a cell in any direction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html#l00101">101</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html">ddMd/neighbor/CellList.cpp</a>.</p>

<p>References <a class="el" href="Dimension_8h_source.html#l00019">Util::Dimension</a>, <a class="el" href="ddMd_2neighbor_2Cell_8cpp_source.html#l00033">Cell::setIsGhostCell()</a>, <a class="el" href="ddMd_2neighbor_2Cell_8cpp_source.html#l00039">Cell::setLastCell()</a>, <a class="el" href="ddMd_2neighbor_2Cell_8cpp_source.html#l00036">Cell::setNextCell()</a>, and <a class="el" href="global_8h_source.html#l00051">UTIL_THROW</a>.</p>

</div>
</div>
<a class="anchor" id="a40f73e573c2cc4906a2ae2261e02389d"></a><!-- doxytag: member="DdMd::CellList::placeAtom" ref="a40f73e573c2cc4906a2ae2261e02389d" args="(Atom &amp;atom)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void placeAtom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDdMd_1_1Atom.html">Atom</a> &amp;&#160;</td>
          <td class="paramname"><em>atom</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Determine the appropriate cell for an <a class="el" href="classDdMd_1_1Atom.html" title="A point particle.">Atom</a>, based on its position. </p>
<p>This method does not place the atom in a cell, but retains a record of the cell index that is used to place atoms in the <a class="el" href="classDdMd_1_1CellList.html#a7740c7ab195c03ac140f1f75f633470f" title="Build the cell list.">build()</a> method.</p>
<p>This method quietly does nothing if the atom is outside the expanded domain for nonbonded ghosts, which extends one cutoff length beyond the domain boundaries the domain boundaries in each direction.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">atom</td><td><a class="el" href="classDdMd_1_1Atom.html" title="A point particle.">Atom</a> object to be added. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html#l00337">337</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html">ddMd/neighbor/CellList.h</a>.</p>

<p>References <a class="el" href="ddMd_2chemistry_2Atom_8h_source.html#l00221">Atom::position()</a>.</p>

</div>
</div>
<a class="anchor" id="a7740c7ab195c03ac140f1f75f633470f"></a><!-- doxytag: member="DdMd::CellList::build" ref="a7740c7ab195c03ac140f1f75f633470f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void build </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Build the cell list. </p>
<p>This method must be called after completing a loop over atoms, in which <a class="el" href="classDdMd_1_1CellList.html#a40f73e573c2cc4906a2ae2261e02389d" title="Determine the appropriate cell for an Atom, based on its position.">placeAtom()</a> is called for each atom. The <a class="el" href="classDdMd_1_1CellList.html#a7740c7ab195c03ac140f1f75f633470f" title="Build the cell list.">build()</a> method uses information gathered in this loop to build and fill all of the cells. </p>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html#l00206">206</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html">ddMd/neighbor/CellList.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac8bb3912a3ce86b15842e79d0b421204"></a><!-- doxytag: member="DdMd::CellList::clear" ref="ac8bb3912a3ce86b15842e79d0b421204" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reset the cell list to its empty state (no Atoms). </p>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html#l00178">178</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html">ddMd/neighbor/CellList.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae85ec1ce4bd74bc16569c104e711bbdc"></a><!-- doxytag: member="DdMd::CellList::grid" ref="ae85ec1ce4bd74bc16569c104e711bbdc" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classUtil_1_1Grid.html">Grid</a> &amp; grid </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return Grid object by const reference. </p>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html#l00353">353</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html">ddMd/neighbor/CellList.h</a>.</p>

</div>
</div>
<a class="anchor" id="a039b61f9a54603c3def80654ab509d3e"></a><!-- doxytag: member="DdMd::CellList::cellLength" ref="a039b61f9a54603c3def80654ab509d3e" args="(int i) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cellLength </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Dimension of each cell in direction i. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Cartesian index i = 0, 1, 2 </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html#l00356">356</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html">ddMd/neighbor/CellList.h</a>.</p>

</div>
</div>
<a class="anchor" id="aaf595bbc4fbae892199c0ffa729db78c"></a><!-- doxytag: member="DdMd::CellList::cellIndexFromPosition" ref="aaf595bbc4fbae892199c0ffa729db78c" args="(const Vector &amp;position) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cellIndexFromPosition </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classUtil_1_1Vector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>position</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the index of the cell that contains a position Vector. </p>
<p>Returns a null value of -1 if the position is outside the expanded domain for nonbonded ghost atoms.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">position</td><td>position Vector, inside the boundary </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html#l00314">314</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html">ddMd/neighbor/CellList.h</a>.</p>

<p>References <a class="el" href="Dimension_8h_source.html#l00019">Util::Dimension</a>.</p>

</div>
</div>
<a class="anchor" id="a24f37d2e5f584a4e63daf74901524021"></a><!-- doxytag: member="DdMd::CellList::begin" ref="a24f37d2e5f584a4e63daf74901524021" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classDdMd_1_1Cell.html">Cell</a> * begin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return pointer to first local cell in linked list. </p>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html#l00362">362</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html">ddMd/neighbor/CellList.h</a>.</p>

<p>Referenced by <a class="el" href="ddMd_2neighbor_2PairList_8cpp_source.html#l00093">PairList::build()</a>.</p>

</div>
</div>
<a class="anchor" id="aeea2877f703eaee565045618dcf694b7"></a><!-- doxytag: member="DdMd::CellList::cell" ref="aeea2877f703eaee565045618dcf694b7" args="(int i) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classDdMd_1_1Cell.html">Cell</a> &amp; cell </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return a specified cell by const reference. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>cell index </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html#l00359">359</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html">ddMd/neighbor/CellList.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac91579bd63979a294891d330a5533838"></a><!-- doxytag: member="DdMd::CellList::nAtom" ref="ac91579bd63979a294891d330a5533838" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nAtom </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get total number of atoms (local and ghost) in this <a class="el" href="classDdMd_1_1CellList.html" title="A cell list used only to identify nearby atom pairs.">CellList</a>. </p>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html#l00227">227</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html">ddMd/neighbor/CellList.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aef1c19a0c1e5442f7b9ee3bbd39d6413"></a><!-- doxytag: member="DdMd::CellList::nReject" ref="aef1c19a0c1e5442f7b9ee3bbd39d6413" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nReject </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get number of atoms that were rejected (not placed in cells) </p>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html#l00233">233</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html">ddMd/neighbor/CellList.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a72fbb50e40dfdc5f3710e54aac41b97e"></a><!-- doxytag: member="DdMd::CellList::atomCapacity" ref="a72fbb50e40dfdc5f3710e54aac41b97e" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int atomCapacity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Maximum number of atoms for which space is allocated. </p>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html#l00239">239</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html">ddMd/neighbor/CellList.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae1b737ba0b8a4b2fc8814035d132dc99"></a><!-- doxytag: member="DdMd::CellList::cellCapacity" ref="ae1b737ba0b8a4b2fc8814035d132dc99" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cellCapacity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Number of cells for which space has been allocated. </p>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html#l00245">245</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html">ddMd/neighbor/CellList.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0bcdab3616db481dd211594529479f94"></a><!-- doxytag: member="DdMd::CellList::isAllocated" ref="a0bcdab3616db481dd211594529479f94" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool isAllocated </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Has memory been allocated for this <a class="el" href="classDdMd_1_1CellList.html" title="A cell list used only to identify nearby atom pairs.">CellList</a>? </p>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html#l00365">365</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8h_source.html">ddMd/neighbor/CellList.h</a>.</p>

</div>
</div>
<a class="anchor" id="af10d7be2a4678e55f767b3149a03fd56"></a><!-- doxytag: member="DdMd::CellList::isBuilt" ref="af10d7be2a4678e55f767b3149a03fd56" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool isBuilt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Has this <a class="el" href="classDdMd_1_1CellList.html" title="A cell list used only to identify nearby atom pairs.">CellList</a> been built? </p>
<p>IsBuilt is set true by the <a class="el" href="classDdMd_1_1CellList.html#a7740c7ab195c03ac140f1f75f633470f" title="Build the cell list.">build()</a> method and false by <a class="el" href="classDdMd_1_1CellList.html#ac8bb3912a3ce86b15842e79d0b421204" title="Reset the cell list to its empty state (no Atoms).">clear()</a>. </p>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html#l00251">251</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html">ddMd/neighbor/CellList.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aac1b70a2ed67ead038c4d3f5ac4d8a81"></a><!-- doxytag: member="DdMd::CellList::isValid" ref="aac1b70a2ed67ead038c4d3f5ac4d8a81" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool isValid </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return true if valid, or throw Exception. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if valid, otherwise throw an Exception. </dd></dl>

<p>Definition at line <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html#l00257">257</a> of file <a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html">ddMd/neighbor/CellList.cpp</a>.</p>

<p>References <a class="el" href="ddMd_2neighbor_2Cell_8h_source.html#l00321">Cell::atomCapacity()</a>, <a class="el" href="ddMd_2neighbor_2Cell_8h_source.html#l00291">Cell::atomPtr()</a>, <a class="el" href="ddMd_2neighbor_2Cell_8h_source.html#l00285">Cell::nAtom()</a>, <a class="el" href="ddMd_2chemistry_2Atom_8h_source.html#l00221">Atom::position()</a>, and <a class="el" href="global_8h_source.html#l00051">UTIL_THROW</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="ddMd_2neighbor_2CellList_8h_source.html">ddMd/neighbor/CellList.h</a></li>
<li><a class="el" href="ddMd_2neighbor_2CellList_8cpp_source.html">ddMd/neighbor/CellList.cpp</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Sat Jun 16 2012 20:50:50 for Simpatico by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
