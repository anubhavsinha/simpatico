<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Simpatico: 2.8 Restarting</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simpatico
   &#160;<span id="projectnumber">v1.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="index.html">Simpatico - Simulation Package for Polymer and Molecular Liquids</a>      </li>
      <li class="navelem"><a class="el" href="guide_page.html">2 User Guide</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">2.8 Restarting </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The -r command line option can be used to restart an mcSim or mdSim simulation from a checkpoint file that preserves the full internal state of a simulation. It is, of course, always possible to restart any simulation from a configuration file. Restarting from a configuration file, however, loses some information about the internal state of the program, such as the state of the random number generator, the values of auxiliary state variables used by some MD integrators, and the state of statistical accumulators used by on-the-fly diagnostics. Restarting from a binary checkpoint file preserves all of this internal state information, and simply continues the simulation from the point at which the checkpoint file was written. Both single-processor and multi-processor mcSim and mdSim simulations can be restarted from checkpoint files.</p>
<p>No analogous restart capability has yet been implemented for ddSim simulations: Thus far, these can only be restarted from a configuration file.</p>
<h2><a class="anchor" id="restart_page_checkpoint"></a>
Writing Checkpoint Files</h2>
<p>To be able to restart an mdSim or mcSim simulation, the original simulation musthave been run using the <a class="el" href="classMcMd_1_1MdWriteRestart.html" title="Repeatedly write restart file.">MdWriteRestart</a> (for mdSim) or <a class="el" href="classMcMd_1_1McWriteRestart.html" title="Periodically write restart file.">McWriteRestart</a> (for mcSim) diagnostic. Each of these diagnostics periodically writes the required checkpoint file. The parameter file format for the <a class="el" href="classMcMd_1_1McWriteRestart.html" title="Periodically write restart file.">McWriteRestart</a> diagnostic looks like this: </p>
<div class="fragment"><pre class="fragment">   McWriteRestart{
     interval       10000
     outputFileName restart
   }
</pre></div><p> The format for <a class="el" href="classMcMd_1_1MdWriteRestart.html" title="Repeatedly write restart file.">MdWriteRestart</a> is identical except for the replacement of the class name identifier "McWriteRestart" by "MdWriteRestart" in the opening line. The interval parameter determines the number of MC or MD steps between subsequent file writes. The outputFileName is a base name for the checkpoint file. The full name of the checkpoint file is constructed by appending a suffix ".rst" to the base name. The checkpoint file is overwritten repeatedly, so that only the most recent state is available. Using the above parameter file block, a file named restart.rst would be overwritten when the MC step counter is a multiple of 10000.</p>
<h2><a class="anchor" id="restart_page_command"></a>
Command File</h2>
<p>To restart an mcSim or mdSim simulation, one must also write a short command file. The name of this file must end with the suffix ".cmd", and must have the same base name as the corresponding *.rst checkpoint file. The *.rst checkpoint file and the *.cmd command file must be placed in the same directory. For single-processor simulations, this must be the directory from which the program was invoked. When a program is invoked with the -r command line option, the first line of the command file must be a "RESTART" command, as discussed below.</p>
<p>The simplest possible *.cmd command file looks like this: </p>
<div class="fragment"><pre class="fragment">   RESTART   150000
   FINISH
</pre></div><p> The RESTART command causes the program to re-enter the main simulation loop at the point at which the checkpoint file was written. The step counter is initially set to the value it had when the checkpoint file was written, which is stored in the checkpoint file. The simulation is then run until the step counter reaches a final value that is given in the command file as an integer argument after the RESTART keyword. The RESTART command bypasses some initialization steps that are executed before the main loop in a normal SIMULATE command, in order to recreate the state of the simulation at the moment that the checkpoint file was written.</p>
<p>The RESTART command is only valid if the program was invoked with the RESTART (-r) command line option, in which case it must be the first line of the file. Other commands may follow after the RESTART command and before the FINISH command, which stops execution.</p>
<h2><a class="anchor" id="restart_page_usage"></a>
Usage</h2>
<p>To restart an mcSim or mdSim simulation, one must invoke the mdSim or mcSim executable with the -r option, and supply the common base name of the *.rst and *.cmd files as an option argument. Thus, for example, if a previous MC simulation were run using a base name of "restart" for the outputFileName in the <a class="el" href="classMcMd_1_1McWriteRestart.html" title="Periodically write restart file.">McWriteRestart</a> <a class="el" href="classMcMd_1_1Diagnostic.html" title="Abstract base for periodic output and/or analysis actions.">Diagnostic</a>, one could type </p>
<div class="fragment"><pre class="fragment">   mcSim -e -r restart
</pre></div><p> to restart the simulation. The use of the -e option is optional, but causes parameters that would normally be read from the parameter file to be echoed to standard output while the program is reading the checkpoint file. In this example, the -r option would cause the program to read restart.rst to initialize the simulation and then execute the commands in the file restart.cmd in the order listed.</p>
<h2><a class="anchor" id="restart_page_multiprocessor"></a>
Multi-processor simulations</h2>
<p>Is is also possible to restart multi-processor mcSim and mdSim simulations. Please read the discussion of <a class="el" href="multiMcMd_page.html">multi-processor mcSim and mdSim simulations</a> before reading the following discussion of multi-processor restart procedures.</p>
<p>In multi-processor simulations, as for single processor simulations, checkpoint files are written by <a class="el" href="classMcMd_1_1McWriteRestart.html" title="Periodically write restart file.">McWriteRestart</a> or <a class="el" href="classMcMd_1_1MdWriteRestart.html" title="Repeatedly write restart file.">MdWriteRestart</a> diagnostic. The parameter file format for these diagnostics is the same in single- and multi-processor simulations. In all multi-processor simulations, whether independent or replicated, these diagnostics write a separate restart file for each processor. The checkpoint file for each processor is placed in the numbered directory that contains data associated with that processor. For example, if the outputFileName parameter in the <a class="el" href="classMcMd_1_1McWriteRestart.html" title="Periodically write restart file.">McWriteRestart</a> or <a class="el" href="classMcMd_1_1MdWriteRestart.html" title="Repeatedly write restart file.">MdWriteRestart</a> parameter file is "restart", the checkpoint file for processor 2 would be 2/restart.rst.</p>
<p>The conventions for command files are different for "independent" and "replicated" simulations. Independent simulations use a separate *.rst restart command file for each processor, each of which is placed in the same directory as the associated checkpoint file. Replicated simulations use a single restart command file, which must be placed in the same directory as the single parameter file and command file for the original simulation, which is also the directory from which the mcSim or mdSim executable is invoked. In either case, the base name of the command file or files must be the same as the base name of the restart files, whichis determined by the outputFileName parameter used by the <a class="el" href="classMcMd_1_1McWriteRestart.html" title="Periodically write restart file.">McWriteRestart</a> or <a class="el" href="classMcMd_1_1MdWriteRestart.html" title="Repeatedly write restart file.">MdWriteRestart</a> diagnostic during the original simulation.</p>
<p>The command to restart a multi-processor simulation is similar to that for a single-processor simulation. The command to restart a 3 processor mcSim simulation of either independent or replicated systems, using the mcSim_m_f executable and the mpirun command to launch an MPI program, is </p>
<div class="fragment"><pre class="fragment">   mpirun -np 3 mcSim_m_f -e -r restart
</pre></div><p> Information about whether the original simulation was a simulation of independent or replicated systems is stored within all checkpoint files, and does not need to be specified by a command line option when the simulation is restarted. Invoke an mcSim or mdSim executable with both the "-r" and "-p" options is thus illegal, and will cause execution to halt. </p>
<ul style="list-style: none;">
<li>
<a class="el" href="analysis_page.html">2.7 Data Analysis</a> (Previous)  </li>
<li>
<a class="el" href="guide_page.html">2 User Guide</a> (Up)  </li>
<li>
<a class="el" href="multi_page.html">2.9 Multi-System Simulations</a> (Next)  </li>
</ul>
</div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Sat Dec 1 2012 17:09:10 for Simpatico by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
